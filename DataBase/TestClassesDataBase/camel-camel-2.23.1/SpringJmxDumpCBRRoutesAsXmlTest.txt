/** 
 * @version 
 */
public class SpringJmxDumpCBRRoutesAsXmlTest extends SpringTestSupport {
  @Override protected boolean useJmx(){
    return true;
  }
  @Override protected AbstractXmlApplicationContext createApplicationContext(){
    return new ClassPathXmlApplicationContext("org/apache/camel/spring/management/SpringJmxDumpCBRRouteAsXmlTest.xml");
  }
  protected MBeanServer getMBeanServer(){
    return context.getManagementStrategy().getManagementAgent().getMBeanServer();
  }
  @Test public void testJmxDumpCBRRoutesAsXml() throws Exception {
    MBeanServer mbeanServer=getMBeanServer();
    ObjectName on=ObjectName.getInstance("org.apache.camel:context=camel-1,type=context,name=\"camel-1\"");
    String xml=(String)mbeanServer.invoke(on,"dumpRoutesAsXml",null,null);
    assertNotNull(xml);
    log.info(xml);
    assertTrue(xml.contains("myRoute"));
    assertTrue(xml.contains("<when id=\"when1\">"));
    assertTrue(xml.contains("<otherwise id=\"otherwise1\">"));
    assertTrue(xml.contains("<route customId=\"true\" id=\"myRoute\">") || xml.contains("<route id=\"myRoute\" customId=\"true\">"));
    assertTrue(xml.contains("<choice customId=\"true\" id=\"myChoice\">") || xml.contains("<choice id=\"myChoice\" customId=\"true\">"));
  }
}
