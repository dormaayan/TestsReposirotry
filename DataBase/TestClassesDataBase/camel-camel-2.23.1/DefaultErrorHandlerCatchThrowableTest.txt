public class DefaultErrorHandlerCatchThrowableTest extends ContextTestSupport {
  @Test public void testDefaultErrorHandlerCatchThrowable() throws Exception {
    try {
      template.sendBody("direct:start","Hello World");
      fail("Should have thrown exception");
    }
 catch (    CamelExecutionException e) {
      assertEquals("Hello World",e.getExchange().getIn().getBody());
      NoSuchMethodError cause=assertIsInstanceOf(NoSuchMethodError.class,e.getCause());
      assertEquals("This is an Error not an Exception",cause.getMessage());
    }
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        final String exceptionString="This is an Error not an Exception";
        from("direct:start").process(new Processor(){
          public void process(          Exchange exchange) throws Exception {
            throw new NoSuchMethodError(exceptionString);
          }
        }
);
      }
    }
;
  }
}
