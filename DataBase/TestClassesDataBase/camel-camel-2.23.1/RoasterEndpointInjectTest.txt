public class RoasterEndpointInjectTest {
  private static final Logger LOG=LoggerFactory.getLogger(RoasterEndpointInjectTest.class);
  @Test public void parse() throws Exception {
    JavaClassSource clazz=(JavaClassSource)Roaster.parse(new File("src/test/java/org/apache/camel/parser/java/MyCdiRouteBuilder.java"));
    MethodSource<JavaClassSource> method=CamelJavaParserHelper.findConfigureMethod(clazz);
    List<CamelEndpointDetails> details=new ArrayList<>();
    RouteBuilderParser.parseRouteBuilderEndpoints(clazz,".","src/test/java/org/apache/camel/parser/java/MyCdiRouteBuilder.java",details);
    LOG.info("{}",details);
    Assert.assertEquals("timer:foo?period=4999",details.get(0).getEndpointUri());
    Assert.assertEquals("28",details.get(0).getLineNumber());
    Assert.assertEquals("28",details.get(0).getLineNumberEnd());
    Assert.assertEquals(1062,details.get(0).getAbsolutePosition());
    Assert.assertEquals(10,details.get(0).getLinePosition());
    Assert.assertEquals("log:a",details.get(1).getEndpointUri());
    Assert.assertEquals("32",details.get(1).getLineNumber());
    Assert.assertEquals("32",details.get(1).getLineNumberEnd());
    Assert.assertEquals(1145,details.get(1).getAbsolutePosition());
    Assert.assertEquals(10,details.get(1).getLinePosition());
    Assert.assertEquals("netty4-http:http:someserver:80/hello",details.get(2).getEndpointUri());
    Assert.assertEquals("36",details.get(2).getLineNumber());
    Assert.assertEquals("36",details.get(2).getLineNumberEnd());
    Assert.assertEquals(1203,details.get(2).getAbsolutePosition());
    Assert.assertEquals(10,details.get(2).getLinePosition());
    Assert.assertEquals("mock:foo?retainFirst=1",details.get(6).getEndpointUri());
    Assert.assertEquals("45",details.get(6).getLineNumber());
    Assert.assertEquals("46",details.get(6).getLineNumberEnd());
    Assert.assertEquals(1457,details.get(6).getAbsolutePosition());
    Assert.assertEquals(17,details.get(6).getLinePosition());
    List<ParserResult> list=CamelJavaParserHelper.parseCamelConsumerUris(method,true,true);
    for (    ParserResult result : list) {
      LOG.info("Consumer: " + result.getElement());
    }
    Assert.assertEquals("timer:foo?period=4999",list.get(0).getElement());
    list=CamelJavaParserHelper.parseCamelProducerUris(method,true,true);
    for (    ParserResult result : list) {
      LOG.info("Producer: " + result.getElement());
    }
    Assert.assertEquals(3,list.size());
    Assert.assertEquals(7,details.size());
    Assert.assertEquals("log:a",details.get(4).getEndpointUri());
  }
}
