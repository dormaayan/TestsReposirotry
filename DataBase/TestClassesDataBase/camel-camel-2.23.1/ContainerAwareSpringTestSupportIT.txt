public class ContainerAwareSpringTestSupportIT extends ContainerAwareSpringTestSupport {
  @Override protected AbstractApplicationContext createApplicationContext(){
    return new ClassPathXmlApplicationContext("org/apache/camel/test/testcontainers/spring/ContainerAwareSpringTestSupportTest.xml");
  }
  @Test public void testPropertyPlaceholders() throws Exception {
    final GenericContainer<?> container=getContainer("myconsul");
    final String host=context.resolvePropertyPlaceholders("{{container:host:myconsul}}");
    Assertions.assertThat(host).isEqualTo(container.getContainerIpAddress());
    final String port=context.resolvePropertyPlaceholders("{{container:port:8500@myconsul}}");
    Assertions.assertThat(port).isEqualTo("" + container.getMappedPort(8500));
  }
  @Override protected GenericContainer<?> createContainer(){
    return new GenericContainer("consul:1.0.7").withNetworkAliases("myconsul").withExposedPorts(8500).waitingFor(Wait.forLogMessageContaining("Synced node info",1)).withCommand("agent","-dev","-server","-bootstrap","-client","0.0.0.0","-log-level","trace");
  }
}
