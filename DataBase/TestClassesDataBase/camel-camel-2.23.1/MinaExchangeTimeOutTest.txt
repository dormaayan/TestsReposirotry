/** 
 * To test timeout.
 * @version 
 */
public class MinaExchangeTimeOutTest extends BaseMinaTest {
  @Test public void testUsingTimeoutParameter() throws Exception {
    Endpoint endpoint=context.getEndpoint("mina:tcp://localhost:{{port}}?textline=true&sync=true&timeout=2000");
    Producer producer=endpoint.createProducer();
    producer.start();
    Exchange exchange=producer.createExchange();
    exchange.getIn().setBody("Hello World");
    try {
      producer.process(exchange);
      fail("Should have thrown an ExchangeTimedOutException wrapped in a RuntimeCamelException");
    }
 catch (    Exception e) {
      assertTrue("Should have thrown an ExchangeTimedOutException",e instanceof ExchangeTimedOutException);
    }
    producer.stop();
  }
  protected RouteBuilder createRouteBuilder(){
    return new RouteBuilder(){
      public void configure(){
        from("mina:tcp://localhost:{{port}}?textline=true&sync=true").process(new Processor(){
          public void process(          Exchange e) throws Exception {
            assertEquals("Hello World",e.getIn().getBody(String.class));
            Thread.sleep(5000);
            e.getOut().setBody("Okay I will be faster in the future");
          }
        }
);
      }
    }
;
  }
}
