public class SaxonXsltMessageTerminateTest extends CamelTestSupport {
  @Test public void testXsltTerminate() throws Exception {
    getMockEndpoint("mock:result").expectedMessageCount(0);
    getMockEndpoint("mock:dead").expectedMessageCount(1);
    assertMockEndpointsSatisfied();
    Exchange out=getMockEndpoint("mock:dead").getReceivedExchanges().get(0);
    assertNotNull(out);
    Exception cause=out.getProperty(Exchange.EXCEPTION_CAUGHT,Exception.class);
    assertNotNull(cause);
    Exception error=out.getProperty(Exchange.XSLT_ERROR,Exception.class);
    assertNotNull(error);
    assertEquals("Error: DOB is an empty string!",error.getMessage());
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        errorHandler(deadLetterChannel("mock:dead"));
        from("file:src/test/data/?fileName=terminate.xml&noop=true").to("xslt:org/apache/camel/component/xslt/terminate.xsl?saxon=true").to("log:foo").to("mock:result");
      }
    }
;
  }
}
