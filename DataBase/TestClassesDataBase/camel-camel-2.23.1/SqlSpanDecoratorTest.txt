public class SqlSpanDecoratorTest {
  private static final String SQL_STATEMENT="select * from customer";
  @Test public void testPre(){
    Endpoint endpoint=Mockito.mock(Endpoint.class);
    Exchange exchange=Mockito.mock(Exchange.class);
    Message message=Mockito.mock(Message.class);
    Mockito.when(endpoint.getEndpointUri()).thenReturn("test");
    Mockito.when(exchange.getIn()).thenReturn(message);
    Mockito.when(message.getHeader(SqlSpanDecorator.CAMEL_SQL_QUERY)).thenReturn(SQL_STATEMENT);
    SpanDecorator decorator=new SqlSpanDecorator();
    MockTracer tracer=new MockTracer();
    MockSpan span=tracer.buildSpan("TestSpan").start();
    decorator.pre(span,exchange,endpoint);
    assertEquals("sql",span.tags().get(Tags.DB_TYPE.getKey()));
    assertEquals(SQL_STATEMENT,span.tags().get(Tags.DB_STATEMENT.getKey()));
  }
}
