public class StubbingLocationTest {
  @Test public void stubbing_location_should_be_the_correct_point(){
    ConcreteClass mock=mock(ConcreteClass.class);
    String frame;
    when(mock.concreteMethod(frame=Thread.currentThread().getStackTrace()[1].toString())).thenReturn("");
    mock.concreteMethod(frame);
    Set<Stubbing> stubbings=AllInvocationsFinder.findStubbings(Collections.singleton(mock));
    assertEquals(1,stubbings.size());
    String location=stubbings.iterator().next().getInvocation().getLocation().toString();
    assertEquals("-> at " + frame,location);
  }
static final class ConcreteClass {
    String concreteMethod(    String s){
      throw new RuntimeException(s);
    }
  }
}
