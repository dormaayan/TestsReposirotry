public class StressTest {
public class TestClass {
    public String getStuff(){
      return "A";
    }
  }
  @Test public void call_a_lot_of_mocks(){
    for (int i=0; i < 40000; i++) {
      TestClass mock=mock(TestClass.class);
      when(mock.getStuff()).thenReturn("B");
      assertEquals("B",mock.getStuff());
      TestClass serializableMock=mock(TestClass.class,withSettings().serializable());
      when(serializableMock.getStuff()).thenReturn("C");
      assertEquals("C",serializableMock.getStuff());
      if (i % 1024 == 0) {
        System.out.println(i + "/40000 mocks called");
      }
    }
  }
}
