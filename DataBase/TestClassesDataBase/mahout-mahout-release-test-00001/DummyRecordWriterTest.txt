public class DummyRecordWriterTest {
  @Test public void testWrite(){
    DummyRecordWriter<IntWritable,VectorWritable> writer=new DummyRecordWriter<>();
    IntWritable reusableIntWritable=new IntWritable();
    VectorWritable reusableVectorWritable=new VectorWritable();
    reusableIntWritable.set(0);
    reusableVectorWritable.set(new DenseVector(new double[]{1,2,3}));
    writer.write(reusableIntWritable,reusableVectorWritable);
    reusableIntWritable.set(1);
    reusableVectorWritable.set(new DenseVector(new double[]{4,5,6}));
    writer.write(reusableIntWritable,reusableVectorWritable);
    Assert.assertEquals("The writer must remember the two keys that is written to it",2,writer.getKeys().size());
  }
}
