public class BigIdTrackerTest {
  @Rule public final RandomRule random=new RandomRule();
  @Test public void shouldKeepIdsAndMarkDuplicates(){
    int length=10_000;
    try (BigIdTracker tracker=new BigIdTracker(NumberArrayFactory.HEAP.newByteArray(length,BigIdTracker.DEFAULT_VALUE))){
      long[] values=new long[length];
      boolean[] marks=new boolean[length];
      for (int i=0; i < length; i++) {
        tracker.set(i,values[i]=random.nextLong(MAX_ID));
        if (random.nextBoolean()) {
          tracker.markAsDuplicate(i);
          marks[i]=true;
        }
      }
      for (int i=0; i < length; i++) {
        assertEquals(values[i],tracker.get(i));
        assertEquals(marks[i],tracker.isMarkedAsDuplicate(i));
      }
    }
   }
}
