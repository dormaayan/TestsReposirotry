public class LabelIT extends KernelIntegrationTest {
  @Test public void shouldListAllLabels() throws Exception {
    Transaction transaction=newTransaction(AnonymousContext.writeToken());
    int label1Id=transaction.tokenWrite().labelGetOrCreateForName("label1");
    int label2Id=transaction.tokenWrite().labelGetOrCreateForName("label2");
    Iterator<NamedToken> labelIdsBeforeCommit=transaction.tokenRead().labelsGetAllTokens();
    assertThat(asCollection(labelIdsBeforeCommit),hasItems(new NamedToken("label1",label1Id),new NamedToken("label2",label2Id)));
    commit();
    transaction=newTransaction();
    Iterator<NamedToken> labelIdsAfterCommit=transaction.tokenRead().labelsGetAllTokens();
    assertThat(asCollection(labelIdsAfterCommit),hasItems(new NamedToken("label1",label1Id),new NamedToken("label2",label2Id)));
    commit();
  }
}
