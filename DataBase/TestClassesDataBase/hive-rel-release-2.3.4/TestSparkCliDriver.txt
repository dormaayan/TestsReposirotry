@RunWith(Parameterized.class) public class TestSparkCliDriver {
  static CliAdapter adapter=new CliConfigs.SparkCliConfig().getCliAdapter();
  @Parameters(name="{0}") public static List<Object[]> getParameters() throws Exception {
    return adapter.getParameters();
  }
  @ClassRule public static TestRule cliClassRule=adapter.buildClassRule();
  @Rule public TestRule cliTestRule=adapter.buildTestRule();
  private String name;
  private File qfile;
  public TestSparkCliDriver(  String name,  File qfile){
    this.name=name;
    this.qfile=qfile;
  }
  @Test public void testCliDriver() throws Exception {
    adapter.runTest(name,qfile);
  }
}
