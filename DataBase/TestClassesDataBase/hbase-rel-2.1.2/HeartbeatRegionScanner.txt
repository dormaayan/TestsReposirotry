/** 
 * Custom RegionScanner that can be configured to sleep between retrievals of row Results and/or column family cells
 */
private static class HeartbeatRegionScanner extends RegionScannerImpl {
  HeartbeatRegionScanner(  Scan scan,  List<KeyValueScanner> additionalScanners,  HRegion region) throws IOException {
    region.super(scan,additionalScanners,region);
  }
  @Override public boolean nextRaw(  List<Cell> outResults,  ScannerContext context) throws IOException {
    boolean moreRows=super.nextRaw(outResults,context);
    HeartbeatHRegion.rowSleep();
    return moreRows;
  }
  @Override protected void initializeKVHeap(  List<KeyValueScanner> scanners,  List<KeyValueScanner> joinedScanners,  HRegion region) throws IOException {
    this.storeHeap=new HeartbeatKVHeap(scanners,region.getCellComparator());
    if (!joinedScanners.isEmpty()) {
      this.joinedHeap=new HeartbeatKVHeap(joinedScanners,region.getCellComparator());
    }
  }
}
