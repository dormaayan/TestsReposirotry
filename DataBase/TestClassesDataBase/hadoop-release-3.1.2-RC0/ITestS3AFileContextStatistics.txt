/** 
 * S3a implementation of FCStatisticsBaseTest.
 */
public class ITestS3AFileContextStatistics extends FCStatisticsBaseTest {
  @Before public void setUp() throws Exception {
    Configuration conf=new Configuration();
    fc=S3ATestUtils.createTestFileContext(conf);
    fc.mkdir(fileContextTestHelper.getTestRootPath(fc,"test"),FileContext.DEFAULT_PERM,true);
    FileContext.clearStatistics();
  }
  @After public void tearDown() throws Exception {
    if (fc != null) {
      fc.delete(fileContextTestHelper.getTestRootPath(fc,"test"),true);
    }
  }
  @Override protected void verifyReadBytes(  FileSystem.Statistics stats){
    Assert.assertEquals(2 * blockSize,stats.getBytesRead());
  }
  @Override protected void verifyWrittenBytes(  FileSystem.Statistics stats){
    Assert.assertEquals(blockSize,stats.getBytesWritten());
  }
  @Override protected URI getFsUri(){
    return fc.getHomeDirectory().toUri();
  }
}
