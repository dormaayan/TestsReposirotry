/** 
 * This class verifies path conversion to SDK.
 */
public class TestRelativePathFormation {
  @Test public void testToRelativePath() throws URISyntaxException, IOException {
    AdlFileSystem fs=new AdlFileSystem();
    Configuration configuration=new Configuration();
    configuration.setEnum(AZURE_AD_TOKEN_PROVIDER_TYPE_KEY,TokenProviderType.Custom);
    configuration.set(AZURE_AD_TOKEN_PROVIDER_CLASS_KEY,"org.apache.hadoop.fs.adl.common.CustomMockTokenProvider");
    fs.initialize(new URI("adl://temp.account.net"),configuration);
    Assert.assertEquals("/usr",fs.toRelativeFilePath(new Path("/usr")));
    Assert.assertEquals("/usr",fs.toRelativeFilePath(new Path("adl://temp.account.net/usr")));
    fs.setWorkingDirectory(new Path("/a/b/"));
    Assert.assertEquals("/usr",fs.toRelativeFilePath(new Path("/usr")));
    Assert.assertEquals("/a/b/usr",fs.toRelativeFilePath(new Path("usr")));
    Assert.assertEquals("/usr",fs.toRelativeFilePath(new Path("adl://temp.account.net/usr")));
    Assert.assertEquals("/usr",fs.toRelativeFilePath(new Path("wasb://temp.account.net/usr")));
  }
}
