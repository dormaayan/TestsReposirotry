public class TestDruidDataSource extends TestCase {
  protected void tearDown() throws Exception {
    DruidDataSourceStatManager.clear();
  }
  protected void setUp() throws Exception {
    Assert.assertEquals(0,DruidDataSourceStatManager.getInstance().getDataSourceList().size());
  }
  public void test_0() throws Exception {
    DruidDataSource dataSource=new DruidDataSource();
    Class.forName("com.alibaba.druid.mock.MockDriver");
    dataSource.setInitialSize(10);
    dataSource.setMaxActive(10);
    dataSource.setDriverClassName("com.alibaba.druid.mock.MockDriver");
    dataSource.setUrl("jdbc:mock:xxx");
    Assert.assertEquals(0,dataSource.getConnectCount());
    Assert.assertEquals(0,dataSource.getConnectErrorCount());
    Assert.assertEquals(0,dataSource.getCloseCount());
    Assert.assertEquals(0,dataSource.getPoolingCount());
    Connection conn=dataSource.getConnection();
    Assert.assertTrue(conn instanceof DruidPooledConnection);
    Assert.assertEquals(1,dataSource.getConnectCount());
    Assert.assertEquals(0,dataSource.getConnectErrorCount());
    Assert.assertEquals(0,dataSource.getCloseCount());
    Assert.assertEquals(0,dataSource.getRecycleCount());
    Assert.assertEquals(1,dataSource.getActiveCount());
    Assert.assertEquals(9,dataSource.getPoolingCount());
    conn.close();
    Assert.assertEquals(1,dataSource.getConnectCount());
    Assert.assertEquals(0,dataSource.getConnectErrorCount());
    Assert.assertEquals(1,dataSource.getCloseCount());
    Assert.assertEquals(1,dataSource.getRecycleCount());
    Assert.assertEquals(0,dataSource.getActiveCount());
    Assert.assertEquals(10,dataSource.getPoolingCount());
    conn.close();
    Assert.assertEquals(1,dataSource.getConnectCount());
    Assert.assertEquals(0,dataSource.getConnectErrorCount());
    Assert.assertEquals(1,dataSource.getCloseCount());
    Assert.assertEquals(1,dataSource.getRecycleCount());
    Assert.assertEquals(0,dataSource.getActiveCount());
    dataSource.close();
  }
}
