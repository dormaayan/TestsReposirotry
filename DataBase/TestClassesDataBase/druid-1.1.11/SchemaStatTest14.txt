public class SchemaStatTest14 extends TestCase {
  public void test_schemaStat() throws Exception {
    String sql="delete r from t_res r where id=1 ";
    SQLStatement stmt=SQLUtils.parseStatements(sql,JdbcConstants.MYSQL).get(0);
    System.out.println(stmt);
    SchemaStatVisitor statVisitor=SQLUtils.createSchemaStatVisitor(JdbcConstants.MYSQL);
    stmt.accept(statVisitor);
    Set<TableStat.Relationship> relationships=statVisitor.getRelationships();
    for (    TableStat.Relationship relationship : relationships) {
      System.out.println(relationship);
    }
    System.out.println("Tables : " + statVisitor.getTables());
    System.out.println(statVisitor.getColumns());
    System.out.println("relationships : " + statVisitor.getRelationships());
    System.out.println(statVisitor.getConditions());
    assertEquals(0,relationships.size());
    assertEquals(1,statVisitor.getColumns().size());
    assertEquals(1,statVisitor.getConditions().size());
    assertEquals(0,statVisitor.getFunctions().size());
    assertTrue(statVisitor.containsTable("t_res"));
    assertTrue(statVisitor.containsColumn("t_res","id"));
  }
}
