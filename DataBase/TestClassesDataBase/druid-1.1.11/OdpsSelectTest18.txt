public class OdpsSelectTest18 extends TestCase {
  public void test_select() throws Exception {
    String sql="select a, b, c from tableA where a in ( select a from tableB limit 10 )";
    assertEquals("SELECT a, b, c\n" + "FROM tableA\n" + "WHERE a IN (\n"+ "\tSELECT a\n"+ "\tFROM tableB\n"+ "\tLIMIT 10\n"+ ")",SQLUtils.formatOdps(sql));
    assertEquals("select a, b, c\n" + "from tableA\n" + "where a in (\n"+ "\tselect a\n"+ "\tfrom tableB\n"+ "\tlimit 10\n"+ ")",SQLUtils.formatOdps(sql,SQLUtils.DEFAULT_LCASE_FORMAT_OPTION));
    List<SQLStatement> statementList=SQLUtils.parseStatements(sql,JdbcConstants.ODPS);
    SQLStatement stmt=statementList.get(0);
    Assert.assertEquals(1,statementList.size());
    SchemaStatVisitor visitor=SQLUtils.createSchemaStatVisitor(JdbcConstants.ODPS);
    stmt.accept(visitor);
    Assert.assertEquals(2,visitor.getTables().size());
    Assert.assertEquals(4,visitor.getColumns().size());
    Assert.assertEquals(1,visitor.getConditions().size());
  }
}
