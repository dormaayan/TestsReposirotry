/** 
 * Tests for  {@link SequenceFileWriter}.
 */
public class SequenceFileWriterTest {
  @Test public void testDuplicate(){
    SequenceFileWriter<Text,Text> writer=new SequenceFileWriter("BZ",SequenceFile.CompressionType.BLOCK);
    writer.setSyncOnFlush(true);
    SequenceFileWriter<Text,Text> other=writer.duplicate();
    assertTrue(StreamWriterBaseComparator.equals(writer,other));
    writer.setSyncOnFlush(false);
    assertFalse(StreamWriterBaseComparator.equals(writer,other));
  }
}
