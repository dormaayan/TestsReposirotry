/** 
 * Tests for the  {@link ResultPartitionDeploymentDescriptor}.
 */
public class ResultPartitionDeploymentDescriptorTest {
  /** 
 * Tests simple de/serialization.
 */
  @Test public void testSerialization() throws Exception {
    IntermediateDataSetID resultId=new IntermediateDataSetID();
    IntermediateResultPartitionID partitionId=new IntermediateResultPartitionID();
    ResultPartitionType partitionType=ResultPartitionType.PIPELINED;
    int numberOfSubpartitions=24;
    ResultPartitionDeploymentDescriptor orig=new ResultPartitionDeploymentDescriptor(resultId,partitionId,partitionType,numberOfSubpartitions,numberOfSubpartitions,true);
    ResultPartitionDeploymentDescriptor copy=CommonTestUtils.createCopySerializable(orig);
    assertEquals(resultId,copy.getResultId());
    assertEquals(partitionId,copy.getPartitionId());
    assertEquals(partitionType,copy.getPartitionType());
    assertEquals(numberOfSubpartitions,copy.getNumberOfSubpartitions());
    assertTrue(copy.sendScheduleOrUpdateConsumersMessage());
  }
}
