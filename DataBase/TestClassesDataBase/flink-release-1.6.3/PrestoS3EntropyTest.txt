/** 
 * Tests that the file system factory picks up the entropy configuration properly.
 */
public class PrestoS3EntropyTest {
  @Test public void testEntropyInjectionConfig() throws Exception {
    final Configuration conf=new Configuration();
    conf.setString("s3.entropy.key","__entropy__");
    conf.setInteger("s3.entropy.length",7);
    S3FileSystemFactory factory=new S3FileSystemFactory();
    factory.configure(conf);
    S3PrestoFileSystem fs=(S3PrestoFileSystem)factory.create(new URI("s3://test"));
    assertEquals("__entropy__",fs.getEntropyInjectionKey());
    assertEquals(7,fs.generateEntropy().length());
  }
}
