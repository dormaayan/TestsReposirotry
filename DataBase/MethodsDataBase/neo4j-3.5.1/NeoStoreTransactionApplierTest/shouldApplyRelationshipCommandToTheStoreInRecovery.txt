@Test public void shouldApplyRelationshipCommandToTheStoreInRecovery() throws Exception {
  final BatchTransactionApplier applier=newApplier(true);
  final RelationshipRecord before=new RelationshipRecord(12);
  final RelationshipRecord record=new RelationshipRecord(12,3,4,5);
  record.setInUse(true);
  final Command command=new Command.RelationshipCommand(before,record);
  boolean result=apply(applier,command::handle,transactionToApply);
  assertFalse(result);
  verify(relationshipStore,times(1)).setHighestPossibleIdInUse(record.getId());
  verify(relationshipStore,times(1)).updateRecord(record);
}
