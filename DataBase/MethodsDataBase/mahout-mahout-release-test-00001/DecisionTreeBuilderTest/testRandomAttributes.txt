/** 
 * make sure that DecisionTreeBuilder.randomAttributes() returns the correct number of attributes, that have not been selected yet
 */
@Test public void testRandomAttributes() throws Exception {
  Random rng=RandomUtils.getRandom();
  int nbAttributes=rng.nextInt(100) + 1;
  boolean[] selected=new boolean[nbAttributes];
  for (int nloop=0; nloop < 100; nloop++) {
    Arrays.fill(selected,false);
    int nbSelected=rng.nextInt(nbAttributes - 1);
    for (int index=0; index < nbSelected; index++) {
      int attr;
      do {
        attr=rng.nextInt(nbAttributes);
      }
 while (selected[attr]);
      selected[attr]=true;
    }
    int m=rng.nextInt(nbAttributes);
    Method randomAttributes=DecisionTreeBuilder.class.getDeclaredMethod("randomAttributes",Random.class,boolean[].class,int.class);
    randomAttributes.setAccessible(true);
    int[] attrs=(int[])randomAttributes.invoke(null,rng,selected,m);
    assertNotNull(attrs);
    assertEquals(Math.min(m,nbAttributes - nbSelected),attrs.length);
    for (    int attr : attrs) {
      assertFalse("an attribute has already been selected",selected[attr]);
      assertTrue(attr >= 0);
      assertTrue(attr < nbAttributes);
      assertEquals(ArrayUtils.indexOf(attrs,attr),ArrayUtils.lastIndexOf(attrs,attr));
    }
  }
}
