@Test public void testEvaluateQueueSizeRetainMoreThanMinimumDurationAfterDiscard(){
  Format format1=videoFormat(500,320,240);
  Format format2=videoFormat(1000,640,480);
  Format format3=videoFormat(2000,960,720);
  TrackGroup trackGroup=new TrackGroup(format1,format2,format3);
  FakeMediaChunk chunk1=new FakeMediaChunk(format1,0,10_000_000);
  FakeMediaChunk chunk2=new FakeMediaChunk(format1,10_000_000,20_000_000);
  FakeMediaChunk chunk3=new FakeMediaChunk(format1,20_000_000,30_000_000);
  List<FakeMediaChunk> queue=new ArrayList<>();
  queue.add(chunk1);
  queue.add(chunk2);
  queue.add(chunk3);
  when(mockBandwidthMeter.getBitrateEstimate()).thenReturn(500L);
  adaptiveTrackSelection=adaptiveTrackSelectionWithMinTimeBetweenBufferReevaluationMs(trackGroup,15_000,2000);
  int initialQueueSize=adaptiveTrackSelection.evaluateQueueSize(0,queue);
  assertThat(initialQueueSize).isEqualTo(3);
  fakeClock.advanceTime(2000);
  when(mockBandwidthMeter.getBitrateEstimate()).thenReturn(1000L);
  int newSize=adaptiveTrackSelection.evaluateQueueSize(0,queue);
  assertThat(newSize).isEqualTo(2);
}
