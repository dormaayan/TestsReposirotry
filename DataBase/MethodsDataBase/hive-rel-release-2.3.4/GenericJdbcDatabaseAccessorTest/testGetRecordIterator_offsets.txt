@Test public void testGetRecordIterator_offsets() throws HiveJdbcDatabaseAccessException {
  Configuration conf=buildConfiguration();
  DatabaseAccessor accessor=DatabaseAccessorFactory.getAccessor(conf);
  JdbcRecordIterator iterator=accessor.getRecordIterator(conf,2,2);
  assertThat(iterator,is(notNullValue()));
  int count=0;
  while (iterator.hasNext()) {
    Map<String,String> record=iterator.next();
    count++;
    assertThat(record,is(notNullValue()));
    assertThat(record.size(),is(equalTo(7)));
    assertThat(record.get("STRATEGY_ID"),is(equalTo(String.valueOf(count + 2))));
  }
  assertThat(count,is(equalTo(2)));
  iterator.close();
}
