@Test public void testAlreadyCompressedFrame(){
  EmbeddedChannel encoderChannel=new EmbeddedChannel(new PerFrameDeflateEncoder(9,15,false));
  byte[] payload=new byte[300];
  random.nextBytes(payload);
  BinaryWebSocketFrame frame=new BinaryWebSocketFrame(true,WebSocketExtension.RSV3 | WebSocketExtension.RSV1,Unpooled.wrappedBuffer(payload));
  encoderChannel.writeOutbound(frame);
  BinaryWebSocketFrame newFrame=encoderChannel.readOutbound();
  assertNotNull(newFrame);
  assertNotNull(newFrame.content());
  assertTrue(newFrame instanceof BinaryWebSocketFrame);
  assertEquals(WebSocketExtension.RSV3 | WebSocketExtension.RSV1,newFrame.rsv());
  assertEquals(300,newFrame.content().readableBytes());
  byte[] finalPayload=new byte[300];
  newFrame.content().readBytes(finalPayload);
  assertTrue(Arrays.equals(finalPayload,payload));
  newFrame.release();
}
