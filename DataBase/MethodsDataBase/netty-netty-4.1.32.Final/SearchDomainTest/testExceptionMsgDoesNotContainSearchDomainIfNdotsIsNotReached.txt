@Test public void testExceptionMsgDoesNotContainSearchDomainIfNdotsIsNotReached() throws Exception {
  TestDnsServer.MapRecordStoreA store=new TestDnsServer.MapRecordStoreA(Collections.<String>emptySet());
  dnsServer=new TestDnsServer(store);
  dnsServer.start();
  resolver=newResolver().searchDomains(Collections.singletonList("foo.com")).ndots(2).build();
  Future<InetAddress> fut=resolver.resolve("unknown.hostname");
  assertTrue(fut.await(10,TimeUnit.SECONDS));
  assertFalse(fut.isSuccess());
  final Throwable cause=fut.cause();
  assertThat(cause,instanceOf(UnknownHostException.class));
  assertThat("search domain is included in UnknownHostException",cause.getMessage(),not(containsString("foo.com")));
}
