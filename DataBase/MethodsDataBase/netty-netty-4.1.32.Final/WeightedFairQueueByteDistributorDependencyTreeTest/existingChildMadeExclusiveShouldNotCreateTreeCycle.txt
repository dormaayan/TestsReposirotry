@Test public void existingChildMadeExclusiveShouldNotCreateTreeCycle() throws Http2Exception {
  Http2Stream streamA=connection.local().createStream(1,false);
  Http2Stream streamB=connection.local().createStream(3,false);
  Http2Stream streamC=connection.local().createStream(5,false);
  Http2Stream streamD=connection.local().createStream(7,false);
  setPriority(streamB.id(),streamA.id(),DEFAULT_PRIORITY_WEIGHT,false);
  setPriority(streamC.id(),streamA.id(),DEFAULT_PRIORITY_WEIGHT,false);
  setPriority(streamD.id(),streamC.id(),DEFAULT_PRIORITY_WEIGHT,false);
  setPriority(streamC.id(),streamA.id(),DEFAULT_PRIORITY_WEIGHT,true);
  assertEquals(4,connection.numActiveStreams());
  assertEquals(1,distributor.numChildren(connection.connectionStream().id()));
  assertTrue(distributor.isChild(streamA.id(),connection.connectionStream().id(),DEFAULT_PRIORITY_WEIGHT));
  assertEquals(1,distributor.numChildren(streamA.id()));
  assertTrue(distributor.isChild(streamC.id(),streamA.id(),DEFAULT_PRIORITY_WEIGHT));
  assertEquals(2,distributor.numChildren(streamC.id()));
  assertTrue(distributor.isChild(streamB.id(),streamC.id(),DEFAULT_PRIORITY_WEIGHT));
  assertEquals(0,distributor.numChildren(streamB.id()));
  assertTrue(distributor.isChild(streamD.id(),streamC.id(),DEFAULT_PRIORITY_WEIGHT));
  assertEquals(0,distributor.numChildren(streamD.id()));
}
