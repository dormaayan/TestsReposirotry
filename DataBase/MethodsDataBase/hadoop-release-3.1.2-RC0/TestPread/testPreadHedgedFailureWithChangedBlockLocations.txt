/** 
 * Scenario: 1. Write a file with RF=2, DN1 and DN2<br> 2. Open the stream, Consider Locations are [DN1, DN2] in LocatedBlock.<br> 3. Move block from DN2 to DN3.<br> 4. Let block gets replicated to another DN3<br> 5. Stop DN1 also.<br> 6. Current valid Block locations in NameNode [DN1, DN3]<br> 7. Consider next calls to getBlockLocations() always returns DN3 as last location.<br>
 */
@Test(timeout=60000) public void testPreadHedgedFailureWithChangedBlockLocations() throws Exception {
  isHedgedRead=true;
  DFSClientFaultInjector old=DFSClientFaultInjector.get();
  try {
    DFSClientFaultInjector.set(new DFSClientFaultInjector(){
      public void sleepBeforeHedgedGet(){
        try {
          Thread.sleep(500);
        }
 catch (        InterruptedException e) {
        }
      }
    }
);
    doPreadTestWithChangedLocations(2);
  }
  finally {
    DFSClientFaultInjector.set(old);
  }
}
