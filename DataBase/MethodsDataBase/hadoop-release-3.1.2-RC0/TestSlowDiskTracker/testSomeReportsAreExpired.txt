/** 
 * Test the case when a subset of reports has expired. Ensure that we only get back non-expired reports.
 */
@Test public void testSomeReportsAreExpired() throws Exception {
  addSlowDiskForTesting("dn1","disk1",ImmutableMap.of(DiskOp.METADATA,1.1,DiskOp.READ,1.8));
  addSlowDiskForTesting("dn1","disk2",ImmutableMap.of(DiskOp.READ,1.3));
  timer.advance(reportValidityMs);
  addSlowDiskForTesting("dn2","disk2",ImmutableMap.of(DiskOp.WRITE,1.1));
  tracker.updateSlowDiskReportAsync(timer.monotonicNow());
  GenericTestUtils.waitFor(new Supplier<Boolean>(){
    @Override public Boolean get(){
      return !tracker.getSlowDisksReport().isEmpty();
    }
  }
,500,5000);
  Map<String,DiskLatency> reports=getSlowDisksReportForTesting(tracker);
  assertThat(reports.size(),is(1));
  assertTrue(Math.abs(reports.get("dn2:disk2").getLatency(DiskOp.WRITE) - 1.1) < 0.0000001);
}
