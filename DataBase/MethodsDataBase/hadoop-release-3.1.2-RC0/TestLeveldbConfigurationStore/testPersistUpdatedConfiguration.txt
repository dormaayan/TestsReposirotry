@Test public void testPersistUpdatedConfiguration() throws Exception {
  confStore.initialize(conf,schedConf,rmContext);
  assertNull(confStore.retrieve().get("key"));
  Map<String,String> update=new HashMap<>();
  update.put("key","val");
  YarnConfigurationStore.LogMutation mutation=new YarnConfigurationStore.LogMutation(update,TEST_USER);
  confStore.logMutation(mutation);
  confStore.confirmMutation(true);
  assertEquals("val",confStore.retrieve().get("key"));
  confStore.close();
  confStore=createConfStore();
  schedConf.set("key","badVal");
  confStore.initialize(conf,schedConf,rmContext);
  assertEquals("val",confStore.retrieve().get("key"));
  confStore.close();
}
