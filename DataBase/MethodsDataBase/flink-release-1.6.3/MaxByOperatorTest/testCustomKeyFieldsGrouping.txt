/** 
 * This test validates that an InvalidProgramException is thrown when maxBy is used on a custom data type.
 */
@Test(expected=InvalidProgramException.class) public void testCustomKeyFieldsGrouping(){
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  this.customTypeData.add(new CustomType());
  UnsortedGrouping<CustomType> groupDs=env.fromCollection(customTypeData).groupBy(0);
  groupDs.maxBy(0);
}
