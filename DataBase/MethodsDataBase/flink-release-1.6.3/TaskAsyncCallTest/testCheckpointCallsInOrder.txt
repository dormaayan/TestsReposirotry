@Test public void testCheckpointCallsInOrder() throws Exception {
  Task task=createTask(CheckpointsInOrderInvokable.class);
  try (TaskCleaner ignored=new TaskCleaner(task)){
    task.startTaskThread();
    awaitLatch.await();
    for (int i=1; i <= numCalls; i++) {
      task.triggerCheckpointBarrier(i,156865867234L,CheckpointOptions.forCheckpointWithDefaultLocation());
    }
    triggerLatch.await();
    assertFalse(task.isCanceledOrFailed());
    ExecutionState currentState=task.getExecutionState();
    assertThat(currentState,isOneOf(ExecutionState.RUNNING,ExecutionState.FINISHED));
  }
 }
