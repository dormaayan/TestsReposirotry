@Test public void testLogTimeoutAlmostReachedWarningDuringRecovery() throws Exception {
  clock.setEpochMilli(0);
  final long transactionTimeout=1000;
  final double warningRatio=0.5;
  sinkFunction.setTransactionTimeout(transactionTimeout);
  sinkFunction.enableTransactionTimeoutWarnings(warningRatio);
  harness.open();
  final OperatorSubtaskState snapshot=harness.snapshot(0,1);
  final long elapsedTime=(long)((double)transactionTimeout * warningRatio + 2);
  clock.setEpochMilli(elapsedTime);
  harness.initializeState(snapshot);
  final List<String> logMessages=loggingEvents.stream().map(LoggingEvent::getRenderedMessage).collect(Collectors.toList());
  assertThat(logMessages,hasItem(containsString("has been open for 502 ms. " + "This is close to or even exceeding the transaction timeout of 1000 ms.")));
}
