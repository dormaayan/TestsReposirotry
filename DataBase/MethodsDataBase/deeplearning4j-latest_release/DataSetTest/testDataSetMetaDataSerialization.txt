@Test public void testDataSetMetaDataSerialization() throws IOException {
  for (  boolean withMeta : new boolean[]{false,true}) {
    INDArray f=Nd4j.linspace(1,3,3).reshape(3,1);
    INDArray l=Nd4j.linspace(10,30,3).reshape(3,1);
    DataSet ds=new DataSet(f,l);
    if (withMeta) {
      List<String> metaData=Arrays.asList("1","2","3");
      ds.setExampleMetaData(metaData);
    }
    File dir=testDir.newFolder();
    File saved=new File(dir,"ds.bin");
    ds.save(saved);
    DataSet loaded=new DataSet();
    loaded.load(saved);
    if (withMeta) {
      List<String> metaData=Arrays.asList("1","2","3");
      assertNotNull(loaded.getExampleMetaData());
      assertEquals(metaData,loaded.getExampleMetaData());
    }
    assertEquals(f,loaded.getFeatures());
    assertEquals(l,loaded.getLabels());
  }
}
