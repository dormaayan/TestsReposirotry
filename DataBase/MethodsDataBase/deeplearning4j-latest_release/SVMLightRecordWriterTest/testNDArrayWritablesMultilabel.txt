@Test public void testNDArrayWritablesMultilabel() throws Exception {
  INDArray arr2=Nd4j.zeros(2);
  arr2.putScalar(0,11);
  arr2.putScalar(1,12);
  INDArray arr3=Nd4j.zeros(3);
  arr3.putScalar(0,0);
  arr3.putScalar(1,1);
  arr3.putScalar(2,0);
  List<Writable> record=Arrays.asList((Writable)new DoubleWritable(1),new NDArrayWritable(arr2),new IntWritable(2),new DoubleWritable(3),new NDArrayWritable(arr3),new DoubleWritable(1));
  File tempFile=File.createTempFile("SVMLightRecordWriter",".txt");
  tempFile.setWritable(true);
  tempFile.deleteOnExit();
  if (tempFile.exists())   tempFile.delete();
  String lineOriginal="2,4 1:1.0 2:11.0 3:12.0 4:2.0 5:3.0";
  try (SVMLightRecordWriter writer=new SVMLightRecordWriter()){
    Configuration configWriter=new Configuration();
    configWriter.setBoolean(SVMLightRecordWriter.MULTILABEL,true);
    configWriter.setInt(SVMLightRecordWriter.FEATURE_FIRST_COLUMN,0);
    configWriter.setInt(SVMLightRecordWriter.FEATURE_LAST_COLUMN,3);
    FileSplit outputSplit=new FileSplit(tempFile);
    writer.initialize(configWriter,outputSplit,new NumberOfRecordsPartitioner());
    writer.write(record);
  }
   String lineNew=FileUtils.readFileToString(tempFile).trim();
  assertEquals(lineOriginal,lineNew);
}
