@Test public void testBasicRecord() throws IOException, InterruptedException {
  Map<Integer,List<Writable>> correct=new HashMap<>();
  correct.put(0,Arrays.asList(ZERO,ONE,ZERO,new DoubleWritable(2),ZERO,new DoubleWritable(3),ZERO,new DoubleWritable(4),ZERO,new DoubleWritable(5),new IntWritable(7)));
  correct.put(1,Arrays.asList(new DoubleWritable(0.1),new DoubleWritable(2),ZERO,ZERO,ZERO,new DoubleWritable(6.6),ZERO,new DoubleWritable(80),ZERO,ZERO,new IntWritable(2)));
  correct.put(2,Arrays.asList(ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,new IntWritable(33)));
  LibSvmRecordReader rr=new LibSvmRecordReader();
  Configuration config=new Configuration();
  config.setBoolean(LibSvmRecordReader.ZERO_BASED_INDEXING,false);
  config.setBoolean(LibSvmRecordReader.APPEND_LABEL,true);
  config.setInt(LibSvmRecordReader.NUM_FEATURES,10);
  rr.initialize(config,new FileSplit(new ClassPathResource("datavec-api/svmlight/basic.txt").getFile()));
  int i=0;
  while (rr.hasNext()) {
    List<Writable> record=rr.next();
    assertEquals(correct.get(i),record);
    i++;
  }
  assertEquals(i,correct.size());
}
