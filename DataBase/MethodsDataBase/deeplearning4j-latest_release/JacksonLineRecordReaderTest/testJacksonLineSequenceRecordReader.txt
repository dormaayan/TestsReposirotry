@Test public void testJacksonLineSequenceRecordReader() throws Exception {
  File dir=testDir.newFolder();
  new ClassPathResource("datavec-api/JacksonLineSequenceRecordReaderTest/").copyDirectory(dir);
  FieldSelection f=new FieldSelection.Builder().addField("a").addField(new Text("MISSING_B"),"b").addField(new Text("MISSING_CX"),"c","x").build();
  JacksonLineSequenceRecordReader rr=new JacksonLineSequenceRecordReader(f,new ObjectMapper(new JsonFactory()));
  File[] files=dir.listFiles();
  Arrays.sort(files);
  URI[] u=new URI[files.length];
  for (int i=0; i < files.length; i++) {
    u[i]=files[i].toURI();
  }
  rr.initialize(new CollectionInputSplit(u));
  List<List<Writable>> expSeq0=new ArrayList<>();
  expSeq0.add(Arrays.asList((Writable)new Text("aValue0"),new Text("bValue0"),new Text("cxValue0")));
  expSeq0.add(Arrays.asList((Writable)new Text("aValue1"),new Text("MISSING_B"),new Text("cxValue1")));
  expSeq0.add(Arrays.asList((Writable)new Text("aValue2"),new Text("bValue2"),new Text("MISSING_CX")));
  List<List<Writable>> expSeq1=new ArrayList<>();
  expSeq1.add(Arrays.asList((Writable)new Text("aValue3"),new Text("bValue3"),new Text("cxValue3")));
  int count=0;
  while (rr.hasNext()) {
    List<List<Writable>> next=rr.sequenceRecord();
    if (count++ == 0) {
      assertEquals(expSeq0,next);
    }
 else {
      assertEquals(expSeq1,next);
    }
  }
  assertEquals(2,count);
}
