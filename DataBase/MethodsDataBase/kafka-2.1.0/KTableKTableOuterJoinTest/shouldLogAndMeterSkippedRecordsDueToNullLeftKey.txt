@Test public void shouldLogAndMeterSkippedRecordsDueToNullLeftKey(){
  final StreamsBuilder builder=new StreamsBuilder();
  final Processor<String,Change<String>> join=new KTableKTableOuterJoin<>((KTableImpl<String,String,String>)builder.table("left",Consumed.with(stringSerde,stringSerde)),(KTableImpl<String,String,String>)builder.table("right",Consumed.with(stringSerde,stringSerde)),null).get();
  final MockProcessorContext context=new MockProcessorContext();
  context.setRecordMetadata("left",-1,-2,null,-3);
  join.init(context);
  final LogCaptureAppender appender=LogCaptureAppender.createAndRegister();
  join.process(null,new Change<>("new","old"));
  LogCaptureAppender.unregister(appender);
  assertEquals(1.0,getMetricByName(context.metrics().metrics(),"skipped-records-total","stream-metrics").metricValue());
  assertThat(appender.getMessages(),hasItem("Skipping record due to null key. change=[(new<-old)] topic=[left] partition=[-1] offset=[-2]"));
}
