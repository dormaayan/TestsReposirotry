@Test public void shouldIgnorePurgeDataErrors(){
  final KafkaFutureImpl<DeletedRecords> futureDeletedRecords=new KafkaFutureImpl<>();
  final Map<TopicPartition,RecordsToDelete> recordsToDelete=Collections.singletonMap(t1p1,RecordsToDelete.beforeOffset(5L));
  final DeleteRecordsResult deleteRecordsResult=new DeleteRecordsResult(Collections.singletonMap(t1p1,(KafkaFuture<DeletedRecords>)futureDeletedRecords));
  futureDeletedRecords.completeExceptionally(new Exception("KABOOM!"));
  EasyMock.expect(active.recordsToDelete()).andReturn(Collections.singletonMap(t1p1,5L)).times(2);
  EasyMock.expect(adminClient.deleteRecords(recordsToDelete)).andReturn(deleteRecordsResult).times(2);
  replay();
  taskManager.maybePurgeCommitedRecords();
  taskManager.maybePurgeCommitedRecords();
  verify(active,adminClient);
}
