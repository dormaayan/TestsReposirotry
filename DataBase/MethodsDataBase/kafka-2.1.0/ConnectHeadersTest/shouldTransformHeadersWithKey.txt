@Test public void shouldTransformHeadersWithKey(){
  populate(headers);
  iter=headers.allWithName(key);
  assertNextHeader(iter,key,Schema.BOOLEAN_SCHEMA,true);
  assertNextHeader(iter,key,Schema.INT32_SCHEMA,0);
  assertNextHeader(iter,key,Schema.OPTIONAL_STRING_SCHEMA,null);
  assertNextHeader(iter,key,Schema.STRING_SCHEMA,"third");
  assertNoNextHeader(iter);
  iter=headers.allWithName(other);
  assertOnlyNextHeader(iter,other,Schema.STRING_SCHEMA,"other value");
  assertEquals(5,headers.size());
  headers.apply(key,appendToKey("-suffix"));
  assertEquals(5,headers.size());
  assertNoHeaderWithKey(key);
  String altKey=key + "-suffix";
  iter=headers.allWithName(altKey);
  assertNextHeader(iter,altKey,Schema.BOOLEAN_SCHEMA,true);
  assertNextHeader(iter,altKey,Schema.INT32_SCHEMA,0);
  assertNextHeader(iter,altKey,Schema.OPTIONAL_STRING_SCHEMA,null);
  assertNextHeader(iter,altKey,Schema.STRING_SCHEMA,"third");
  assertNoNextHeader(iter);
  iter=headers.allWithName(other);
  assertOnlyNextHeader(iter,other,Schema.STRING_SCHEMA,"other value");
}
