@Test public void consoleShouldSuccessWithLastBuild() throws Exception {
  FreeStyleProject project=j.createFreeStyleProject("aProject");
  if (Functions.isWindows()) {
    project.getBuildersList().add(new BatchFile("echo 1"));
  }
 else {
    project.getBuildersList().add(new Shell("echo 1"));
  }
  assertThat(project.scheduleBuild2(0).get().getLog(),containsString("echo 1"));
  final CLICommandInvoker.Result result=command.authorizedTo(Jenkins.READ,Job.READ,Item.BUILD).invokeWithArgs("aProject");
  assertThat(result,succeeded());
  assertThat(result.stdout(),containsString("echo 1"));
}
