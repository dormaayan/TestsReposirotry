@Test public void testDoFilterWhenManagerDoesNotCommitResponse() throws Exception {
  ChannelProcessingFilter filter=new ChannelProcessingFilter();
  filter.setChannelDecisionManager(new MockChannelDecisionManager(false,"SOME_ATTRIBUTE"));
  MockFilterInvocationDefinitionMap fids=new MockFilterInvocationDefinitionMap("/path",true,"SOME_ATTRIBUTE");
  filter.setSecurityMetadataSource(fids);
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.setQueryString("info=now");
  request.setServletPath("/path");
  MockHttpServletResponse response=new MockHttpServletResponse();
  filter.doFilter(request,response,mock(FilterChain.class));
}
