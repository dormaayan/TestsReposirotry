@Test public void filterWhenNotExpiredThenShouldRefreshFalse(){
  this.function=new ServletOAuth2AuthorizedClientExchangeFilterFunction(this.clientRegistrationRepository,this.authorizedClientRepository);
  OAuth2RefreshToken refreshToken=new OAuth2RefreshToken("refresh-token",this.accessToken.getIssuedAt());
  OAuth2AuthorizedClient authorizedClient=new OAuth2AuthorizedClient(this.registration,"principalName",this.accessToken,refreshToken);
  ClientRequest request=ClientRequest.create(GET,URI.create("https://example.com")).attributes(oauth2AuthorizedClient(authorizedClient)).build();
  this.function.filter(request,this.exchange).block();
  List<ClientRequest> requests=this.exchange.getRequests();
  assertThat(requests).hasSize(1);
  ClientRequest request0=requests.get(0);
  assertThat(request0.headers().getFirst(HttpHeaders.AUTHORIZATION)).isEqualTo("Bearer token-0");
  assertThat(request0.url().toASCIIString()).isEqualTo("https://example.com");
  assertThat(request0.method()).isEqualTo(HttpMethod.GET);
  assertThat(getBody(request0)).isEmpty();
}
