@Test public void beforeTestMethodWhenWithMockUserTestMethodThenSecurityContextSet() throws Exception {
  Method testMethod=TheTest.class.getMethod("withMockUserTestMethod");
  when(this.testContext.getApplicationContext()).thenReturn(this.applicationContext);
  when(this.testContext.getTestMethod()).thenReturn(testMethod);
  this.listener.beforeTestMethod(this.testContext);
  assertThat(TestSecurityContextHolder.getContext().getAuthentication()).isNotNull();
  verify(this.testContext,never()).setAttribute(eq(WithSecurityContextTestExecutionListener.SECURITY_CONTEXT_ATTR_NAME),any(SecurityContext.class));
}
