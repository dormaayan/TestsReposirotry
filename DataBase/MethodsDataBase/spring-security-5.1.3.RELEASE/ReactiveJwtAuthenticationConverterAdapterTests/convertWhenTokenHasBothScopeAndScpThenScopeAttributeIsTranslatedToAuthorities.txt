@Test public void convertWhenTokenHasBothScopeAndScpThenScopeAttributeIsTranslatedToAuthorities(){
  Map<String,Object> claims=new HashMap<>();
  claims.put("scp",Arrays.asList("message:read","message:write"));
  claims.put("scope","missive:read missive:write");
  Jwt jwt=this.jwt(claims);
  AbstractAuthenticationToken authentication=this.jwtAuthenticationConverter.convert(jwt).block();
  Collection<GrantedAuthority> authorities=authentication.getAuthorities();
  assertThat(authorities).containsExactly(new SimpleGrantedAuthority("SCOPE_missive:read"),new SimpleGrantedAuthority("SCOPE_missive:write"));
}
