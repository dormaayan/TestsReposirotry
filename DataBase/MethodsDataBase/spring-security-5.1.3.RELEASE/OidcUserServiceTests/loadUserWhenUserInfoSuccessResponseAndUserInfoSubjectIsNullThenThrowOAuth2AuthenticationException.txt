@Test public void loadUserWhenUserInfoSuccessResponseAndUserInfoSubjectIsNullThenThrowOAuth2AuthenticationException(){
  this.exception.expect(OAuth2AuthenticationException.class);
  this.exception.expectMessage(containsString("invalid_user_info_response"));
  String userInfoResponse="{\n" + "	\"email\": \"full_name@provider.com\",\n" + "	\"name\": \"full name\"\n"+ "}\n";
  this.server.enqueue(jsonResponse(userInfoResponse));
  String userInfoUri=this.server.url("/user").toString();
  when(this.userInfoEndpoint.getUri()).thenReturn(userInfoUri);
  when(this.userInfoEndpoint.getUserNameAttributeName()).thenReturn(StandardClaimNames.EMAIL);
  when(this.accessToken.getTokenValue()).thenReturn("access-token");
  this.userService.loadUser(new OidcUserRequest(this.clientRegistration,this.accessToken,this.idToken));
}
