@Test public void handleWhenNotOAuth2AuthenticatedThenStatus403(){
  Authentication token=new TestingAuthenticationToken("user","pass");
  ServerWebExchange exchange=mock(ServerWebExchange.class);
  when(exchange.getPrincipal()).thenReturn(Mono.just(token));
  when(exchange.getResponse()).thenReturn(new MockServerHttpResponse());
  this.accessDeniedHandler.handle(exchange,null).block();
  assertThat(exchange.getResponse().getStatusCode()).isEqualTo(HttpStatus.FORBIDDEN);
  assertThat(exchange.getResponse().getHeaders().get("WWW-Authenticate")).isEqualTo(Arrays.asList("Bearer"));
}
