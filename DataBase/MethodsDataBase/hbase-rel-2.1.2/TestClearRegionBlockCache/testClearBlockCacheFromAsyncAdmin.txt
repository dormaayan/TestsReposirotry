@Test public void testClearBlockCacheFromAsyncAdmin() throws Exception {
  AsyncAdmin admin=ConnectionFactory.createAsyncConnection(HTU.getConfiguration()).get().getAdmin();
  BlockCache blockCache=rs1.getCacheConfig().getBlockCache();
  long initialBlockCount=blockCache.getBlockCount();
  scanAllRegionsForRS(rs1);
  assertEquals(blockCache.getBlockCount() - initialBlockCount,HTU.getNumHFilesForRS(rs1,TABLE_NAME,FAMILY));
  scanAllRegionsForRS(rs2);
  assertEquals(blockCache.getBlockCount() - initialBlockCount,HTU.getNumHFilesForRS(rs1,TABLE_NAME,FAMILY) + HTU.getNumHFilesForRS(rs2,TABLE_NAME,FAMILY));
  CacheEvictionStats stats=admin.clearBlockCache(TABLE_NAME).get();
  assertEquals(stats.getEvictedBlocks(),HTU.getNumHFilesForRS(rs1,TABLE_NAME,FAMILY) + HTU.getNumHFilesForRS(rs2,TABLE_NAME,FAMILY));
  assertEquals(initialBlockCount,blockCache.getBlockCount());
}
