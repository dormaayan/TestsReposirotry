@Test public void testUpdateHeartbeatAndUnlockForTable() throws Exception {
  LockRequest lock=getTableExclusiveLock(tableName1,testMethodName);
  final long procId=queueLock(lock);
  assertTrue(awaitForLocked(procId,2000));
  Thread.sleep(HEARTBEAT_TIMEOUT / 2);
  sendHeartbeatAndCheckLocked(procId,true);
  Thread.sleep(HEARTBEAT_TIMEOUT / 2);
  sendHeartbeatAndCheckLocked(procId,true);
  Thread.sleep(HEARTBEAT_TIMEOUT / 2);
  sendHeartbeatAndCheckLocked(procId,true);
  releaseLock(procId);
  sendHeartbeatAndCheckLocked(procId,false);
  ProcedureTestingUtility.waitProcedure(procExec,procId);
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId);
}
