@Test public void shouldBulkLoadSingleFamilyHLog() throws IOException {
  when(log.append(any(),any(),argThat(bulkLogWalEditType(WALEdit.BULK_LOAD)),anyBoolean())).thenAnswer(new Answer(){
    @Override public Object answer(    InvocationOnMock invocation){
      WALKeyImpl walKey=invocation.getArgument(1);
      MultiVersionConcurrencyControl mvcc=walKey.getMvcc();
      if (mvcc != null) {
        MultiVersionConcurrencyControl.WriteEntry we=mvcc.begin();
        walKey.setWriteEntry(we);
      }
      return 01L;
    }
  }
);
  testRegionWithFamilies(family1).bulkLoadHFiles(withFamilyPathsFor(family1),false,null);
  verify(log).sync(anyLong());
}
