@Test public void testCheckAndMutate() throws Throwable {
  try (Table table=createTable()){
    putOneRow(table);
    getOneRowAndAssertAllExist(table);
    RowMutations rm=makeRowMutationsWithColumnCDeleted();
    boolean res=table.checkAndMutate(ROWKEY,FAMILY).qualifier(Bytes.toBytes("A")).ifEquals(Bytes.toBytes("a")).thenMutate(rm);
    assertTrue(res);
    getOneRowAndAssertAllButCExist(table);
    try {
      rm=getBogusRowMutations();
      table.checkAndMutate(ROWKEY,FAMILY).qualifier(Bytes.toBytes("A")).ifEquals(Bytes.toBytes("a")).thenMutate(rm);
      fail("Expected NoSuchColumnFamilyException");
    }
 catch (    RetriesExhaustedWithDetailsException e) {
      try {
        throw e.getCause(0);
      }
 catch (      NoSuchColumnFamilyException e1) {
      }
    }
  }
 }
