@Test public void testFromPublisher() throws Exception {
  context.start();
  context.addRoutes(new RouteBuilder(){
    @Override public void configure() throws Exception {
      from("direct:source").to("direct:stream").setBody().simple("after stream: ${body}");
    }
  }
);
  crs.process("direct:stream",publisher -> Flux.from(publisher).map(e -> {
    int i=e.getIn().getBody(Integer.class);
    e.getOut().setBody(-i);
    return e;
  }
));
  for (int i=1; i <= 3; i++) {
    Assert.assertEquals("after stream: " + (-i),template.requestBody("direct:source",i,String.class));
  }
}
