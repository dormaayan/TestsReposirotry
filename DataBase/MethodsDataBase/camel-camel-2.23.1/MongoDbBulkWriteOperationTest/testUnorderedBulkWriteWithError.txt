@Test public void testUnorderedBulkWriteWithError() throws Exception {
  assertEquals(0,testCollection.count());
  pumpDataIntoTestCollection();
  List<WriteModel<DBObject>> bulkOperations=Arrays.asList(new InsertOneModel<>(new BasicDBObject("scientist","Pierre Curie")),new InsertOneModel<>(new BasicDBObject("_id","1")),new InsertOneModel<>(new BasicDBObject("scientist","Descartes")),new UpdateOneModel<>(new BasicDBObject("_id","5"),new BasicDBObject("$set",new BasicDBObject("scientist","Marie Curie"))),new DeleteOneModel<>(new BasicDBObject("_id","2")));
  try {
    template.requestBody("direct:unorderedBulkWrite",bulkOperations,BulkWriteResult.class);
    fail("Bulk operation should throw Exception");
  }
 catch (  CamelExecutionException e) {
    extractAndAssertCamelMongoDbException(e,"duplicate key error");
    assertEquals(1001,testCollection.count());
  }
}
