@Test public void testRoute() throws Exception {
  NotifyBuilder notify=new NotifyBuilder(context).whenDone(2).create();
  MockEndpoint mockEndpoint=context.getEndpoint("mock:end",MockEndpoint.class);
  mockEndpoint.expectedMessageCount(1);
  mockEndpoint.expectedBodiesReceived("HELLO");
  mockEndpoint.expectedHeaderReceived("TEST","done");
  template.requestBody("direct:start","Hello");
  assertThat("Not all exchanges were fully processed",notify.matches(5,TimeUnit.SECONDS),is(equalTo(true)));
  mockEndpoint.assertIsSatisfied();
  verify();
}
