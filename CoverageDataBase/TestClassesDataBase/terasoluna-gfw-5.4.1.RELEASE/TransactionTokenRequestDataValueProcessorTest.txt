/** 
 * Test class for TransactionTokenRequestDataValueProcessor
 */
public class TransactionTokenRequestDataValueProcessorTest {
  /** 
 * Test method for {@link org.terasoluna.gfw.web.token.transaction.TransactionTokenRequestDataValueProcessor#getExtraHiddenFields(javax.servlet.http.HttpServletRequest)}request has no next token.
 */
  @Test public void testGetExtraHiddenFields01(){
    TransactionTokenRequestDataValueProcessor processor=new TransactionTokenRequestDataValueProcessor();
    HttpServletRequest request=mock(HttpServletRequest.class);
    when((TransactionToken)request.getAttribute(TransactionTokenInterceptor.NEXT_TOKEN_REQUEST_ATTRIBUTE_NAME)).thenReturn(null);
    Map<String,String> result=processor.getExtraHiddenFields(request);
    assertThat(result,nullValue());
  }
  /** 
 * Test method for {@link org.terasoluna.gfw.web.token.transaction.TransactionTokenRequestDataValueProcessor#getExtraHiddenFields(javax.servlet.http.HttpServletRequest)}request has next token.
 */
  @Test public void testGetExtraHiddenFields02(){
    TransactionTokenRequestDataValueProcessor processor=new TransactionTokenRequestDataValueProcessor();
    HttpServletRequest request=mock(HttpServletRequest.class);
    TransactionToken token=new TransactionToken("tokenName","tokenkey","tokenValue");
    when((TransactionToken)request.getAttribute(TransactionTokenInterceptor.NEXT_TOKEN_REQUEST_ATTRIBUTE_NAME)).thenReturn(token);
    Map<String,String> result=processor.getExtraHiddenFields(request);
    Map<String,String> expected=new HashMap<String,String>();
    expected.put("_TRANSACTION_TOKEN",token.getTokenString());
    assertThat(result,is(expected));
  }
}
