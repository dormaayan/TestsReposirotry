public class TestEntityWithNonExistingTableIT {
  @Rule public ExpectedException expectException=ExpectedException.none();
  @Test public void should_fail_if_entity_table_does_not_exist() throws Exception {
    final Cluster cluster=CassandraEmbeddedServerBuilder.builder().buildNativeCluster();
    expectException.expect(AchillesException.class);
    expectException.expectMessage(format("The table %s defined on entity %s " + "does not exist in Cassandra",EntityWithNonExistingTable.TABLE,EntityWithNonExistingTable.class.getCanonicalName()));
    ManagerFactoryBuilder.builder(cluster).withManagedEntityClasses(EntityWithNonExistingTable.class).doForceSchemaCreation(false).withDefaultKeyspaceName(DEFAULT_CASSANDRA_EMBEDDED_KEYSPACE_NAME).build();
  }
}
