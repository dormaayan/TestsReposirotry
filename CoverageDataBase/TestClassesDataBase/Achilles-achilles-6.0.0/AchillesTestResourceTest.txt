public class AchillesTestResourceTest {
  private String randomKeyspace=RandomStringUtils.randomAlphabetic(20).toLowerCase();
  @Rule public AchillesTestResource<AbstractManagerFactory> resource=AchillesTestResourceBuilder.forJunit().createAndUseKeyspace(randomKeyspace).build((cluster,statementsCache) -> (AbstractManagerFactory)null);
  private Session session=resource.getNativeSession();
  @Test public void should_start_cassandra_and_create_session() throws Exception {
    assertThat(session).isNotNull();
    assertThat(session.getLoggedKeyspace()).isEqualTo(randomKeyspace);
    final Row one=session.execute("SELECT * FROM system.local LIMIT 1").one();
    assertThat(one).isNotNull();
  }
}
