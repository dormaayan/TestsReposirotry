public class ClassLevelTracing {
  @Rule public AchillesTestResource<ManagerFactory> resource=AchillesTestResourceBuilder.forJunit().entityClassesToTruncate(SimpleEntity.class).truncateBeforeAndAfterTest().build((cluster,statementsCache) -> ManagerFactoryBuilder.builder(cluster).withManagedEntityClasses(SimpleEntity.class).doForceSchemaCreation(true).withStatementsCache(statementsCache).withDefaultKeyspaceName(DEFAULT_CASSANDRA_EMBEDDED_KEYSPACE_NAME).build());
  private SimpleEntity_Manager manager=resource.getManagerFactory().forSimpleEntity();
  @Test public void should_activate_tracing_programmatically() throws Exception {
    Long id=RandomUtils.nextLong(0L,Long.MAX_VALUE);
    CassandraLogAsserter logAsserter=new CassandraLogAsserter();
    logAsserter.prepareLogLevel(SimpleEntity.class.getCanonicalName());
    manager.crud().insert(new SimpleEntity(id,new Date(),"value")).withTracing().execute();
    logAsserter.assertContains("Tracing for Query ID");
  }
}
