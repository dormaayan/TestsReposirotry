@Produces(MediaType.APPLICATION_JSON) public static class DogResource {
  private final DogDAO dogDAO;
  private final PersonDAO personDAO;
  DogResource(  DogDAO dogDAO,  PersonDAO personDAO){
    this.dogDAO=dogDAO;
    this.personDAO=personDAO;
  }
  @GET public List<Dog> findAll(  @PathParam("ownerName") String ownerName){
    return dogDAO.findByOwner(ownerName);
  }
  @GET @Path("{dogName}") @UnitOfWork(readOnly=true) public Optional<Dog> find(  @PathParam("ownerName") String ownerName,  @PathParam("dogName") String dogName){
    return dogDAO.findByOwnerAndName(ownerName,dogName);
  }
  @POST @UnitOfWork public Dog create(  @PathParam("ownerName") String ownerName,  Dog dog){
    Optional<Person> person=personDAO.findByName(ownerName);
    if (!person.isPresent()) {
      throw new WebApplicationException(404);
    }
    dog.setOwner(person.get());
    return dogDAO.persist(dog);
  }
}
