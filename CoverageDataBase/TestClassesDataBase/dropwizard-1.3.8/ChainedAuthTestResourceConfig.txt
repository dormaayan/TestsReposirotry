public static class ChainedAuthTestResourceConfig extends DropwizardResourceConfig {
  @SuppressWarnings("unchecked") public ChainedAuthTestResourceConfig(){
    super(true,new MetricRegistry());
    final Authorizer<Principal> authorizer=AuthUtil.getTestAuthorizer(ADMIN_USER,ADMIN_ROLE);
    final AuthFilter<BasicCredentials,Principal> basicAuthFilter=new BasicCredentialAuthFilter.Builder<>().setAuthenticator(AuthUtil.getBasicAuthenticator(ImmutableList.of(ADMIN_USER,ORDINARY_USER))).setAuthorizer(authorizer).buildAuthFilter();
    final AuthFilter<String,Principal> oAuthFilter=new OAuthCredentialAuthFilter.Builder<>().setAuthenticator(AuthUtil.getSingleUserOAuthAuthenticator(BEARER_USER,ADMIN_USER)).setPrefix(BEARER_PREFIX).setAuthorizer(authorizer).buildAuthFilter();
    register(new AuthValueFactoryProvider.Binder(Principal.class));
    register(new AuthDynamicFeature(new ChainedAuthFilter<>(buildHandlerList(basicAuthFilter,oAuthFilter))));
    register(RolesAllowedDynamicFeature.class);
    register(AuthResource.class);
  }
  @SuppressWarnings("unchecked") public List<AuthFilter> buildHandlerList(  AuthFilter<BasicCredentials,Principal> basicAuthFilter,  AuthFilter<String,Principal> oAuthFilter){
    return ImmutableList.of(basicAuthFilter,oAuthFilter);
  }
}
