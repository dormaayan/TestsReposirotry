/** 
 * TesterDriver that adds latency to connection requests. Latency (in ms) is the last component of the URL.
 */
class TesterConnectionDelayDriver extends TesterDriver {
  private static final String CONNECT_STRING="jdbc:apache:commons:testerConnectionDelayDriver";
  public TesterConnectionDelayDriver(){
  }
  @Override public Connection connect(  final String url,  final Properties info) throws SQLException {
    final String[] parsedUrl=url.split(":");
    final int delay=Integer.parseInt(parsedUrl[parsedUrl.length - 1]);
    try {
      Thread.sleep(delay);
    }
 catch (    final InterruptedException ex) {
      Thread.currentThread().interrupt();
    }
    return super.connect(url,info);
  }
  @Override public boolean acceptsURL(  final String url) throws SQLException {
    return url.startsWith(CONNECT_STRING);
  }
}
