/** 
 * @author Damian Szczepanik (damianszczepanik@github)
 */
public class FeatureReportPageTest extends PageTest {
  @Before public void setUp(){
    setUpWithJson(SAMPLE_JSON);
  }
  @Test public void getWebPage_ReturnsFeatureFileName(){
    Feature feature=features.get(1);
    page=new FeatureReportPage(reportResult,configuration,feature);
    String fileName=page.getWebPage();
    assertThat(fileName).isEqualTo(feature.getReportFileName());
  }
  @Test public void prepareReport_AddsCustomProperties(){
    Feature feature=features.get(1);
    page=new FeatureReportPage(reportResult,configuration,feature);
    page.prepareReport();
    VelocityContext context=page.context;
    assertThat(context.getKeys()).hasSize(9);
    assertThat(context.get("feature")).isEqualTo(feature);
  }
  @Test public void getMimeType_OnEmbeddingFromV2CucumberReportFile_SupportsScreenshots(){
    Feature feature=features.get(0);
    Element element=feature.getElements()[0];
    Step step=element.getSteps()[0];
    Embedding[] embeddings=step.getEmbeddings();
    assertThat(embeddings[0].getMimeType()).isEqualTo("image/url");
  }
  @Test public void getMimeType_OnEmbeddingFromV3CucumberReportFile_SupportsScreenshots(){
    Feature feature=features.get(0);
    Element element=feature.getElements()[0];
    Step step=element.getSteps()[0];
    Embedding[] embeddings=step.getEmbeddings();
    assertThat(embeddings[1].getMimeType()).isEqualTo("text/plain");
  }
}
