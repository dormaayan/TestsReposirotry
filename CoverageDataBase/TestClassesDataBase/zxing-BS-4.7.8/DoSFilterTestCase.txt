/** 
 * Tests  {@link DoSFilter}.
 */
public final class DoSFilterTestCase extends Assert {
  @Test public void testRedirect() throws Exception {
    MockHttpServletRequest request=new MockHttpServletRequest();
    request.setRequestURI("/");
    request.setRemoteAddr("1.2.3.4");
    HttpServletResponse response=new MockHttpServletResponse();
    DoSFilter filter=new DoSFilter();
    filter.init(null);
    for (int i=0; i < DoSFilter.MAX_ACCESS_PER_TIME; i++) {
      filter.doFilter(request,response,new MockFilterChain());
      assertEquals(HttpServletResponse.SC_OK,response.getStatus());
    }
    filter.doFilter(request,response,new MockFilterChain());
    assertEquals(HttpServletResponse.SC_FORBIDDEN,response.getStatus());
  }
}
