public class DBSetExprTest {
  private DBSetExpr expr;
  private CompanyDB testDB;
  @Before public void setup(){
    testDB=new CompanyDB();
    testDB.open(new MockDriver(),null);
    expr=new DBSetExpr(testDB.EMPLOYEE.FIRSTNAME,"JUnit");
  }
  @Test public void testGetDatabase(){
    assertEquals(testDB,expr.getDatabase());
  }
  @Test public void testAddSQL(){
    StringBuilder builder=new StringBuilder();
    expr.addSQL(builder,0);
    assertEquals("",builder.toString());
    expr.addSQL(builder,DBExpr.CTX_DEFAULT);
    assertEquals("FIRSTNAME='JUnit'",builder.toString());
  }
  @Test public void testAddSQLEmptyString(){
    StringBuilder builder=new StringBuilder();
    DBSetExpr setExpr=new DBSetExpr(testDB.EMPLOYEE.FIRSTNAME,"");
    setExpr.addSQL(builder,DBExpr.CTX_DEFAULT);
    assertEquals("FIRSTNAME=null",builder.toString());
  }
  @Test public void testAddSQLEmptyStringConstant(){
    StringBuilder builder=new StringBuilder();
    DBSetExpr setExpr=new DBSetExpr(testDB.EMPLOYEE.FIRSTNAME,DBDatabase.EMPTY_STRING);
    setExpr.addSQL(builder,DBExpr.CTX_DEFAULT);
    assertEquals("FIRSTNAME=''",builder.toString());
  }
  @Test public void testAddReferencedColumns(){
    Set<DBColumn> cols=new HashSet<DBColumn>();
    expr.addReferencedColumns(cols);
    assertTrue(cols.contains(testDB.EMPLOYEE.FIRSTNAME));
  }
  @Test public void testGetTable(){
    assertEquals(testDB.EMPLOYEE,expr.getTable());
  }
  @Test public void testGetColumn(){
    assertEquals(testDB.EMPLOYEE.FIRSTNAME,expr.getColumn());
  }
  @Test public void testGetValue(){
    assertEquals("JUnit",expr.getValue());
  }
  @Test public void testSetValue(){
    expr.setValue("JUnit2");
    assertEquals("JUnit2",expr.getValue());
  }
}
