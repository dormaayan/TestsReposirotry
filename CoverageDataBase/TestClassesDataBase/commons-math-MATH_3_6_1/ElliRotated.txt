private static class ElliRotated implements MultivariateFunction {
  private Basis B=new Basis();
  private double factor;
  ElliRotated(){
    this(1e3);
  }
  ElliRotated(  double axisratio){
    factor=axisratio * axisratio;
  }
  public double value(  double[] x){
    double f=0;
    x=B.Rotate(x);
    for (int i=0; i < x.length; ++i)     f+=FastMath.pow(factor,i / (x.length - 1.)) * x[i] * x[i];
    return f;
  }
}
