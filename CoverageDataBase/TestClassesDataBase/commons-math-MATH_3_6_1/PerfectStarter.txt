private static class PerfectStarter extends AbstractIntegrator {
  private final PerfectInterpolator interpolator;
  private final int nbSteps;
  public PerfectStarter(  final TestProblemAbstract problem,  final int nbSteps){
    this.interpolator=new PerfectInterpolator(problem);
    this.nbSteps=nbSteps;
  }
  public void integrate(  ExpandableStatefulODE equations,  double t){
    double tStart=equations.getTime() + 0.01 * (t - equations.getTime());
    getCounter().increment(nbSteps);
    for (int i=0; i < nbSteps; ++i) {
      double tK=((nbSteps - 1 - (i + 1)) * equations.getTime() + (i + 1) * tStart) / (nbSteps - 1);
      interpolator.setPreviousTime(interpolator.getCurrentTime());
      interpolator.setCurrentTime(tK);
      interpolator.setInterpolatedTime(tK);
      for (      StepHandler handler : getStepHandlers()) {
        handler.handleStep(interpolator,i == nbSteps - 1);
      }
    }
  }
}
