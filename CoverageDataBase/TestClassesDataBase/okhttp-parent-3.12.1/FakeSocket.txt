private class FakeSocket extends Socket {
  private final InetAddress localAddress;
  private final int remotePort;
  private final InetAddress remoteAddress;
  private final int localPort;
  private FakeSocket(  int localPort){
    this(Inet4Address.getLoopbackAddress(),localPort);
  }
  private FakeSocket(  InetAddress inetAddress,  int localPort){
    this(inetAddress,localPort,inetAddress,1234);
  }
  private FakeSocket(  InetAddress localAddress,  int localPort,  InetAddress remoteAddress,  int remotePort){
    this.localAddress=localAddress;
    this.localPort=localPort;
    this.remoteAddress=remoteAddress;
    this.remotePort=remotePort;
  }
  @Override public InetAddress getInetAddress(){
    return remoteAddress;
  }
  @Override public InetAddress getLocalAddress(){
    return localAddress;
  }
  @Override public int getLocalPort(){
    return localPort;
  }
  @Override public int getPort(){
    return remotePort;
  }
}
