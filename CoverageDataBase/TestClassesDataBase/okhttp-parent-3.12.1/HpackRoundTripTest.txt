/** 
 * Tests for round-tripping headers through hpack..
 */
@RunWith(Parameterized.class) public class HpackRoundTripTest extends HpackDecodeTestBase {
  private static final String[] RAW_DATA={"raw-data"};
  @Parameterized.Parameters(name="{0}") public static Collection<Story[]> getStories() throws Exception {
    return createStories(RAW_DATA);
  }
  private Buffer bytesOut=new Buffer();
  private Hpack.Writer hpackWriter=new Hpack.Writer(bytesOut);
  public HpackRoundTripTest(  Story story){
    super(story);
  }
  @Test public void testRoundTrip() throws Exception {
    Story story=getStory().clone();
    for (    Case caze : story.getCases()) {
      hpackWriter.writeHeaders(caze.getHeaders());
      caze.setWire(bytesOut.readByteString());
    }
    testDecoder(story);
  }
}
