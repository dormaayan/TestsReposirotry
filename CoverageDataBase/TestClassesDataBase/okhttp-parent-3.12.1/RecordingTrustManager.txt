private static class RecordingTrustManager implements X509TrustManager {
  private final List<String> calls=new ArrayList<>();
  private final X509TrustManager delegate;
  RecordingTrustManager(  X509TrustManager delegate){
    this.delegate=delegate;
  }
  public X509Certificate[] getAcceptedIssuers(){
    return delegate.getAcceptedIssuers();
  }
  public void checkClientTrusted(  X509Certificate[] chain,  String authType){
    calls.add("checkClientTrusted " + certificatesToString(chain));
  }
  public void checkServerTrusted(  X509Certificate[] chain,  String authType){
    calls.add("checkServerTrusted " + certificatesToString(chain));
  }
  private String certificatesToString(  X509Certificate[] certificates){
    List<String> result=new ArrayList<>();
    for (    X509Certificate certificate : certificates) {
      result.add(certificate.getSubjectDN() + " " + certificate.getSerialNumber());
    }
    return result.toString();
  }
}
