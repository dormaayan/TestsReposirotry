private static class RecordingSSLSocketFactory extends DelegatingSSLSocketFactory {
  private List<SSLSocket> socketsCreated=new ArrayList<>();
  public RecordingSSLSocketFactory(  SSLSocketFactory delegate){
    super(delegate);
  }
  @Override protected SSLSocket configureSocket(  SSLSocket sslSocket) throws IOException {
    socketsCreated.add(sslSocket);
    return sslSocket;
  }
  public List<SSLSocket> getSocketsCreated(){
    return socketsCreated;
  }
}
