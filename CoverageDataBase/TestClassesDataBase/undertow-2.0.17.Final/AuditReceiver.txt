protected static class AuditReceiver implements NotificationReceiver {
  private final List<SecurityNotification> receivedNotifications=new ArrayList<>();
  @Override public void handleNotification(  SecurityNotification notification){
    receivedNotifications.add(notification);
  }
  public List<SecurityNotification> takeNotifications(){
    try {
      return new ArrayList<>(receivedNotifications);
    }
  finally {
      receivedNotifications.clear();
    }
  }
}
