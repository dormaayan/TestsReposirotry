/** 
 * A test case to test the SPNEGO authentication mechanism with a fallback to BASIC authentication.
 * @author <a href="mailto:darran.lofthouse@jboss.com">Darran Lofthouse</a>
 */
@RunWith(DefaultServer.class) public class SpnegoBasicAuthenticationTestCase extends SpnegoAuthenticationTestCase {
  @Override protected List<AuthenticationMechanism> getTestMechanisms(){
    ArrayList<AuthenticationMechanism> mechanisms=new ArrayList<>(super.getTestMechanisms());
    mechanisms.add(BasicAuthenticationTestCase.getTestMechanism());
    return mechanisms;
  }
  @Test public void testBasicSuccess() throws Exception {
    _testBasicSuccess();
    assertSingleNotificationType(EventType.AUTHENTICATED);
  }
  @Test public void testBadUserName() throws Exception {
    _testBadUserName();
    assertSingleNotificationType(EventType.FAILED_AUTHENTICATION);
  }
  @Test public void testBadPassword() throws Exception {
    _testBadPassword();
    assertSingleNotificationType(EventType.FAILED_AUTHENTICATION);
  }
}
