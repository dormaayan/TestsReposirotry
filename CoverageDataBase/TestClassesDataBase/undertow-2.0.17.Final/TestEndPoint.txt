class TestEndPoint extends Endpoint {
  @Override public void onOpen(  final Session session,  EndpointConfig config){
    connected.set(true);
    session.addMessageHandler(new MessageHandler.Partial<String>(){
      StringBuilder sb=new StringBuilder();
      @Override public void onMessage(      String message,      boolean last){
        sb.append(message);
        if (!last) {
          return;
        }
        session.getAsyncRemote().sendText(sb.toString());
      }
    }
);
  }
}
