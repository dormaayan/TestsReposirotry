public class BaseCassandraClusterTest extends BaseEmbededServerSetupTest {
  private ThriftCluster cassandraCluster;
  private CassandraHostConfigurator cassandraHostConfigurator;
  @Before public void setupCase() throws TTransportException, TException, IllegalArgumentException, NotFoundException, UnknownHostException, Exception {
    cassandraHostConfigurator=getCHCForTest();
    cassandraCluster=new ThriftCluster(clusterName,cassandraHostConfigurator);
  }
  @Test public void testDescribeKeyspaces() throws Exception {
    List<KeyspaceDefinition> keyspaces=cassandraCluster.describeKeyspaces();
    assertEquals(3,keyspaces.size());
  }
  @Test public void testDescribeKeyspace() throws Exception {
    KeyspaceDefinition keyspaceDetail=cassandraCluster.describeKeyspace("Keyspace1");
    assertNotNull(keyspaceDetail);
    assertEquals(22,keyspaceDetail.getCfDefs().size());
  }
}
