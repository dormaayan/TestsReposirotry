@RunWith(value=Parameterized.class) public class StringSerializerTest {
  private final String str;
  private static final StringSerializer s=StringSerializer.get();
  public StringSerializerTest(  String str){
    this.str=str;
  }
  @Parameters public static Collection<Object[]> data() throws UnsupportedEncodingException {
    Object[][] data=new Object[][]{{""},{null},{"123"},{"QWER"},{"!@#$#$^%&^*fdghdfghdfgh%^&*"},{new String("\u05E9".getBytes(),"utf-8")},{RandomStringUtils.random(256 * 256)}};
    return Arrays.asList(data);
  }
  @Test public void test() throws Exception {
    Assert.assertEquals(str,s.fromByteBuffer(s.toByteBuffer(str)));
    if (str != null) {
      Assert.assertEquals(str,ByteBufferUtil.string(ByteBufferUtil.bytes(str)));
    }
    if (str != null) {
      UTF8Type.instance.validate(s.toByteBuffer(str));
    }
  }
}
