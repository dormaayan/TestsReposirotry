@State(Scope.Thread) @BenchmarkMode(Mode.Throughput) @OutputTimeUnit(TimeUnit.SECONDS) public class AnySatisfyTest extends AbstractJMHTestRunner {
  private static final int SIZE=1_000_000;
  private static final int BATCH_SIZE=10_000;
  private final List<Integer> integersJDK=new ArrayList<>(Interval.oneTo(SIZE));
  private final FastList<Integer> integersGSC=FastList.newList(Interval.oneTo(SIZE));
  private ExecutorService executorService;
  @Setup public void setUp(){
    this.executorService=Executors.newFixedThreadPool(Runtime.getRuntime().availableProcessors());
  }
  @TearDown public void tearDown() throws InterruptedException {
    this.executorService.shutdownNow();
    this.executorService.awaitTermination(1L,TimeUnit.SECONDS);
  }
  @Benchmark public void short_circuit_middle_serial_lazy_jdk(){
    Assert.assertTrue(this.integersJDK.stream().anyMatch(each -> each > SIZE / 2));
  }
  @Benchmark public void short_circuit_middle_serial_lazy_streams_gsc(){
    Assert.assertTrue(this.integersGSC.stream().anyMatch(each -> each > SIZE / 2));
  }
  @Benchmark public void process_all_serial_lazy_jdk(){
    Assert.assertFalse(this.integersJDK.stream().anyMatch(each -> each < 0));
  }
  @Benchmark public void process_all_serial_lazy_streams_gsc(){
    Assert.assertFalse(this.integersGSC.stream().anyMatch(each -> each < 0));
  }
  @Benchmark public void short_circuit_middle_serial_eager_gsc(){
    Assert.assertTrue(this.integersGSC.anySatisfy(each -> each > SIZE / 2));
  }
  @Benchmark public void process_all_serial_eager_gsc(){
    Assert.assertFalse(this.integersGSC.anySatisfy(each -> each < 0));
  }
  @Benchmark public void short_circuit_middle_serial_lazy_gsc(){
    Assert.assertTrue(this.integersGSC.asLazy().anySatisfy(each -> each > SIZE / 2));
  }
  @Benchmark public void process_all_serial_lazy_gsc(){
    Assert.assertFalse(this.integersGSC.asLazy().anySatisfy(each -> each < 0));
  }
  @Benchmark public void short_circuit_middle_serial_eager_scala(){
    AnySatisfyScalaTest.short_circuit_middle_serial_eager_scala();
  }
  @Benchmark public void process_all_serial_eager_scala(){
    AnySatisfyScalaTest.process_all_serial_eager_scala();
  }
  @Benchmark public void short_circuit_middle_serial_lazy_scala(){
    AnySatisfyScalaTest.short_circuit_middle_serial_lazy_scala();
  }
  @Benchmark public void process_all_serial_lazy_scala(){
    AnySatisfyScalaTest.process_all_serial_lazy_scala();
  }
  @Benchmark public void short_circuit_middle_parallel_lazy_jdk(){
    Assert.assertTrue(this.integersJDK.parallelStream().anyMatch(each -> each == SIZE / 2 - 1));
  }
  @Benchmark public void short_circuit_middle_parallel_lazy_streams_gsc(){
    Assert.assertTrue(this.integersGSC.parallelStream().anyMatch(each -> each == SIZE / 2 - 1));
  }
  @Benchmark public void process_all_parallel_lazy_jdk(){
    Assert.assertFalse(this.integersJDK.parallelStream().anyMatch(each -> each < 0));
  }
  @Benchmark public void process_all_parallel_lazy_streams_gsc(){
    Assert.assertFalse(this.integersGSC.parallelStream().anyMatch(each -> each < 0));
  }
  @Benchmark public void short_circuit_middle_parallel_lazy_gsc(){
    Assert.assertTrue(this.integersGSC.asParallel(this.executorService,BATCH_SIZE).anySatisfy(each -> each == SIZE / 2 - 1));
  }
  @Benchmark public void process_all_parallel_lazy_gsc(){
    Assert.assertFalse(this.integersGSC.asParallel(this.executorService,BATCH_SIZE).anySatisfy(each -> each < 0));
  }
  @Benchmark public void short_circuit_middle_parallel_lazy_scala(){
    AnySatisfyScalaTest.short_circuit_middle_parallel_lazy_scala();
  }
  @Benchmark public void process_all_parallel_lazy_scala(){
    AnySatisfyScalaTest.process_all_parallel_lazy_scala();
  }
}
