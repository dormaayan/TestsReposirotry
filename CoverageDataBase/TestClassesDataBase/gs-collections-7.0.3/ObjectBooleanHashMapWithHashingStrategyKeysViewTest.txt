/** 
 * JUnit test for  {@link ObjectBooleanHashMapWithHashingStrategy#keysView()}.
 */
public class ObjectBooleanHashMapWithHashingStrategyKeysViewTest extends AbstractLazyIterableTestCase {
  private static final HashingStrategy<String> STRING_HASHING_STRATEGY=HashingStrategies.nullSafeHashingStrategy(new HashingStrategy<String>(){
    public int computeHashCode(    String object){
      return object.hashCode();
    }
    public boolean equals(    String object1,    String object2){
      return object1.equals(object2);
    }
  }
);
  @Override protected <T>LazyIterable<T> newWith(  T... elements){
    ObjectBooleanHashMapWithHashingStrategy<T> map=new ObjectBooleanHashMapWithHashingStrategy<>(HashingStrategies.nullSafeHashingStrategy(HashingStrategies.<T>defaultStrategy()));
    for (int i=0; i < elements.length; i++) {
      map.put(elements[i],(i & 1) == 0);
    }
    return map.keysView();
  }
  @Override public void iterator(){
    MutableSet<String> expected=UnifiedSet.newSetWith("zero","thirtyOne","thirtyTwo");
    MutableSet<String> actual=UnifiedSet.newSet();
    Iterator<String> iterator=ObjectBooleanHashMapWithHashingStrategy.newWithKeysValues(STRING_HASHING_STRATEGY,"zero",true,"thirtyOne",false,"thirtyTwo",true).keysView().iterator();
    Assert.assertTrue(iterator.hasNext());
    actual.add(iterator.next());
    Verify.assertThrows(UnsupportedOperationException.class,iterator::remove);
    Assert.assertTrue(iterator.hasNext());
    actual.add(iterator.next());
    Assert.assertTrue(iterator.hasNext());
    actual.add(iterator.next());
    Assert.assertFalse(iterator.hasNext());
    Assert.assertEquals(expected,actual);
    Verify.assertThrows(NoSuchElementException.class,(Runnable)iterator::next);
  }
}
