@Test public void testDoS() throws Exception {
  Timer timer=new Timer();
  long timerTimeMS=200;
  DoSTracker tracker=new DoSTracker(timer,2,timerTimeMS,3);
  assertFalse(tracker.isBanned("A"));
  assertFalse(tracker.isBanned("A"));
  assertTrue(tracker.isBanned("A"));
  assertFalse(tracker.isBanned("B"));
  assertFalse(tracker.isBanned("C"));
  assertFalse(tracker.isBanned("D"));
  assertFalse(tracker.isBanned("A"));
  assertFalse(tracker.isBanned("A"));
  assertTrue(tracker.isBanned("A"));
  Thread.sleep(timerTimeMS * 3);
  assertFalse(tracker.isBanned("A"));
  assertFalse(tracker.isBanned("A"));
  for (int i=0; i < 10; i++) {
    assertTrue(tracker.isBanned("A"));
  }
  Thread.sleep(timerTimeMS * 2);
  assertTrue(tracker.isBanned("A"));
}
