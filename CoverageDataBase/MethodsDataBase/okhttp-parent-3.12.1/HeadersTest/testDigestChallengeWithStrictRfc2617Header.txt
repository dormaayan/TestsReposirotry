/** 
 * See https://github.com/square/okhttp/issues/2780. 
 */
@Test public void testDigestChallengeWithStrictRfc2617Header(){
  Headers headers=new Headers.Builder().add("WWW-Authenticate","Digest realm=\"myrealm\", nonce=\"fjalskdflwejrlaskdfjlaskdjflaks" + "jdflkasdf\", qop=\"auth\", stale=\"FALSE\"").build();
  List<Challenge> challenges=HttpHeaders.parseChallenges(headers,"WWW-Authenticate");
  assertEquals(1,challenges.size());
  assertEquals("Digest",challenges.get(0).scheme());
  assertEquals("myrealm",challenges.get(0).realm());
  Map<String,String> expectedAuthParams=new LinkedHashMap<>();
  expectedAuthParams.put("realm","myrealm");
  expectedAuthParams.put("nonce","fjalskdflwejrlaskdfjlaskdjflaksjdflkasdf");
  expectedAuthParams.put("qop","auth");
  expectedAuthParams.put("stale","FALSE");
  assertEquals(expectedAuthParams,challenges.get(0).authParams());
}
