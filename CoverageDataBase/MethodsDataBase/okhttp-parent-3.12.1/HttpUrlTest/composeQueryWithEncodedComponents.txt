@Test public void composeQueryWithEncodedComponents() throws Exception {
  HttpUrl base=parse("http://host/");
  HttpUrl url=base.newBuilder().addEncodedQueryParameter("a+=& b","c+=& d").build();
  assertEquals("http://host/?a+%3D%26%20b=c+%3D%26%20d",url.toString());
  assertEquals("c =& d",url.queryParameter("a =& b"));
}
