@Test public void postByteEntity() throws Exception {
  server.enqueue(new MockResponse());
  final HttpPost post=new HttpPost(server.url("/").url().toURI());
  byte[] body="Hello, world!".getBytes(UTF_8);
  post.setEntity(new ByteArrayEntity(body));
  client.execute(post);
  RecordedRequest request=server.takeRequest();
  assertEquals("Hello, world!",request.getBody().readUtf8());
  assertEquals(request.getHeader("Content-Length"),"13");
}
