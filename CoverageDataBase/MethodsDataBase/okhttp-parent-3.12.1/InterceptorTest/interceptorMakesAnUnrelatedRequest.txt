/** 
 * Make sure interceptors can interact with the OkHttp client. 
 */
@Test public void interceptorMakesAnUnrelatedRequest() throws Exception {
  server.enqueue(new MockResponse().setBody("a"));
  server.enqueue(new MockResponse().setBody("b"));
  client=client.newBuilder().addInterceptor(new Interceptor(){
    @Override public Response intercept(    Chain chain) throws IOException {
      if (chain.request().url().encodedPath().equals("/b")) {
        Request requestA=new Request.Builder().url(server.url("/a")).build();
        Response responseA=client.newCall(requestA).execute();
        assertEquals("a",responseA.body().string());
      }
      return chain.proceed(chain.request());
    }
  }
).build();
  Request requestB=new Request.Builder().url(server.url("/b")).build();
  Response responseB=client.newCall(requestB).execute();
  assertEquals("b",responseB.body().string());
}
