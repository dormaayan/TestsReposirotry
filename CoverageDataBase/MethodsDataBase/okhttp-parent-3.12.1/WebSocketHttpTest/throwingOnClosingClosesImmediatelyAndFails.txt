@Test public void throwingOnClosingClosesImmediatelyAndFails(){
  webServer.enqueue(new MockResponse().withWebSocketUpgrade(serverListener));
  newWebSocket();
  clientListener.assertOpen();
  WebSocket server=serverListener.assertOpen();
  final RuntimeException e=new RuntimeException();
  clientListener.setNextEventDelegate(new WebSocketListener(){
    @Override public void onClosing(    WebSocket webSocket,    int code,    String reason){
      throw e;
    }
  }
);
  server.close(1000,"bye");
  clientListener.assertFailure(e);
  serverListener.assertFailure();
  serverListener.assertExhausted();
}
