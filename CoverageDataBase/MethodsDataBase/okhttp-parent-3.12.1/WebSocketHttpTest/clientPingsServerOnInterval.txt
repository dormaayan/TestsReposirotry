@Test public void clientPingsServerOnInterval() throws Exception {
  client=client.newBuilder().pingInterval(500,TimeUnit.MILLISECONDS).build();
  webServer.enqueue(new MockResponse().withWebSocketUpgrade(serverListener));
  RealWebSocket webSocket=newWebSocket();
  clientListener.assertOpen();
  RealWebSocket server=(RealWebSocket)serverListener.assertOpen();
  long startNanos=System.nanoTime();
  while (webSocket.receivedPongCount() < 3) {
    Thread.sleep(50);
  }
  long elapsedUntilPong3=System.nanoTime() - startNanos;
  assertEquals(1500,TimeUnit.NANOSECONDS.toMillis(elapsedUntilPong3),250d);
  assertEquals(3,webSocket.sentPingCount());
  assertEquals(3,server.receivedPingCount());
  assertEquals(3,webSocket.receivedPongCount());
  assertEquals(0,server.receivedPongCount());
  assertEquals(0,webSocket.receivedPingCount());
}
