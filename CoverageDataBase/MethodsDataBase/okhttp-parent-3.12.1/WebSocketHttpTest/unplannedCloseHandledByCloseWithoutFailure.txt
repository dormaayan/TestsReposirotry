@Test public void unplannedCloseHandledByCloseWithoutFailure(){
  webServer.enqueue(new MockResponse().withWebSocketUpgrade(serverListener));
  newWebSocket();
  clientListener.assertOpen();
  WebSocket server=serverListener.assertOpen();
  clientListener.setNextEventDelegate(new WebSocketListener(){
    @Override public void onClosing(    WebSocket webSocket,    int code,    String reason){
      webSocket.close(1000,null);
    }
  }
);
  server.close(1001,"bye");
  clientListener.assertClosed(1001,"bye");
  clientListener.assertExhausted();
  serverListener.assertClosing(1000,"");
  serverListener.assertClosed(1000,"");
  serverListener.assertExhausted();
}
