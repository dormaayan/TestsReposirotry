@Test public void interruptReadingResponseBody() throws Exception {
  int responseBodySize=2 * 1024 * 1024;
  server.enqueue(new MockResponse().setBody(new Buffer().write(new byte[responseBodySize])).throttleBody(64 * 1024,125,TimeUnit.MILLISECONDS));
  server.start();
  interruptLater(500);
  HttpURLConnection connection=new OkUrlFactory(client).open(server.url("/").url());
  InputStream responseBody=connection.getInputStream();
  byte[] buffer=new byte[1024];
  try {
    while (responseBody.read(buffer) != -1) {
    }
    fail("Expected thread to be interrupted");
  }
 catch (  InterruptedIOException expected) {
    assertTrue(Thread.interrupted());
  }
  responseBody.close();
}
