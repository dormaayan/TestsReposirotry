@Test public void handlesBadUnicodeStringsInDefaultUserAgent() throws Exception {
  String userAgent="ðŸ”Š".substring(0,1);
  String expected="?";
  System.setProperty("http.agent",userAgent);
  server.enqueue(new MockResponse().setResponseCode(200));
  InputStream inputStream=factory.open(server.url("/").url()).getInputStream();
  long skipped;
  do {
    skipped=inputStream.skip(Long.MAX_VALUE);
  }
 while (skipped != 0);
  RecordedRequest recordedRequest=server.takeRequest();
  assertEquals(expected,recordedRequest.getHeader("User-Agent"));
}
