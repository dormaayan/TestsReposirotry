@Test public void testURLFilter() throws Exception {
  server.enqueue(new MockResponse().setBody("B"));
  final URL blockedURL=server.url("/a").url();
  factory.setUrlFilter(new URLFilter(){
    @Override public void checkURLPermitted(    URL url) throws IOException {
      if (blockedURL.equals(url)) {
        throw new IOException("Blocked");
      }
    }
  }
);
  try {
    HttpURLConnection connection=factory.open(server.url("/a").url());
    connection.getInputStream();
    fail("Connection was successful");
  }
 catch (  IOException e) {
    assertEquals("Blocked",e.getMessage());
  }
  HttpURLConnection connection=factory.open(server.url("/b").url());
  assertResponseBody(connection,"B");
}
