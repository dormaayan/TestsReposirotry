@Test public void networkInterceptorInvokedForConditionalGet() throws Exception {
  server.enqueue(new MockResponse().addHeader("ETag: v1").setBody("A"));
  server.enqueue(new MockResponse().setResponseCode(HttpURLConnection.HTTP_NOT_MODIFIED));
  HttpUrl url=server.url("/");
  assertEquals("A",get(url).body().string());
  final AtomicReference<String> ifNoneMatch=new AtomicReference<>();
  client=client.newBuilder().addNetworkInterceptor(new Interceptor(){
    @Override public Response intercept(    Chain chain) throws IOException {
      ifNoneMatch.compareAndSet(null,chain.request().header("If-None-Match"));
      return chain.proceed(chain.request());
    }
  }
).build();
  assertEquals("A",get(url).body().string());
  assertEquals("v1",ifNoneMatch.get());
}
