@Test public void successfulDnsLookup() throws IOException {
  server.enqueue(new MockResponse());
  Call call=client.newCall(new Request.Builder().url(server.url("/")).build());
  Response response=call.execute();
  assertEquals(200,response.code());
  response.body().close();
  DnsStart dnsStart=listener.removeUpToEvent(DnsStart.class);
  assertSame(call,dnsStart.call);
  assertEquals(server.getHostName(),dnsStart.domainName);
  DnsEnd dnsEnd=listener.removeUpToEvent(DnsEnd.class);
  assertSame(call,dnsEnd.call);
  assertEquals(server.getHostName(),dnsEnd.domainName);
  assertEquals(1,dnsEnd.inetAddressList.size());
}
