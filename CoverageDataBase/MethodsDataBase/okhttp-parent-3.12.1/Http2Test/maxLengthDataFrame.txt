@Test public void maxLengthDataFrame() throws IOException {
  final byte[] expectedData=new byte[Http2.INITIAL_MAX_FRAME_SIZE];
  Arrays.fill(expectedData,(byte)2);
  writeMedium(frame,expectedData.length);
  frame.writeByte(Http2.TYPE_DATA);
  frame.writeByte(Http2.FLAG_NONE);
  frame.writeInt(expectedStreamId & 0x7fffffff);
  frame.write(expectedData);
  assertEquals(frame,sendDataFrame(new Buffer().write(expectedData)));
  reader.nextFrame(false,new BaseTestHandler(){
    @Override public void data(    boolean inFinished,    int streamId,    BufferedSource source,    int length) throws IOException {
      assertFalse(inFinished);
      assertEquals(expectedStreamId,streamId);
      assertEquals(Http2.INITIAL_MAX_FRAME_SIZE,length);
      ByteString data=source.readByteString(length);
      for (      byte b : data.toByteArray()) {
        assertEquals(2,b);
      }
    }
  }
);
}
