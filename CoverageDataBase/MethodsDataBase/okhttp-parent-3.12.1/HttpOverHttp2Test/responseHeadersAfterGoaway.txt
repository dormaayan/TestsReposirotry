@Test public void responseHeadersAfterGoaway() throws Exception {
  server.enqueue(new MockResponse().setHeadersDelay(1,SECONDS).setBody("ABC"));
  server.enqueue(new MockResponse().setSocketPolicy(SocketPolicy.DISCONNECT_AT_END).setBody("DEF"));
  final BlockingQueue<String> bodies=new SynchronousQueue<>();
  Callback callback=new Callback(){
    @Override public void onResponse(    Call call,    Response response) throws IOException {
      bodies.add(response.body().string());
    }
    @Override public void onFailure(    Call call,    IOException e){
      System.out.println(e);
    }
  }
;
  client.newCall(new Request.Builder().url(server.url("/")).build()).enqueue(callback);
  client.newCall(new Request.Builder().url(server.url("/")).build()).enqueue(callback);
  assertEquals("DEF",bodies.poll(2,SECONDS));
  assertEquals("ABC",bodies.poll(2,SECONDS));
  assertEquals(2,server.getRequestCount());
}
