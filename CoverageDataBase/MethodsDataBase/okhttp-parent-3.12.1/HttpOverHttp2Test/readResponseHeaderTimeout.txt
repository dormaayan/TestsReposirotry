@Test public void readResponseHeaderTimeout() throws Exception {
  server.enqueue(new MockResponse().setSocketPolicy(SocketPolicy.NO_RESPONSE));
  server.enqueue(new MockResponse().setBody("A"));
  client=client.newBuilder().readTimeout(1000,MILLISECONDS).build();
  Call call1=client.newCall(new Request.Builder().url(server.url("/")).build());
  try {
    call1.execute();
    fail("Should have timed out!");
  }
 catch (  SocketTimeoutException expected) {
    assertEquals("timeout",expected.getMessage());
  }
  Call call2=client.newCall(new Request.Builder().url(server.url("/")).build());
  Response response2=call2.execute();
  assertEquals("A",response2.body().string());
  assertEquals(0,server.takeRequest().getSequenceNumber());
  assertEquals(1,server.takeRequest().getSequenceNumber());
}
