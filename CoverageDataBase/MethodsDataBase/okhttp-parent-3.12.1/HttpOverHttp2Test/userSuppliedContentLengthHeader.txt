@Test public void userSuppliedContentLengthHeader() throws Exception {
  final byte[] postBytes="FGHIJ".getBytes(Util.UTF_8);
  server.enqueue(new MockResponse().setBody("ABCDE"));
  Call call=client.newCall(new Request.Builder().url(server.url("/foo")).post(new RequestBody(){
    @Override public MediaType contentType(){
      return MediaType.get("text/plain; charset=utf-8");
    }
    @Override public long contentLength(){
      return postBytes.length;
    }
    @Override public void writeTo(    BufferedSink sink) throws IOException {
      sink.write(postBytes);
    }
  }
).build());
  Response response=call.execute();
  assertEquals("ABCDE",response.body().string());
  RecordedRequest request=server.takeRequest();
  assertEquals("POST /foo HTTP/1.1",request.getRequestLine());
  assertArrayEquals(postBytes,request.getBody().readByteArray());
  assertEquals(postBytes.length,Integer.parseInt(request.getHeader("Content-Length")));
}
