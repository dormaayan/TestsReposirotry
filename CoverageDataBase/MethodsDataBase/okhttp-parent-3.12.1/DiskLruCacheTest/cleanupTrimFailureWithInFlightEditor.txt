@Test public void cleanupTrimFailureWithInFlightEditor() throws Exception {
  cache.setMaxSize(8);
  executor.jobs.pop();
  set("a","aa","aaa");
  set("b","bb","bb");
  DiskLruCache.Editor inFlightEditor=cache.edit("c");
  fileSystem.setFaultyDelete(new File(cacheDir,"a.0"),true);
  executor.jobs.pop().run();
  setString(inFlightEditor,0,"cc");
  setString(inFlightEditor,1,"cc");
  inFlightEditor.commit();
  fileSystem.setFaultyDelete(new File(cacheDir,"a.0"),false);
  executor.jobs.pop().run();
  assertValue("c","cc","cc");
}
