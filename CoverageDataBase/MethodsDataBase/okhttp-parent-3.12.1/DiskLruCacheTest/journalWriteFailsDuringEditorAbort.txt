@Test public void journalWriteFailsDuringEditorAbort() throws Exception {
  set("a","a","a");
  set("b","b","b");
  DiskLruCache.Editor editor=cache.edit("c");
  setString(editor,0,"c");
  setString(editor,1,"c");
  fileSystem.setFaultyWrite(journalFile,true);
  editor.abort();
  fileSystem.setFaultyWrite(journalFile,false);
  assertNull(cache.edit("d"));
  cache.close();
  cache=new DiskLruCache(fileSystem,cacheDir,appVersion,2,Integer.MAX_VALUE,executor);
  assertValue("a","a","a");
  assertValue("b","b","b");
  assertAbsent("c");
  assertAbsent("d");
}
