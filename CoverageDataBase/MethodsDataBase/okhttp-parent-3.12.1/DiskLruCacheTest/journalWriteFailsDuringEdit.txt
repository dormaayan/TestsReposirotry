@Test public void journalWriteFailsDuringEdit() throws Exception {
  set("a","a","a");
  set("b","b","b");
  fileSystem.setFaultyWrite(journalFile,true);
  assertNull(cache.edit("c"));
  fileSystem.setFaultyWrite(journalFile,false);
  assertNull(cache.edit("d"));
  cache.close();
  cache=new DiskLruCache(fileSystem,cacheDir,appVersion,2,Integer.MAX_VALUE,executor);
  assertValue("a","a","a");
  assertValue("b","b","b");
  assertAbsent("c");
  assertAbsent("d");
}
