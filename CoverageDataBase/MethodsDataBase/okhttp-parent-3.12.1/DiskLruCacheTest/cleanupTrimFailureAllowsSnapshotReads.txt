@Test public void cleanupTrimFailureAllowsSnapshotReads() throws Exception {
  cache.setMaxSize(8);
  executor.jobs.pop();
  set("a","aa","aa");
  set("b","bb","bbb");
  fileSystem.setFaultyDelete(new File(cacheDir,"a.0"),true);
  executor.jobs.pop().run();
  assertValue("a","aa","aa");
  assertValue("b","bb","bbb");
  fileSystem.setFaultyDelete(new File(cacheDir,"a.0"),false);
}
