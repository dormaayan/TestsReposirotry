@Test public void tls_explicitCiphers() throws Exception {
  ConnectionSpec tlsSpec=new ConnectionSpec.Builder(true).cipherSuites(CipherSuite.TLS_RSA_WITH_RC4_128_MD5).tlsVersions(TlsVersion.TLS_1_2).supportsTlsExtensions(false).build();
  SSLSocket socket=(SSLSocket)SSLSocketFactory.getDefault().createSocket();
  socket.setEnabledCipherSuites(new String[]{CipherSuite.TLS_RSA_WITH_RC4_128_MD5.javaName,CipherSuite.TLS_RSA_WITH_RC4_128_SHA.javaName});
  socket.setEnabledProtocols(new String[]{TlsVersion.TLS_1_2.javaName,TlsVersion.TLS_1_1.javaName});
  assertTrue(tlsSpec.isCompatible(socket));
  tlsSpec.apply(socket,true);
  assertEquals(set(TlsVersion.TLS_1_2.javaName),set(socket.getEnabledProtocols()));
  Set<String> expectedCipherSet=set(CipherSuite.TLS_RSA_WITH_RC4_128_MD5.javaName);
  if (Arrays.asList(socket.getSupportedCipherSuites()).contains("TLS_FALLBACK_SCSV")) {
    expectedCipherSet.add("TLS_FALLBACK_SCSV");
  }
  assertEquals(expectedCipherSet,expectedCipherSet);
}
