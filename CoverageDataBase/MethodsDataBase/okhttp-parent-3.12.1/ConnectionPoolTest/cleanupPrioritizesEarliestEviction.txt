@Test public void cleanupPrioritizesEarliestEviction() throws Exception {
  ConnectionPool pool=new ConnectionPool(Integer.MAX_VALUE,100L,TimeUnit.NANOSECONDS);
  pool.cleanupRunning=true;
  RealConnection c1=newConnection(pool,routeA1,75L);
  RealConnection c2=newConnection(pool,routeB1,50L);
  assertEquals(75L,pool.cleanup(75L));
  assertEquals(2,pool.connectionCount());
  assertEquals(1L,pool.cleanup(149L));
  assertEquals(2,pool.connectionCount());
  assertEquals(0L,pool.cleanup(150L));
  assertEquals(1,pool.connectionCount());
  assertFalse(c1.socket().isClosed());
  assertTrue(c2.socket().isClosed());
  assertEquals(25L,pool.cleanup(150L));
  assertEquals(1,pool.connectionCount());
  assertEquals(0L,pool.cleanup(175L));
  assertEquals(0,pool.connectionCount());
  assertTrue(c1.socket().isClosed());
  assertTrue(c2.socket().isClosed());
}
