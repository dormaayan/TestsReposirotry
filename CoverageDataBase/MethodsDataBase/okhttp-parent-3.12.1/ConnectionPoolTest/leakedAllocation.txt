@Test public void leakedAllocation() throws Exception {
  ConnectionPool pool=new ConnectionPool(2,100L,TimeUnit.NANOSECONDS);
  pool.cleanupRunning=true;
  RealConnection c1=newConnection(pool,routeA1,0L);
  allocateAndLeakAllocation(pool,c1);
  awaitGarbageCollection();
  assertEquals(0L,pool.cleanup(100L));
  assertEquals(Collections.emptyList(),c1.allocations);
  assertTrue(c1.noNewStreams);
}
