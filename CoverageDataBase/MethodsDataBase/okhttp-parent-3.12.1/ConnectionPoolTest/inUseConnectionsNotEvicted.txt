@Test public void inUseConnectionsNotEvicted() throws Exception {
  ConnectionPool pool=new ConnectionPool(Integer.MAX_VALUE,100L,TimeUnit.NANOSECONDS);
  pool.cleanupRunning=true;
  RealConnection c1=newConnection(pool,routeA1,50L);
synchronized (pool) {
    StreamAllocation streamAllocation=new StreamAllocation(pool,addressA,null,EventListener.NONE,null);
    streamAllocation.acquire(c1,true);
  }
  assertEquals(100L,pool.cleanup(50L));
  assertEquals(1,pool.connectionCount());
  assertFalse(c1.socket().isClosed());
  assertEquals(100L,pool.cleanup(60L));
  assertEquals(1,pool.connectionCount());
  assertFalse(c1.socket().isClosed());
  assertEquals(100L,pool.cleanup(160L));
  assertEquals(1,pool.connectionCount());
  assertFalse(c1.socket().isClosed());
}
