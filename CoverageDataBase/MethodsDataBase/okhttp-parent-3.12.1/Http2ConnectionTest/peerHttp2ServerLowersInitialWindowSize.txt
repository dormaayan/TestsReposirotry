@Test public void peerHttp2ServerLowersInitialWindowSize() throws Exception {
  Settings initial=new Settings();
  initial.set(INITIAL_WINDOW_SIZE,1684);
  Settings shouldntImpactConnection=new Settings();
  shouldntImpactConnection.set(INITIAL_WINDOW_SIZE,3368);
  peer.sendFrame().settings(initial);
  peer.acceptFrame();
  peer.sendFrame().settings(shouldntImpactConnection);
  peer.acceptFrame();
  peer.acceptFrame();
  peer.play();
  Http2Connection connection=connect(peer);
  InFrame ackFrame=peer.takeFrame();
  assertEquals(Http2.TYPE_SETTINGS,ackFrame.type);
  assertEquals(0,ackFrame.streamId);
  assertTrue(ackFrame.ack);
  Http2Stream stream=connection.newStream(headerEntries("a","android"),false);
  assertEquals(3368,connection.peerSettings.getInitialWindowSize());
  assertEquals(3368,stream.bytesLeftInWriteWindow);
}
