@Test public void pushPromiseStreamsAutomaticallyCancel() throws Exception {
  peer.sendFrame().settings(new Settings());
  peer.acceptFrame();
  peer.sendFrame().pushPromise(3,2,Arrays.asList(new Header(Header.TARGET_METHOD,"GET"),new Header(Header.TARGET_SCHEME,"https"),new Header(Header.TARGET_AUTHORITY,"squareup.com"),new Header(Header.TARGET_PATH,"/cached")));
  peer.sendFrame().synReply(true,2,Arrays.asList(new Header(Header.RESPONSE_STATUS,"200")));
  peer.acceptFrame();
  peer.play();
  connect(peer,PushObserver.CANCEL,REFUSE_INCOMING_STREAMS);
  InFrame rstStream=peer.takeFrame();
  assertEquals(Http2.TYPE_RST_STREAM,rstStream.type);
  assertEquals(2,rstStream.streamId);
  assertEquals(ErrorCode.CANCEL,rstStream.errorCode);
}
