@Test public void redirect() throws Exception {
  server.enqueue(new MockResponse().setResponseCode(301).addHeader("Location: /b").addHeader("Test","Redirect from /a to /b").setBody("/a has moved!"));
  server.enqueue(new MockResponse().setResponseCode(302).addHeader("Location: /c").addHeader("Test","Redirect from /b to /c").setBody("/b has moved!"));
  server.enqueue(new MockResponse().setBody("C"));
  executeSynchronously("/a").assertCode(200).assertBody("C").priorResponse().assertCode(302).assertHeader("Test","Redirect from /b to /c").priorResponse().assertCode(301).assertHeader("Test","Redirect from /a to /b");
  assertEquals(0,server.takeRequest().getSequenceNumber());
  assertEquals(1,server.takeRequest().getSequenceNumber());
  assertEquals(2,server.takeRequest().getSequenceNumber());
}
