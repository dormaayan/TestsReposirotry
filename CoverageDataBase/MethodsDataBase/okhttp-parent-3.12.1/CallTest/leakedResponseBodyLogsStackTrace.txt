@Test public void leakedResponseBodyLogsStackTrace() throws Exception {
  server.enqueue(new MockResponse().setBody("This gets leaked."));
  client=defaultClient().newBuilder().connectionPool(new ConnectionPool(0,10,TimeUnit.MILLISECONDS)).build();
  Request request=new Request.Builder().url(server.url("/")).build();
  Level original=logger.getLevel();
  logger.setLevel(Level.FINE);
  logHandler.setFormatter(new SimpleFormatter());
  try {
    client.newCall(request).execute();
    awaitGarbageCollection();
    String message=logHandler.take();
    assertTrue(message.contains("A connection to " + server.url("/") + " was leaked."+ " Did you forget to close a response body?"));
    assertTrue(message.contains("okhttp3.RealCall.execute("));
    assertTrue(message.contains("okhttp3.CallTest.leakedResponseBodyLogsStackTrace("));
  }
  finally {
    logger.setLevel(original);
  }
}
