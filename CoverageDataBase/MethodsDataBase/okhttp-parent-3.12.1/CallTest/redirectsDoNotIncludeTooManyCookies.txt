@Test public void redirectsDoNotIncludeTooManyCookies() throws Exception {
  server2.enqueue(new MockResponse().setBody("Page 2"));
  server.enqueue(new MockResponse().setResponseCode(HttpURLConnection.HTTP_MOVED_TEMP).addHeader("Location: " + server2.url("/")));
  CookieManager cookieManager=new CookieManager(null,ACCEPT_ORIGINAL_SERVER);
  HttpCookie cookie=new HttpCookie("c","cookie");
  cookie.setDomain(server.getHostName());
  cookie.setPath("/");
  String portList=Integer.toString(server.getPort());
  cookie.setPortlist(portList);
  cookieManager.getCookieStore().add(server.url("/").uri(),cookie);
  client=client.newBuilder().cookieJar(new JavaNetCookieJar(cookieManager)).build();
  Response response=client.newCall(new Request.Builder().url(server.url("/page1")).build()).execute();
  assertEquals("Page 2",response.body().string());
  RecordedRequest request1=server.takeRequest();
  assertEquals("c=cookie",request1.getHeader("Cookie"));
  RecordedRequest request2=server2.takeRequest();
  assertNull(request2.getHeader("Cookie"));
}
