@Test public void testNoSslFallback() throws Exception {
  server.useHttps(handshakeCertificates.sslSocketFactory(),false);
  server.enqueue(new MockResponse().setSocketPolicy(FAIL_HANDSHAKE));
  server.enqueue(new MockResponse().setBody("Response that would have needed fallbacks"));
  HttpsURLConnection connection=(HttpsURLConnection)server.url("/").url().openConnection();
  connection.setSSLSocketFactory(handshakeCertificates.sslSocketFactory());
  try {
    connection.getInputStream();
    fail();
  }
 catch (  SSLProtocolException expected) {
  }
catch (  SSLHandshakeException expected) {
  }
catch (  SSLException expected) {
  }
catch (  SocketException expected) {
  }
}
