@Test public void disconnectedConnection() throws IOException {
  server.enqueue(new MockResponse().throttleBody(2,100,TimeUnit.MILLISECONDS).setBody("ABCD"));
  connection=urlFactory.open(server.url("/").url());
  InputStream in=connection.getInputStream();
  assertEquals('A',(char)in.read());
  connection.disconnect();
  try {
    in.read();
    in.read();
    fail("Expected a connection closed exception");
  }
 catch (  IOException expected) {
  }
  in.close();
}
