@Test public void authenticateNoConnection() throws Exception {
  server.enqueue(new MockResponse().addHeader("Connection: close").setResponseCode(401).setSocketPolicy(SocketPolicy.DISCONNECT_AT_END));
  Authenticator.setDefault(new RecordingAuthenticator(null));
  urlFactory.setClient(urlFactory.client().newBuilder().authenticator(new JavaNetAuthenticator()).build());
  connection=urlFactory.open(server.url("/").url());
  assertEquals(401,connection.getResponseCode());
}
