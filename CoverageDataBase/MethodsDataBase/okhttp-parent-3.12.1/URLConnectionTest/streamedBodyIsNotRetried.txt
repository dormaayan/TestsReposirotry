@Test public void streamedBodyIsNotRetried() throws Exception {
  server.enqueue(new MockResponse().setSocketPolicy(SocketPolicy.DISCONNECT_AFTER_REQUEST));
  urlFactory=new OkUrlFactory(defaultClient().newBuilder().dns(new DoubleInetAddressDns()).build());
  HttpURLConnection connection=urlFactory.open(server.url("/").url());
  connection.setDoOutput(true);
  connection.setChunkedStreamingMode(100);
  OutputStream os=connection.getOutputStream();
  os.write("OutputStream is no fun.".getBytes("UTF-8"));
  os.close();
  try {
    connection.getResponseCode();
    fail();
  }
 catch (  IOException expected) {
  }
  assertEquals(1,server.getRequestCount());
}
