/** 
 * This test checks whether connections are gzipped by default. This behavior in not required by the API, so a failure of this test does not imply a bug in the implementation.
 */
@Test public void gzipEncodingEnabledByDefault() throws Exception {
  server.enqueue(new MockResponse().setBody(gzip("ABCABCABC")).addHeader("Content-Encoding: gzip"));
  URLConnection connection=urlFactory.open(server.url("/").url());
  assertEquals("ABCABCABC",readAscii(connection.getInputStream(),Integer.MAX_VALUE));
  assertNull(connection.getContentEncoding());
  assertEquals(-1,connection.getContentLength());
  RecordedRequest request=server.takeRequest();
  assertEquals("gzip",request.getHeader("Accept-Encoding"));
}
