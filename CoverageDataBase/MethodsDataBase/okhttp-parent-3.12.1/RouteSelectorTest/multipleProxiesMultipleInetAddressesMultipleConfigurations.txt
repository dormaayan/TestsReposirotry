@Test public void multipleProxiesMultipleInetAddressesMultipleConfigurations() throws Exception {
  Address address=httpsAddress();
  proxySelector.proxies.add(proxyA);
  proxySelector.proxies.add(proxyB);
  RouteSelector routeSelector=new RouteSelector(address,routeDatabase,null,EventListener.NONE);
  dns.set(proxyAHost,dns.allocate(2));
  RouteSelector.Selection selection1=routeSelector.next();
  assertRoute(selection1.next(),address,proxyA,dns.lookup(proxyAHost,0),proxyAPort);
  dns.assertRequests(proxyAHost);
  assertRoute(selection1.next(),address,proxyA,dns.lookup(proxyAHost,1),proxyAPort);
  assertFalse(selection1.hasNext());
  dns.set(proxyBHost,dns.allocate(2));
  RouteSelector.Selection selection2=routeSelector.next();
  assertRoute(selection2.next(),address,proxyB,dns.lookup(proxyBHost,0),proxyBPort);
  dns.assertRequests(proxyBHost);
  assertRoute(selection2.next(),address,proxyB,dns.lookup(proxyBHost,1),proxyBPort);
  assertFalse(selection2.hasNext());
  assertFalse(routeSelector.hasNext());
}
