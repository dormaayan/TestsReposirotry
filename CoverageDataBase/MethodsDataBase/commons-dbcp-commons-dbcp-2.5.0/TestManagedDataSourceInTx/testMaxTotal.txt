@Override @Test public void testMaxTotal() throws Exception {
  final Transaction[] transactions=new Transaction[getMaxTotal()];
  final Connection[] c=new Connection[getMaxTotal()];
  for (int i=0; i < c.length; i++) {
    c[i]=newConnection();
    assertNotNull(c[i]);
    transactions[i]=transactionManager.suspend();
    assertNotNull(transactions[i]);
    transactionManager.begin();
  }
  try {
    newConnection();
    fail("Allowed to open more than DefaultMaxTotal connections.");
  }
 catch (  final java.sql.SQLException e) {
  }
 finally {
    transactionManager.commit();
    for (int i=0; i < c.length; i++) {
      transactionManager.resume(transactions[i]);
      c[i].close();
      transactionManager.commit();
    }
  }
}
