/** 
 * When an exception is thrown on the  {@link Connection#getAutoCommit()}, then the value is set to  {@code true} by default.
 * @throws XAException when there are errors with the transaction
 * @throws SQLException when there are errors with other SQL/DB parts
 */
@Test public void testStartExceptionOnGetAutoCommit() throws XAException, SQLException {
  final Xid xid=new TestXid();
  ((TestConnection)conn).throwWhenGetAutoCommit=true;
  conn.setAutoCommit(false);
  conn.setReadOnly(true);
  resource.start(xid,XAResource.TMNOFLAGS);
  resource.prepare(xid);
  ((TestConnection)conn).throwWhenGetAutoCommit=false;
  assertTrue(conn.getAutoCommit());
}
