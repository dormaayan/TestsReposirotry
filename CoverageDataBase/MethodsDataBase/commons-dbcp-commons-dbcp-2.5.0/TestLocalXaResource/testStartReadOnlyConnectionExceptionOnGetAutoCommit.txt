/** 
 * When an exception is thrown on the  {@link Connection#getAutoCommit()}, then the value is set to  {@code true} by default. However, if the connection is not read-only,then the value set by the user in the original connection will be kept.
 * @throws XAException when there are errors with the transaction
 * @throws SQLException when there are errors with other SQL/DB parts
 */
@Test public void testStartReadOnlyConnectionExceptionOnGetAutoCommit() throws XAException, SQLException {
  final Xid xid=new TestXid();
  ((TestConnection)conn).throwWhenGetAutoCommit=true;
  conn.setAutoCommit(false);
  conn.setReadOnly(false);
  resource.start(xid,XAResource.TMNOFLAGS);
  resource.prepare(xid);
  ((TestConnection)conn).throwWhenGetAutoCommit=false;
  assertFalse(conn.getAutoCommit());
}
