/** 
 * DBCP-412 Verify that omitting factory.setPool(pool) when setting up PDS does not result in NPE.
 */
@Test public void testFixFactoryConfig() throws Exception {
  final Properties props=new Properties();
  props.setProperty("user","userName");
  props.setProperty("password","password");
  final PoolableConnectionFactory f=new PoolableConnectionFactory(new DriverConnectionFactory(new TesterDriver(),"jdbc:apache:commons:testdriver",props),null);
  f.setValidationQuery("SELECT DUMMY FROM DUAL");
  f.setDefaultReadOnly(Boolean.TRUE);
  f.setDefaultAutoCommit(Boolean.TRUE);
  final GenericObjectPool<PoolableConnection> p=new GenericObjectPool<>(f);
  p.setMaxTotal(getMaxTotal());
  p.setMaxWaitMillis(getMaxWaitMillis());
  ds=new PoolingDataSource<>(p);
  assertTrue(f.getPool().equals(p));
  ds.getConnection();
}
