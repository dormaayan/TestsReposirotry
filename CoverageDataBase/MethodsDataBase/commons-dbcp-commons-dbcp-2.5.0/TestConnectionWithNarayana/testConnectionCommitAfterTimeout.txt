@Test public void testConnectionCommitAfterTimeout() throws Exception {
  mds.getTransactionManager().setTransactionTimeout(1);
  mds.getTransactionManager().begin();
  try (Connection conn=mds.getConnection()){
    do {
      Thread.sleep(1000);
    }
 while (mds.getTransactionManager().getTransaction().getStatus() != Status.STATUS_ROLLEDBACK);
    Thread.sleep(1000);
    try {
      conn.commit();
      fail("Should not work after timeout");
    }
 catch (    final SQLException e) {
      Assert.assertEquals("Commit can not be set while enrolled in a transaction",e.getMessage());
    }
    mds.getTransactionManager().rollback();
  }
   Assert.assertEquals(0,mds.getNumActive());
}
