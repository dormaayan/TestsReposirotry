/** 
 * Verify fix for DBCP-241
 */
@Test public void testCheckOpenNull() throws Exception {
  try {
    conn.close();
    conn.checkOpen();
    fail("Expecting SQLException");
  }
 catch (  final SQLException ex) {
    assertTrue(ex.getMessage().endsWith("is closed."));
  }
  try {
    conn=new DelegatingConnection<>(null);
    conn.setClosedInternal(true);
    conn.checkOpen();
    fail("Expecting SQLException");
  }
 catch (  final SQLException ex) {
    assertTrue(ex.getMessage().endsWith("is null."));
  }
  try {
    final PoolingConnection pc=new PoolingConnection(delegateConn2);
    pc.setStatementPool(new GenericKeyedObjectPool<>(pc));
    conn=new DelegatingConnection<>(pc);
    pc.close();
    conn.close();
    try (PreparedStatement ps=conn.prepareStatement("")){
    }
     fail("Expecting SQLException");
  }
 catch (  final SQLException ex) {
    assertTrue(ex.getMessage().endsWith("is closed."));
  }
  try {
    conn=new DelegatingConnection<>(new RTEGeneratingConnection());
    conn.close();
    conn.checkOpen();
    fail("Expecting SQLException");
  }
 catch (  final SQLException ex) {
    assertTrue(ex.getMessage().endsWith("is closed."));
  }
}
