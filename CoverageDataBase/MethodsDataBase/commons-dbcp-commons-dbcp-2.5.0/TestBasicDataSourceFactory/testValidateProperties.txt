@Test public void testValidateProperties() throws Exception {
  try {
    StackMessageLog.lock();
    StackMessageLog.clear();
    final Reference ref=new Reference("javax.sql.DataSource",BasicDataSourceFactory.class.getName(),null);
    ref.add(new StringRefAddr("foo","bar"));
    ref.add(new StringRefAddr("maxWait","100"));
    ref.add(new StringRefAddr("driverClassName","org.apache.commons.dbcp2.TesterDriver"));
    final BasicDataSourceFactory basicDataSourceFactory=new BasicDataSourceFactory();
    basicDataSourceFactory.getObjectInstance(ref,null,null,null);
    final List<String> messages=StackMessageLog.getAll();
    assertEquals(messages.toString(),2,messages.size());
    for (    final String message : messages) {
      if (message.contains("maxWait")) {
        assertTrue(message.contains("use maxWaitMillis"));
      }
 else {
        assertTrue(message.contains("foo"));
        assertTrue(message.contains("Ignoring unknown property"));
      }
    }
  }
  finally {
    StackMessageLog.clear();
    StackMessageLog.unLock();
  }
}
