@Test public void withWriteLockAndDelegate(){
  MultiReaderHashBag<Integer> bag=MultiReaderHashBag.newBagWith(2);
  AtomicReference<MutableBag<?>> delegateList=new AtomicReference<>();
  AtomicReference<Iterator<?>> iterator=new AtomicReference<>();
  bag.withWriteLockAndDelegate(delegate -> {
    delegate.add(1);
    delegate.add(2);
    delegate.add(3);
    delegate.add(4);
    delegateList.set(delegate);
    iterator.set(delegate.iterator());
  }
);
  Assert.assertEquals(HashBag.newBagWith(1,2,2,3,4),bag);
  Verify.assertThrows(NullPointerException.class,() -> iterator.get().hasNext());
  Verify.assertThrows(NullPointerException.class,() -> delegateList.get().iterator());
}
