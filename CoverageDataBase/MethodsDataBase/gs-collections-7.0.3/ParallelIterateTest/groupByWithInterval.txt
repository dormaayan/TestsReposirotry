@Test public void groupByWithInterval(){
  LazyIterable<Integer> iterable=Interval.oneTo(1000).concatenate(Interval.oneTo(1000)).concatenate(Interval.oneTo(1000));
  Multimap<String,Integer> expected=iterable.toBag().groupBy(String::valueOf);
  Multimap<String,Integer> expectedAsSet=iterable.toSet().groupBy(String::valueOf);
  Multimap<String,Integer> result1=ParallelIterate.groupBy(iterable.toList(),String::valueOf,100);
  Multimap<String,Integer> result2=ParallelIterate.groupBy(iterable.toList(),String::valueOf);
  Multimap<String,Integer> result3=ParallelIterate.groupBy(iterable.toSet(),String::valueOf,SynchronizedPutUnifiedSetMultimap.<String,Integer>newMultimap(),100);
  Multimap<String,Integer> result4=ParallelIterate.groupBy(iterable.toSet(),String::valueOf,SynchronizedPutUnifiedSetMultimap.<String,Integer>newMultimap());
  Multimap<String,Integer> result5=ParallelIterate.groupBy(iterable.toSortedSet(),String::valueOf,SynchronizedPutUnifiedSetMultimap.<String,Integer>newMultimap(),100);
  Multimap<String,Integer> result6=ParallelIterate.groupBy(iterable.toSortedSet(),String::valueOf,SynchronizedPutUnifiedSetMultimap.<String,Integer>newMultimap());
  Multimap<String,Integer> result7=ParallelIterate.groupBy(iterable.toBag(),String::valueOf,SynchronizedPutHashBagMultimap.<String,Integer>newMultimap(),100);
  Multimap<String,Integer> result8=ParallelIterate.groupBy(iterable.toBag(),String::valueOf,SynchronizedPutHashBagMultimap.<String,Integer>newMultimap());
  Multimap<String,Integer> result9=ParallelIterate.groupBy(iterable.toList().toImmutable(),String::valueOf);
  Assert.assertEquals(expected,HashBagMultimap.newMultimap(result1));
  Assert.assertEquals(expected,HashBagMultimap.newMultimap(result2));
  Assert.assertEquals(expected,HashBagMultimap.newMultimap(result9));
  Assert.assertEquals(expectedAsSet,result3);
  Assert.assertEquals(expectedAsSet,result4);
  Assert.assertEquals(expectedAsSet,result5);
  Assert.assertEquals(expectedAsSet,result6);
  Assert.assertEquals(expected,result7);
  Assert.assertEquals(expected,result8);
}
