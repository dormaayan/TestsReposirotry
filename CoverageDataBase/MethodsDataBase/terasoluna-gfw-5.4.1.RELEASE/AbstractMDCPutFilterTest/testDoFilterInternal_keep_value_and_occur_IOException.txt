/** 
 * [doFilterInternal] Case of keep value & occur io exception. <p> [Expected Result] <ol> <li>keep value in MDC.</li> <li>throws original io exception.</li> </ol> </p>
 * @throws ServletException
 * @throws IOException
 */
@Test public void testDoFilterInternal_keep_value_and_occur_IOException() throws ServletException, IOException {
  testTarget.setRemoveValue(false);
  MDC.put("dummyKey","dummyValue");
  IOException occurException=new IOException("test");
  doThrow(occurException).when(mockFilterChain).doFilter(mockRequest,mockResponse);
  try {
    testTarget.doFilterInternal(mockRequest,mockResponse,mockFilterChain);
    fail("don't occur IOException.");
  }
 catch (  IOException e) {
    assertThat(e,is(occurException));
  }
  assertEquals(2,MDC.getCopyOfContextMap().size());
  assertEquals("dummyValue",MDC.get("dummyKey"));
  assertEquals("value",MDC.get("key"));
}
