@Test public void testAfterCompletionWithException(){
  try {
    HttpSessionTransactionTokenStore tokenStore=new HttpSessionTransactionTokenStore();
    TransactionToken inputToken=new TransactionToken("testTokenAttr","111","222");
    tokenStore.store(inputToken);
    request.setParameter(TransactionTokenInterceptor.TOKEN_REQUEST_PARAMETER,"testTokenAttr~111~222");
    interceptor=new TransactionTokenInterceptor(new TokenStringGenerator(),new TransactionTokenInfoStore(),tokenStore);
    interceptor.preHandle(request,response,new HandlerMethod(new TransactionTokenSampleController(),TransactionTokenSampleController.class.getDeclaredMethod("third",SampleForm.class,Model.class)));
    assertNotNull(tokenStore.getSession().getAttribute(HttpSessionTransactionTokenStore.TOKEN_HOLDER_SESSION_ATTRIBUTE_PREFIX + inputToken.getTokenName() + "~"+ inputToken.getTokenKey()));
    Exception ex=new InvalidTransactionTokenException();
    interceptor.afterCompletion(request,response,null,ex);
    assertNull(tokenStore.getSession().getAttribute(HttpSessionTransactionTokenStore.TOKEN_HOLDER_SESSION_ATTRIBUTE_PREFIX + inputToken.getTokenName() + "~"+ inputToken.getTokenKey()));
  }
 catch (  Exception e) {
    fail();
  }
}
