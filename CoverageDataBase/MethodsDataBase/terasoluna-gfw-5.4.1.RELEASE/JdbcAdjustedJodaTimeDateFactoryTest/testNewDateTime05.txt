@Test public void testNewDateTime05() throws Exception {
  jdbcTemplate.update("INSERT INTO system_adjusted_date(diff) VALUES (:diff)",Collections.singletonMap("diff",30));
  JdbcAdjustedJodaTimeDateFactory dateFactory=new JdbcAdjustedJodaTimeDateFactory();
  dateFactory.setDataSource(dataSource);
  dateFactory.setUseCache(true);
  dateFactory.setAdjustedValueQuery("SELECT diff * 60 * 1000 FROM system_adjusted_date");
  dateFactory.afterPropertiesSet();
{
    DateTime now=new DateTime();
    DateTime result=dateFactory.newDateTime();
    assertThat((int)(Math.round(result.getMillis() - now.getMillis()) / 60.0 / 1000.0),is(30));
  }
{
    jdbcTemplate.update("UPDATE system_adjusted_date SET diff = :diff",Collections.singletonMap("diff",60));
    DateTime now=new DateTime();
    DateTime result=dateFactory.newDateTime();
    assertThat((int)(Math.round(result.getMillis() - now.getMillis()) / 60.0 / 1000.0),is(30));
  }
{
    dateFactory.reload();
    DateTime now=new DateTime();
    DateTime result=dateFactory.newDateTime();
    assertThat((int)(Math.round(result.getMillis() - now.getMillis()) / 60.0 / 1000.0),is(60));
  }
}
