/** 
 * See https://issues.apache.org/jira/browse/EMPIREDB-151
 */
@Test public void testSequence(){
  Connection conn=dbResource.getConnection();
  DBDatabaseDriver driver=dbResource.newDriver();
  SeqDB db=new SeqDB();
  db.open(driver,dbResource.getConnection());
  DBSQLScript script=new DBSQLScript();
  db.getCreateDDLScript(db.getDriver(),script);
  script.executeAll(db.getDriver(),dbResource.getConnection(),false);
  DBRecord data=new DBRecord();
  data.create(db.DATA);
  data.setValue(db.DATA.VALUE,"test");
  data.update(conn);
  final Object id=data.getLong(db.DATA.ID);
  DBRecord read=new DBRecord();
  read.read(db.DATA,id,conn);
  assertEquals("test",read.getString(db.DATA.VALUE));
  script=new DBSQLScript();
  db.getDriver().getDDLScript(DBCmdType.DROP,db.DATA,script);
  script.executeAll(db.getDriver(),conn,true);
}
