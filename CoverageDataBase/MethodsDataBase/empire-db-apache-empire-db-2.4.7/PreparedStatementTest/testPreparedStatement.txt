@Test public void testPreparedStatement(){
  Connection conn=dbResource.getConnection();
  DBDatabaseDriver driver=dbResource.newDriver();
  CompanyDB db=new CompanyDB();
  db.open(driver,conn);
  DBSQLScript script=new DBSQLScript();
  db.getCreateDDLScript(db.getDriver(),script);
  script.executeAll(db.getDriver(),conn,false);
  DBRecord department=new DBRecord();
  department.create(db.DEPARTMENT);
  department.setValue(db.DEPARTMENT.NAME,"junit");
  department.setValue(db.DEPARTMENT.BUSINESS_UNIT,"test");
  department.update(conn);
  int id=department.getInt(db.DEPARTMENT.ID);
  assertTrue("Department add failed",id > 0);
  CompanyDB.Departments DEP=db.DEPARTMENT;
  DBCommand cmd=db.createCommand();
  DBCmdParam empIdParam=cmd.addParam(null);
  cmd.select(DEP.getColumns());
  cmd.where(DEP.ID.is(empIdParam));
  empIdParam.setValue(id);
  assertNotNull(cmd.getParamValues());
  assertTrue(cmd.getSelect().indexOf('?') > 0);
  DBReader r=new DBReader();
  try {
    r.open(cmd,conn);
    assertEquals(true,r.moveNext());
    assertEquals(id,r.getInt(DEP.ID));
  }
  finally {
    r.close();
  }
}
