@Test public void testIncreasingTolerance() throws DimensionMismatchException, NumberIsTooSmallException, MaxCountExceededException, NoBracketingException {
  int previousCalls=Integer.MAX_VALUE;
  for (int i=-12; i < -4; ++i) {
    TestProblem1 pb=new TestProblem1();
    double minStep=0;
    double maxStep=pb.getFinalTime() - pb.getInitialTime();
    double absTolerance=FastMath.pow(10.0,i);
    double relTolerance=absTolerance;
    FirstOrderIntegrator integ=new GraggBulirschStoerIntegrator(minStep,maxStep,absTolerance,relTolerance);
    TestProblemHandler handler=new TestProblemHandler(pb,integ);
    integ.addStepHandler(handler);
    integ.integrate(pb,pb.getInitialTime(),pb.getInitialState(),pb.getFinalTime(),new double[pb.getDimension()]);
    double ratio=handler.getMaximalValueError() / absTolerance;
    Assert.assertTrue(ratio < 2.4);
    Assert.assertTrue(ratio > 0.02);
    Assert.assertEquals(0,handler.getMaximalTimeError(),1.0e-12);
    int calls=pb.getCalls();
    Assert.assertEquals(integ.getEvaluations(),calls);
    Assert.assertTrue(calls <= previousCalls);
    previousCalls=calls;
  }
}
