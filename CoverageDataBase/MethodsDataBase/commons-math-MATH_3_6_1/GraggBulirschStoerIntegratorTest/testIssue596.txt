@Test public void testIssue596() throws DimensionMismatchException, NumberIsTooSmallException, MaxCountExceededException, NoBracketingException {
  FirstOrderIntegrator integ=new GraggBulirschStoerIntegrator(1e-10,100.0,1e-7,1e-7);
  integ.addStepHandler(new StepHandler(){
    public void init(    double t0,    double[] y0,    double t){
    }
    public void handleStep(    StepInterpolator interpolator,    boolean isLast) throws MaxCountExceededException {
      double t=interpolator.getCurrentTime();
      interpolator.setInterpolatedTime(t);
      double[] y=interpolator.getInterpolatedState();
      double[] yDot=interpolator.getInterpolatedDerivatives();
      Assert.assertEquals(3.0 * t - 5.0,y[0],1.0e-14);
      Assert.assertEquals(3.0,yDot[0],1.0e-14);
    }
  }
);
  double[] y={4.0};
  double t0=3.0;
  double tend=10.0;
  integ.integrate(new FirstOrderDifferentialEquations(){
    public int getDimension(){
      return 1;
    }
    public void computeDerivatives(    double t,    double[] y,    double[] yDot){
      yDot[0]=3.0;
    }
  }
,t0,y,tend,y);
}
