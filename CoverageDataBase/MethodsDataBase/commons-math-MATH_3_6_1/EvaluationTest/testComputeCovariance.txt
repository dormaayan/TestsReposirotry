@Test public void testComputeCovariance() throws IOException {
  RealVector point=new ArrayRealVector(2);
  Evaluation evaluation=new LeastSquaresBuilder().model(new MultivariateJacobianFunction(){
    public Pair<RealVector,RealMatrix> value(    RealVector point){
      return new Pair<RealVector,RealMatrix>(new ArrayRealVector(2),MatrixUtils.createRealDiagonalMatrix(new double[]{1,1e-2}));
    }
  }
).weight(MatrixUtils.createRealDiagonalMatrix(new double[]{1,1})).target(new ArrayRealVector(2)).build().evaluate(point);
  TestUtils.assertEquals("covariance",evaluation.getCovariances(FastMath.nextAfter(1e-4,0.0)),MatrixUtils.createRealMatrix(new double[][]{{1,0},{0,1e4}}),Precision.EPSILON);
  try {
    evaluation.getCovariances(FastMath.nextAfter(1e-4,1.0));
    Assert.fail("Expected Exception");
  }
 catch (  SingularMatrixException e) {
  }
}
