@Test public void testPreconditionedSolution(){
  final int n=8;
  final int maxIterations=100;
  final RealLinearOperator a=new HilbertMatrix(n);
  final InverseHilbertMatrix ainv=new InverseHilbertMatrix(n);
  final RealLinearOperator m=JacobiPreconditioner.create(a);
  final PreconditionedIterativeLinearSolver solver;
  solver=new ConjugateGradient(maxIterations,1E-15,true);
  final RealVector b=new ArrayRealVector(n);
  for (int j=0; j < n; j++) {
    b.set(0.);
    b.setEntry(j,1.);
    final RealVector x=solver.solve(a,m,b);
    for (int i=0; i < n; i++) {
      final double actual=x.getEntry(i);
      final double expected=ainv.getEntry(i,j);
      final double delta=1E-6 * FastMath.abs(expected);
      final String msg=String.format("coefficient (%d, %d)",i,j);
      Assert.assertEquals(msg,expected,actual,delta);
    }
  }
}
