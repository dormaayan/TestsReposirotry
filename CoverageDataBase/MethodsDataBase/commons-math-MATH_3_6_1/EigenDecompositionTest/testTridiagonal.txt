/** 
 * test a matrix already in tridiagonal form. 
 */
@Test public void testTridiagonal(){
  Random r=new Random(4366663527842l);
  double[] ref=new double[30];
  for (int i=0; i < ref.length; ++i) {
    if (i < 5) {
      ref[i]=2 * r.nextDouble() - 1;
    }
 else {
      ref[i]=0.0001 * r.nextDouble() + 6;
    }
  }
  Arrays.sort(ref);
  TriDiagonalTransformer t=new TriDiagonalTransformer(createTestMatrix(r,ref));
  EigenDecomposition ed;
  ed=new EigenDecomposition(t.getMainDiagonalRef(),t.getSecondaryDiagonalRef());
  double[] eigenValues=ed.getRealEigenvalues();
  Assert.assertEquals(ref.length,eigenValues.length);
  for (int i=0; i < ref.length; ++i) {
    Assert.assertEquals(ref[ref.length - i - 1],eigenValues[i],2.0e-14);
  }
}
