@Test public void testBeforeEnd() throws DimensionMismatchException, NumberIsTooSmallException, MaxCountExceededException, NoBracketingException {
  final double range=pb.getFinalTime() - pb.getInitialTime();
  setLastSeen(false);
  integ.addStepHandler(new StepNormalizer(range / 10.5,new FixedStepHandler(){
    public void init(    double t0,    double[] y0,    double t){
    }
    public void handleStep(    double t,    double[] y,    double[] yDot,    boolean isLast){
      if (isLast) {
        setLastSeen(true);
        checkValue(t,pb.getFinalTime() - range / 21.0);
      }
    }
  }
));
  integ.integrate(pb,pb.getInitialTime(),pb.getInitialState(),pb.getFinalTime(),new double[pb.getDimension()]);
  Assert.assertTrue(lastSeen);
}
