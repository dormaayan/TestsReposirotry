@Test public void testBoundaries() throws DimensionMismatchException, NumberIsTooSmallException, MaxCountExceededException, NoBracketingException {
  double range=pb.getFinalTime() - pb.getInitialTime();
  setLastSeen(false);
  integ.addStepHandler(new StepNormalizer(range / 10.0,new FixedStepHandler(){
    private boolean firstCall=true;
    public void init(    double t0,    double[] y0,    double t){
    }
    public void handleStep(    double t,    double[] y,    double[] yDot,    boolean isLast){
      if (firstCall) {
        checkValue(t,pb.getInitialTime());
        firstCall=false;
      }
      if (isLast) {
        setLastSeen(true);
        checkValue(t,pb.getFinalTime());
      }
    }
  }
));
  integ.integrate(pb,pb.getInitialTime(),pb.getInitialState(),pb.getFinalTime(),new double[pb.getDimension()]);
  Assert.assertTrue(lastSeen);
}
