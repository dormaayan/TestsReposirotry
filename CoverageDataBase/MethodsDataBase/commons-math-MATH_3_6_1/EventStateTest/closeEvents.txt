@Test public void closeEvents() throws MaxCountExceededException, NoBracketingException {
  final double r1=90.0;
  final double r2=135.0;
  final double gap=r2 - r1;
  final double tolerance=0.1;
  EventState es=new EventState(new CloseEventsGenerator(r1,r2),1.5 * gap,tolerance,100,new BrentSolver(tolerance));
  es.setExpandable(new ExpandableStatefulODE(new FirstOrderDifferentialEquations(){
    public int getDimension(){
      return 0;
    }
    public void computeDerivatives(    double t,    double[] y,    double[] yDot){
    }
  }
));
  AbstractStepInterpolator interpolator=new DummyStepInterpolator(new double[0],new double[0],true);
  interpolator.storeTime(r1 - 2.5 * gap);
  interpolator.shift();
  interpolator.storeTime(r1 - 1.5 * gap);
  es.reinitializeBegin(interpolator);
  interpolator.shift();
  interpolator.storeTime(r1 - 0.5 * gap);
  Assert.assertFalse(es.evaluateStep(interpolator));
  interpolator.shift();
  interpolator.storeTime(0.5 * (r1 + r2));
  Assert.assertTrue(es.evaluateStep(interpolator));
  Assert.assertEquals(r1,es.getEventTime(),tolerance);
  es.stepAccepted(es.getEventTime(),new double[0]);
  interpolator.shift();
  interpolator.storeTime(r2 + 0.4 * gap);
  Assert.assertTrue(es.evaluateStep(interpolator));
  Assert.assertEquals(r2,es.getEventTime(),tolerance);
}
