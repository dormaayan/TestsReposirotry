@Test public void testGaussian(){
  FiniteDifferencesDifferentiator differentiator=new FiniteDifferencesDifferentiator(9,0.02);
  UnivariateDifferentiableFunction gaussian=new Gaussian(1.0,2.0);
  UnivariateDifferentiableFunction f=differentiator.differentiate(gaussian);
  double[] expectedError=new double[]{6.939e-18,1.284e-15,2.477e-13,1.168e-11,2.840e-9,7.971e-8};
  double[] maxError=new double[expectedError.length];
  for (double x=-10; x < 10; x+=0.1) {
    DerivativeStructure dsX=new DerivativeStructure(1,maxError.length - 1,0,x);
    DerivativeStructure yRef=gaussian.value(dsX);
    DerivativeStructure y=f.value(dsX);
    Assert.assertEquals(f.value(dsX.getValue()),f.value(dsX).getValue(),1.0e-15);
    for (int order=0; order <= yRef.getOrder(); ++order) {
      maxError[order]=FastMath.max(maxError[order],FastMath.abs(yRef.getPartialDerivative(order) - y.getPartialDerivative(order)));
    }
  }
  for (int i=0; i < maxError.length; ++i) {
    Assert.assertEquals(expectedError[i],maxError[i],0.01 * expectedError[i]);
  }
}
