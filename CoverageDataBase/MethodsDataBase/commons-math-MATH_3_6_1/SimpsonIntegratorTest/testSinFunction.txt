/** 
 * Test of integrator for the sine function.
 */
@Test public void testSinFunction(){
  UnivariateFunction f=new Sin();
  UnivariateIntegrator integrator=new SimpsonIntegrator();
  double min, max, expected, result, tolerance;
  min=0;
  max=FastMath.PI;
  expected=2;
  tolerance=FastMath.abs(expected * integrator.getRelativeAccuracy());
  result=integrator.integrate(1000,f,min,max);
  Assert.assertTrue(integrator.getEvaluations() < 100);
  Assert.assertTrue(integrator.getIterations() < 10);
  Assert.assertEquals(expected,result,tolerance);
  min=-FastMath.PI / 3;
  max=0;
  expected=-0.5;
  tolerance=FastMath.abs(expected * integrator.getRelativeAccuracy());
  result=integrator.integrate(1000,f,min,max);
  Assert.assertTrue(integrator.getEvaluations() < 50);
  Assert.assertTrue(integrator.getIterations() < 10);
  Assert.assertEquals(expected,result,tolerance);
}
