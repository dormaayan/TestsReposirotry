/** 
 * Verifies that probability computations are consistent
 */
@SuppressWarnings("deprecation") @Test public void testConsistency(){
  for (int i=1; i < cumulativeTestPoints.length; i++) {
    TestUtils.assertEquals(0d,distribution.cumulativeProbability(cumulativeTestPoints[i],cumulativeTestPoints[i]),tolerance);
    double upper=FastMath.max(cumulativeTestPoints[i],cumulativeTestPoints[i - 1]);
    double lower=FastMath.min(cumulativeTestPoints[i],cumulativeTestPoints[i - 1]);
    double diff=distribution.cumulativeProbability(upper) - distribution.cumulativeProbability(lower);
    double direct=distribution.cumulativeProbability(lower,upper);
    TestUtils.assertEquals("Inconsistent cumulative probabilities for (" + lower + ","+ upper+ ")",diff,direct,tolerance);
  }
}
