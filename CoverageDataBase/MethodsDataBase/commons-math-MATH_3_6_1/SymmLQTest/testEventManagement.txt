@Test public void testEventManagement(){
  final int n=5;
  final int maxIterations=100;
  final RealLinearOperator a=new HilbertMatrix(n);
  final IterativeLinearSolver solver;
  final int[] count=new int[]{0,0,0,0};
  final RealVector xFromListener=new ArrayRealVector(n);
  final IterationListener listener=new IterationListener(){
    public void initializationPerformed(    final IterationEvent e){
      ++count[0];
    }
    public void iterationPerformed(    final IterationEvent e){
      ++count[2];
      Assert.assertEquals("iteration performed",count[2],e.getIterations() - 1);
    }
    public void iterationStarted(    final IterationEvent e){
      ++count[1];
      Assert.assertEquals("iteration started",count[1],e.getIterations() - 1);
    }
    public void terminationPerformed(    final IterationEvent e){
      ++count[3];
      final IterativeLinearSolverEvent ilse;
      ilse=(IterativeLinearSolverEvent)e;
      xFromListener.setSubVector(0,ilse.getSolution());
    }
  }
;
  solver=new SymmLQ(maxIterations,1E-10,true);
  solver.getIterationManager().addIterationListener(listener);
  final RealVector b=new ArrayRealVector(n);
  for (int j=0; j < n; j++) {
    Arrays.fill(count,0);
    b.set(0.);
    b.setEntry(j,1.);
    final RealVector xFromSolver=solver.solve(a,b);
    String msg=String.format("column %d (initialization)",j);
    Assert.assertEquals(msg,1,count[0]);
    msg=String.format("column %d (finalization)",j);
    Assert.assertEquals(msg,1,count[3]);
    for (int i=0; i < n; i++) {
      msg=String.format("row %d, column %d",i,j);
      final double expected=xFromSolver.getEntry(i);
      final double actual=xFromListener.getEntry(i);
      Assert.assertEquals(msg,expected,actual,0.0);
    }
  }
}
