@Test public void testUnpreconditionedNormOfResidual(){
  final int n=5;
  final int maxIterations=100;
  final RealLinearOperator a=new HilbertMatrix(n);
  final IterativeLinearSolver solver;
  final IterationListener listener=new IterationListener(){
    private void doTestNormOfResidual(    final IterationEvent e){
      final IterativeLinearSolverEvent evt;
      evt=(IterativeLinearSolverEvent)e;
      final RealVector x=evt.getSolution();
      final RealVector b=evt.getRightHandSideVector();
      final RealVector r=b.subtract(a.operate(x));
      final double rnorm=r.getNorm();
      Assert.assertEquals("iteration performed (residual)",rnorm,evt.getNormOfResidual(),FastMath.max(1E-5 * rnorm,1E-10));
    }
    public void initializationPerformed(    final IterationEvent e){
      doTestNormOfResidual(e);
    }
    public void iterationPerformed(    final IterationEvent e){
      doTestNormOfResidual(e);
    }
    public void iterationStarted(    final IterationEvent e){
      doTestNormOfResidual(e);
    }
    public void terminationPerformed(    final IterationEvent e){
      doTestNormOfResidual(e);
    }
  }
;
  solver=new SymmLQ(maxIterations,1E-10,true);
  solver.getIterationManager().addIterationListener(listener);
  final RealVector b=new ArrayRealVector(n);
  for (int j=0; j < n; j++) {
    b.set(0.);
    b.setEntry(j,1.);
    solver.solve(a,b);
  }
}
