@Test public void testDoubleRotations() throws MathIllegalArgumentException {
  DfpField field=new DfpField(20);
  Well1024a random=new Well1024a(0x180b41cfeeffaf67l);
  UnitSphereRandomVectorGenerator g=new UnitSphereRandomVectorGenerator(3,random);
  for (int i=0; i < 10; ++i) {
    double[] unit1=g.nextVector();
    Rotation r1=new Rotation(new Vector3D(unit1[0],unit1[1],unit1[2]),random.nextDouble(),RotationConvention.VECTOR_OPERATOR);
    FieldRotation<Dfp> r1Prime=new FieldRotation<Dfp>(field.newDfp(r1.getQ0()),field.newDfp(r1.getQ1()),field.newDfp(r1.getQ2()),field.newDfp(r1.getQ3()),false);
    double[] unit2=g.nextVector();
    FieldRotation<Dfp> r2=new FieldRotation<Dfp>(createVector(unit2[0],unit2[1],unit2[2]),createAngle(random.nextDouble()),RotationConvention.VECTOR_OPERATOR);
    FieldRotation<Dfp> rA=FieldRotation.applyTo(r1,r2);
    FieldRotation<Dfp> rB=r1Prime.compose(r2,RotationConvention.VECTOR_OPERATOR);
    FieldRotation<Dfp> rC=FieldRotation.applyInverseTo(r1,r2);
    FieldRotation<Dfp> rD=r1Prime.composeInverse(r2,RotationConvention.VECTOR_OPERATOR);
    for (double x=-0.9; x < 0.9; x+=0.4) {
      for (double y=-0.9; y < 0.9; y+=0.4) {
        for (double z=-0.9; z < 0.9; z+=0.4) {
          FieldVector3D<Dfp> uds=createVector(x,y,z);
          checkVector(r1Prime.applyTo(uds),FieldRotation.applyTo(r1,uds));
          checkVector(r1Prime.applyInverseTo(uds),FieldRotation.applyInverseTo(r1,uds));
          checkVector(rA.applyTo(uds),rB.applyTo(uds));
          checkVector(rA.applyInverseTo(uds),rB.applyInverseTo(uds));
          checkVector(rC.applyTo(uds),rD.applyTo(uds));
          checkVector(rC.applyInverseTo(uds),rD.applyInverseTo(uds));
        }
      }
    }
  }
}
