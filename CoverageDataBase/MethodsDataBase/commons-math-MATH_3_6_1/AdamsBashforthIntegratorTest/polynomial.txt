@Test public void polynomial() throws DimensionMismatchException, NumberIsTooSmallException, MaxCountExceededException, NoBracketingException {
  TestProblem6 pb=new TestProblem6();
  double range=FastMath.abs(pb.getFinalTime() - pb.getInitialTime());
  for (int nSteps=2; nSteps < 8; ++nSteps) {
    AdamsBashforthIntegrator integ=new AdamsBashforthIntegrator(nSteps,1.0e-6 * range,0.1 * range,1.0e-4,1.0e-4);
    integ.setStarterIntegrator(new PerfectStarter(pb,nSteps));
    TestProblemHandler handler=new TestProblemHandler(pb,integ);
    integ.addStepHandler(handler);
    integ.integrate(pb,pb.getInitialTime(),pb.getInitialState(),pb.getFinalTime(),new double[pb.getDimension()]);
    if (nSteps < 5) {
      Assert.assertTrue(handler.getMaximalValueError() > 0.005);
    }
 else {
      Assert.assertTrue(handler.getMaximalValueError() < 5.0e-10);
    }
  }
}
