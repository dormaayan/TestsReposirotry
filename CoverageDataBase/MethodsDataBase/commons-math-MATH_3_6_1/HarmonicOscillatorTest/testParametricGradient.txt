@Test public void testParametricGradient(){
  final double amplitude=2;
  final double omega=3;
  final double phase=4;
  final HarmonicOscillator.Parametric f=new HarmonicOscillator.Parametric();
  final double x=1;
  final double[] grad=f.gradient(1,new double[]{amplitude,omega,phase});
  final double xTimesOmegaPlusPhase=omega * x + phase;
  final double a=FastMath.cos(xTimesOmegaPlusPhase);
  Assert.assertEquals(a,grad[0],EPS);
  final double w=-amplitude * x * FastMath.sin(xTimesOmegaPlusPhase);
  Assert.assertEquals(w,grad[1],EPS);
  final double p=-amplitude * FastMath.sin(xTimesOmegaPlusPhase);
  Assert.assertEquals(p,grad[2],EPS);
}
