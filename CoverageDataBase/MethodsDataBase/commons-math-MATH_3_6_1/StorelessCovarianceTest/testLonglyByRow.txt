/** 
 * Test Longley dataset against R. Data Source: J. Longley (1967) "An Appraisal of Least Squares Programs for the Electronic Computer from the Point of View of the User" Journal of the American Statistical Association, vol. 62. September, pp. 819-841. Data are from NIST: http://www.itl.nist.gov/div898/strd/lls/data/LINKS/DATA/Longley.dat
 */
@Test public void testLonglyByRow(){
  RealMatrix matrix=createRealMatrix(longleyData,16,7);
  double[] rData=new double[]{12333921.73333333246,3.679666000000000e+04,343330206.333333313,1649102.666666666744,1117681.066666666651,23461965.733333334,16240.93333333333248,36796.66000000000,1.164576250000000e+02,1063604.115416667,6258.666250000000,3490.253750000000,73503.000000000,50.92333333333334,343330206.33333331347,1.063604115416667e+06,9879353659.329166412,56124369.854166664183,30880428.345833335072,685240944.600000024,470977.90000000002328,1649102.66666666674,6.258666250000000e+03,56124369.854166664,873223.429166666698,-115378.762499999997,4462741.533333333,2973.03333333333330,1117681.06666666665,3.490253750000000e+03,30880428.345833335,-115378.762499999997,484304.095833333326,1764098.133333333,1382.43333333333339,23461965.73333333433,7.350300000000000e+04,685240944.600000024,4462741.533333333209,1764098.133333333302,48387348.933333330,32917.40000000000146,16240.93333333333,5.092333333333334e+01,470977.900000000,2973.033333333333,1382.433333333333,32917.40000000,22.66666666666667};
  StorelessCovariance covMatrix=new StorelessCovariance(7);
  for (int i=0; i < matrix.getRowDimension(); i++) {
    covMatrix.increment(matrix.getRow(i));
  }
  RealMatrix covarianceMatrix=covMatrix.getCovarianceMatrix();
  TestUtils.assertEquals("covariance matrix",createRealMatrix(rData,7,7),covarianceMatrix,10E-7);
}
