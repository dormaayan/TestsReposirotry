@Test public void testVariableSteps() throws DimensionMismatchException, NumberIsTooSmallException, MaxCountExceededException, NoBracketingException {
  final TestProblem3 pb=new TestProblem3(0.9);
  double minStep=0;
  double maxStep=pb.getFinalTime() - pb.getInitialTime();
  double scalAbsoluteTolerance=1.0e-8;
  double scalRelativeTolerance=scalAbsoluteTolerance;
  FirstOrderIntegrator integ=new DormandPrince853Integrator(minStep,maxStep,scalAbsoluteTolerance,scalRelativeTolerance);
  integ.addStepHandler(new VariableHandler());
  double stopTime=integ.integrate(pb,pb.getInitialTime(),pb.getInitialState(),pb.getFinalTime(),new double[pb.getDimension()]);
  Assert.assertEquals(pb.getFinalTime(),stopTime,1.0e-10);
  Assert.assertEquals("Dormand-Prince 8 (5, 3)",integ.getName());
}
