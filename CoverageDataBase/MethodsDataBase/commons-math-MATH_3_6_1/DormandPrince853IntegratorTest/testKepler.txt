@Test public void testKepler() throws DimensionMismatchException, NumberIsTooSmallException, MaxCountExceededException, NoBracketingException {
  final TestProblem3 pb=new TestProblem3(0.9);
  double minStep=0;
  double maxStep=pb.getFinalTime() - pb.getInitialTime();
  double scalAbsoluteTolerance=1.0e-8;
  double scalRelativeTolerance=scalAbsoluteTolerance;
  FirstOrderIntegrator integ=new DormandPrince853Integrator(minStep,maxStep,scalAbsoluteTolerance,scalRelativeTolerance);
  integ.addStepHandler(new KeplerHandler(pb));
  integ.integrate(pb,pb.getInitialTime(),pb.getInitialState(),pb.getFinalTime(),new double[pb.getDimension()]);
  Assert.assertEquals(integ.getEvaluations(),pb.getCalls());
  Assert.assertTrue(pb.getCalls() < 3300);
}
