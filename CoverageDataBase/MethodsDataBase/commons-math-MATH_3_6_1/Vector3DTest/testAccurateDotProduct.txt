@Test public void testAccurateDotProduct(){
  Vector3D u1=new Vector3D(-1321008684645961.0 / 268435456.0,-5774608829631843.0 / 268435456.0,-7645843051051357.0 / 8589934592.0);
  Vector3D u2=new Vector3D(-5712344449280879.0 / 2097152.0,-4550117129121957.0 / 2097152.0,8846951984510141.0 / 131072.0);
  double sNaive=u1.getX() * u2.getX() + u1.getY() * u2.getY() + u1.getZ() * u2.getZ();
  double sAccurate=u1.dotProduct(u2);
  Assert.assertEquals(0.0,sNaive,1.0e-30);
  Assert.assertEquals(-2088690039198397.0 / 1125899906842624.0,sAccurate,1.0e-15);
}
