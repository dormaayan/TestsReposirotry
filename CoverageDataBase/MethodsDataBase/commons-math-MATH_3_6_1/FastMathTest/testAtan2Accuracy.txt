@Test public void testAtan2Accuracy(){
  double maxerrulp=0.0;
  for (int i=0; i < NUMBER_OF_TRIALS; i++) {
    double x=generator.nextDouble() - 0.5;
    double y=generator.nextDouble() - 0.5;
    double tst=FastMath.atan2(y,x);
    Dfp refdfp=DfpMath.atan(field.newDfp(y).divide(field.newDfp(x)));
    if (x < 0.0) {
      if (y > 0.0)       refdfp=field.getPi().add(refdfp);
 else       refdfp=refdfp.subtract(field.getPi());
    }
    double ref=refdfp.toDouble();
    double err=(tst - ref) / ref;
    if (err != 0) {
      double ulp=Math.abs(ref - Double.longBitsToDouble((Double.doubleToLongBits(ref) ^ 1)));
      double errulp=field.newDfp(tst).subtract(refdfp).divide(field.newDfp(ulp)).toDouble();
      maxerrulp=Math.max(maxerrulp,Math.abs(errulp));
    }
  }
  Assert.assertTrue("atan2() had errors in excess of " + MAX_ERROR_ULP + " ULP",maxerrulp < MAX_ERROR_ULP);
}
