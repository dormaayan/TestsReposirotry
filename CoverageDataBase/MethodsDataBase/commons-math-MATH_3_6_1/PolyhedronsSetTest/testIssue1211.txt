@Test public void testIssue1211() throws IOException, ParseException {
  PolyhedronsSet polyset=RegionParser.parsePolyhedronsSet(loadTestData("issue-1211.bsp"));
  RandomGenerator random=new Well1024a(0xb97c9d1ade21e40al);
  int nrays=1000;
  for (int i=0; i < nrays; i++) {
    Vector3D origin=Vector3D.ZERO;
    Vector3D direction=new Vector3D(2 * random.nextDouble() - 1,2 * random.nextDouble() - 1,2 * random.nextDouble() - 1).normalize();
    Line line=new Line(origin,origin.add(direction),polyset.getTolerance());
    SubHyperplane<Euclidean3D> plane=polyset.firstIntersection(origin,line);
    if (plane != null) {
      Vector3D intersectionPoint=((Plane)plane.getHyperplane()).intersection(line);
      double dotProduct=direction.dotProduct(intersectionPoint.subtract(origin));
      Assert.assertTrue(dotProduct > 0);
    }
  }
}
