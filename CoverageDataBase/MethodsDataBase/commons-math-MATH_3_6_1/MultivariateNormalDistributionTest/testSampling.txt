/** 
 * Test the accuracy of sampling from the distribution.
 */
@Test public void testSampling(){
  final double[] mu={-1.5,2};
  final double[][] sigma={{2,-1.1},{-1.1,2}};
  final MultivariateNormalDistribution d=new MultivariateNormalDistribution(mu,sigma);
  d.reseedRandomGenerator(50);
  final int n=500000;
  final double[][] samples=d.sample(n);
  final int dim=d.getDimension();
  final double[] sampleMeans=new double[dim];
  for (int i=0; i < samples.length; i++) {
    for (int j=0; j < dim; j++) {
      sampleMeans[j]+=samples[i][j];
    }
  }
  final double sampledValueTolerance=1e-2;
  for (int j=0; j < dim; j++) {
    sampleMeans[j]/=samples.length;
    Assert.assertEquals(mu[j],sampleMeans[j],sampledValueTolerance);
  }
  final double[][] sampleSigma=new Covariance(samples).getCovarianceMatrix().getData();
  for (int i=0; i < dim; i++) {
    for (int j=0; j < dim; j++) {
      Assert.assertEquals(sigma[i][j],sampleSigma[i][j],sampledValueTolerance);
    }
  }
}
