@Test public void testExactIntegration(){
  Random random=new Random(86343623467878363l);
  for (int n=2; n < 6; ++n) {
    LegendreGaussIntegrator integrator=new LegendreGaussIntegrator(n,BaseAbstractUnivariateIntegrator.DEFAULT_RELATIVE_ACCURACY,BaseAbstractUnivariateIntegrator.DEFAULT_ABSOLUTE_ACCURACY,BaseAbstractUnivariateIntegrator.DEFAULT_MIN_ITERATIONS_COUNT,64);
    for (int degree=0; degree <= 2 * n - 1; ++degree) {
      for (int i=0; i < 10; ++i) {
        double[] coeff=new double[degree + 1];
        for (int k=0; k < coeff.length; ++k) {
          coeff[k]=2 * random.nextDouble() - 1;
        }
        PolynomialFunction p=new PolynomialFunction(coeff);
        double result=integrator.integrate(10000,p,-5.0,15.0);
        double reference=exactIntegration(p,-5.0,15.0);
        Assert.assertEquals(n + " " + degree+ " "+ i,reference,result,1.0e-12 * (1.0 + FastMath.abs(reference)));
      }
    }
  }
}
