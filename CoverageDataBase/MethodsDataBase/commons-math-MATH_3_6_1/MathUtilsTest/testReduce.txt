@Test public void testReduce(){
  final double period=-12.222;
  final double offset=13;
  final double delta=1.5;
  double orig=offset + 122456789 * period + delta;
  double expected=delta;
  Assert.assertEquals(expected,MathUtils.reduce(orig,period,offset),1e-7);
  Assert.assertEquals(expected,MathUtils.reduce(orig,-period,offset),1e-7);
  orig=offset - 123356789 * period - delta;
  expected=FastMath.abs(period) - delta;
  Assert.assertEquals(expected,MathUtils.reduce(orig,period,offset),1e-6);
  Assert.assertEquals(expected,MathUtils.reduce(orig,-period,offset),1e-6);
  orig=offset - 123446789 * period + delta;
  expected=delta;
  Assert.assertEquals(expected,MathUtils.reduce(orig,period,offset),1e-6);
  Assert.assertEquals(expected,MathUtils.reduce(orig,-period,offset),1e-6);
  Assert.assertTrue(Double.isNaN(MathUtils.reduce(orig,Double.NaN,offset)));
  Assert.assertTrue(Double.isNaN(MathUtils.reduce(Double.NaN,period,offset)));
  Assert.assertTrue(Double.isNaN(MathUtils.reduce(orig,period,Double.NaN)));
  Assert.assertTrue(Double.isNaN(MathUtils.reduce(orig,period,Double.POSITIVE_INFINITY)));
  Assert.assertTrue(Double.isNaN(MathUtils.reduce(Double.POSITIVE_INFINITY,period,offset)));
  Assert.assertTrue(Double.isNaN(MathUtils.reduce(orig,Double.POSITIVE_INFINITY,offset)));
  Assert.assertTrue(Double.isNaN(MathUtils.reduce(orig,Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY)));
  Assert.assertTrue(Double.isNaN(MathUtils.reduce(Double.POSITIVE_INFINITY,period,Double.POSITIVE_INFINITY)));
  Assert.assertTrue(Double.isNaN(MathUtils.reduce(Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY,offset)));
  Assert.assertTrue(Double.isNaN(MathUtils.reduce(Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY)));
}
