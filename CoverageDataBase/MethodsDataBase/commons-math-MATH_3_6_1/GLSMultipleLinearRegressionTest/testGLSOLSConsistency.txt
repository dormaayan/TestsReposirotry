/** 
 * Verifies that GLS with identity covariance matrix gives the same results as OLS.
 */
@Test public void testGLSOLSConsistency(){
  RealMatrix identityCov=MatrixUtils.createRealIdentityMatrix(16);
  GLSMultipleLinearRegression glsModel=new GLSMultipleLinearRegression();
  OLSMultipleLinearRegression olsModel=new OLSMultipleLinearRegression();
  glsModel.newSampleData(longley,16,6);
  olsModel.newSampleData(longley,16,6);
  glsModel.newCovarianceData(identityCov.getData());
  double[] olsBeta=olsModel.calculateBeta().toArray();
  double[] glsBeta=glsModel.calculateBeta().toArray();
  for (int i=0; i < olsBeta.length; i++) {
    TestUtils.assertRelativelyEquals(olsBeta[i],glsBeta[i],10E-7);
  }
}
