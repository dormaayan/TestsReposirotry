@Test public void testAxisAngleFrameTransform() throws MathIllegalArgumentException {
  FieldRotation<DerivativeStructure> r=new FieldRotation<DerivativeStructure>(createAxis(10,10,10),createAngle(2 * FastMath.PI / 3),RotationConvention.FRAME_TRANSFORM);
  checkVector(r.applyTo(createVector(1,0,0)),createVector(0,0,1));
  checkVector(r.applyTo(createVector(0,1,0)),createVector(1,0,0));
  checkVector(r.applyTo(createVector(0,0,1)),createVector(0,1,0));
  double s=1 / FastMath.sqrt(3);
  checkVector(r.getAxis(RotationConvention.FRAME_TRANSFORM),createVector(s,s,s));
  checkVector(r.getAxis(RotationConvention.VECTOR_OPERATOR),createVector(-s,-s,-s));
  checkAngle(r.getAngle(),2 * FastMath.PI / 3);
  try {
    new FieldRotation<DerivativeStructure>(createAxis(0,0,0),createAngle(2 * FastMath.PI / 3),RotationConvention.FRAME_TRANSFORM);
    Assert.fail("an exception should have been thrown");
  }
 catch (  MathIllegalArgumentException e) {
  }
  r=new FieldRotation<DerivativeStructure>(createAxis(0,0,1),createAngle(1.5 * FastMath.PI),RotationConvention.FRAME_TRANSFORM);
  checkVector(r.getAxis(RotationConvention.FRAME_TRANSFORM),createVector(0,0,-1));
  checkVector(r.getAxis(RotationConvention.VECTOR_OPERATOR),createVector(0,0,+1));
  checkAngle(r.getAngle(),0.5 * FastMath.PI);
  r=new FieldRotation<DerivativeStructure>(createAxis(0,1,0),createAngle(FastMath.PI),RotationConvention.FRAME_TRANSFORM);
  checkVector(r.getAxis(RotationConvention.FRAME_TRANSFORM),createVector(0,+1,0));
  checkVector(r.getAxis(RotationConvention.VECTOR_OPERATOR),createVector(0,-1,0));
  checkAngle(r.getAngle(),FastMath.PI);
  checkVector(createRotation(1,0,0,0,false).getAxis(RotationConvention.FRAME_TRANSFORM),createVector(-1,0,0));
  checkVector(createRotation(1,0,0,0,false).getAxis(RotationConvention.VECTOR_OPERATOR),createVector(+1,0,0));
}
