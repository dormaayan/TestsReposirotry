/** 
 * Test for a quadric. <p> f(x, y, z) = 2 x<sup>2</sup> - 3 y<sup>2</sup> - 4 z<sup>2</sup> + 5 x y + 6 x z - 2 y z + 3 </p>
 */
@Test public void testQuadric(){
  final TrivariateFunction f=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return 2 * x * x - 3 * y * y - 4 * z * z + 5 * x * y + 6 * x * z - 2 * y * z + 3;
    }
  }
;
  final TrivariateFunction dfdx=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return 4 * x + 5 * y + 6 * z;
    }
  }
;
  final TrivariateFunction dfdy=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return -6 * y + 5 * x - 2 * z;
    }
  }
;
  final TrivariateFunction dfdz=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return -8 * z + 6 * x - 2 * y;
    }
  }
;
  final TrivariateFunction d2fdxdy=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return 5;
    }
  }
;
  final TrivariateFunction d2fdxdz=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return 6;
    }
  }
;
  final TrivariateFunction d2fdydz=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return -2;
    }
  }
;
  final TrivariateFunction d3fdxdydz=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return 0;
    }
  }
;
  testInterpolation(-10,3,4.5,6,-150,-117,7,5000,f,dfdx,dfdy,dfdz,d2fdxdy,d2fdxdz,d2fdydz,d3fdxdydz,1e-12,1e-11,1e-8,false);
}
