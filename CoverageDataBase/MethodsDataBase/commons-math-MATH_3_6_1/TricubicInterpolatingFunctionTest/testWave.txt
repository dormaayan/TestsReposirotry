/** 
 * Wave. <p> f(x, y, z) = a cos (&omega; z - k<sub>x</sub> x - k<sub>y</sub> y) </p> with a = 5, &omega; = 0.3, k<sub>x</sub> = 0.8, k<sub>y</sub> = 1.
 */
@Test public void testWave(){
  final double a=5;
  final double omega=0.3;
  final double kx=0.8;
  final double ky=1;
  final TrivariateFunction arg=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return omega * z - kx * x - ky * y;
    }
  }
;
  final TrivariateFunction f=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return a * FastMath.cos(arg.value(x,y,z));
    }
  }
;
  final TrivariateFunction dfdx=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return kx * a * FastMath.sin(arg.value(x,y,z));
    }
  }
;
  final TrivariateFunction dfdy=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return ky * a * FastMath.sin(arg.value(x,y,z));
    }
  }
;
  final TrivariateFunction dfdz=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return -omega * a * FastMath.sin(arg.value(x,y,z));
    }
  }
;
  final TrivariateFunction d2fdxdy=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return -ky * kx * a* FastMath.cos(arg.value(x,y,z));
    }
  }
;
  final TrivariateFunction d2fdxdz=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return omega * kx * a* FastMath.cos(arg.value(x,y,z));
    }
  }
;
  final TrivariateFunction d2fdydz=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return omega * ky * a* FastMath.cos(arg.value(x,y,z));
    }
  }
;
  final TrivariateFunction d3fdxdydz=new TrivariateFunction(){
    public double value(    double x,    double y,    double z){
      return omega * ky * kx* a* FastMath.sin(arg.value(x,y,z));
    }
  }
;
  testInterpolation(-10,3,4.5,6,-150,-117,30,5000,f,dfdx,dfdy,dfdz,d2fdxdy,d2fdxdz,d2fdydz,d3fdxdydz,1e-3,1e-2,1e-12,false);
}
