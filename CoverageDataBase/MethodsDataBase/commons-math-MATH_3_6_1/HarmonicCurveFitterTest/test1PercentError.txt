@Test public void test1PercentError(){
  final Random randomizer=new Random(64925784252L);
  final double a=0.2;
  final double w=3.4;
  final double p=4.1;
  final HarmonicOscillator f=new HarmonicOscillator(a,w,p);
  final WeightedObservedPoints points=new WeightedObservedPoints();
  for (double x=0.0; x < 10.0; x+=0.1) {
    points.add(1,x,f.value(x) + 0.01 * randomizer.nextGaussian());
  }
  final HarmonicCurveFitter fitter=HarmonicCurveFitter.create();
  final double[] fitted=fitter.fit(points.toList());
  Assert.assertEquals(a,fitted[0],7.6e-4);
  Assert.assertEquals(w,fitted[1],2.7e-3);
  Assert.assertEquals(p,MathUtils.normalizeAngle(fitted[2],p),1.3e-2);
}
