@Test public void testNonExistingKeyspace(){
  hThriftClient.open();
  String ksname="test_ks_" + Thread.currentThread().getName() + Thread.currentThread().getId();
  Exception caughtException=null;
  try {
    hThriftClient.getCassandra(ksname);
  }
 catch (  Exception e) {
    caughtException=e;
  }
  assertTrue("if you try to access a non-existent ks, hclient should throw exception",(caughtException != null) && (caughtException instanceof HInvalidRequestException));
  KeyspaceDefinition ksdef=HFactory.createKeyspaceDefinition(ksname);
  Cluster cluster=HFactory.getOrCreateCluster(clusterName,"127.0.0.1:9170");
  cluster.addKeyspace(ksdef);
  hThriftClient.getCassandra(ksname);
  assertTrue(hThriftClient.isOpen());
}
