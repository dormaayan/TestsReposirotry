/** 
 * Checks if an OPTIONS request is processed as pre-flight.
 * @throws IOException
 * @throws ServletException
 */
@Test public void testDoFilterPreflightInvalidOrigin() throws IOException, ServletException {
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.setHeader(CORSFilter.REQUEST_HEADER_ORIGIN,"http://www.example.com");
  request.setHeader(CORSFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"PUT");
  request.setHeader(CORSFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_HEADERS,"Content-Type");
  request.setMethod("OPTIONS");
  MockHttpServletResponse response=new MockHttpServletResponse();
  CORSFilter corsFilter=new CORSFilter();
  corsFilter.init(TestConfigs.getSpecificOriginFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertEquals(response.getStatus(),HttpServletResponse.SC_FORBIDDEN);
}
