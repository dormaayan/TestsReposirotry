@Test public void shouldSubstituteCorrectly() throws IOException {
  StrLookup<?> dummyLookup=new StrLookup<Object>(){
    @Override public String lookup(    String key){
      return "baz";
    }
  }
;
  DummySourceProvider dummyProvider=new DummySourceProvider();
  SubstitutingSourceProvider provider=new SubstitutingSourceProvider(dummyProvider,new StrSubstitutor(dummyLookup));
  String results=new String(ByteStreams.toByteArray(provider.open("foo: ${bar}")),StandardCharsets.UTF_8);
  assertThat(results).isEqualTo("foo: baz");
  try {
    dummyProvider.lastStream.read();
    failBecauseExceptionWasNotThrown(IOException.class);
  }
 catch (  IOException e) {
    assertThat(e).hasMessage("Stream closed");
  }
}
