@Test @SuppressWarnings("unchecked") public void interruptThreadOnInterruptedException() throws Exception {
  assertEquals(false,Thread.currentThread().isInterrupted());
  ConcurrentMap<TemplateSource,Future<Pair<TemplateSource,Template>>> cache=createMock(ConcurrentHashMap.class);
  TemplateSource source=new URLTemplateSource("/template.hbs",getClass().getResource("/template.hbs"));
  Future<Pair<TemplateSource,Template>> future=createMock(Future.class);
  expect(cache.get(source)).andReturn(future);
  expect(future.get()).andThrow(new InterruptedException());
  Template template=createMock(Template.class);
  Pair<TemplateSource,Template> pair=createMock(Pair.class);
  expect(pair.getValue()).andReturn(template);
  expect(cache.get(source)).andReturn(future);
  expect(future.get()).andReturn(pair);
  Parser parser=createMock(Parser.class);
  replay(parser,template,cache,future,pair);
  assertEquals(template,new HighConcurrencyTemplateCache(cache).get(source,parser));
  assertEquals(true,Thread.currentThread().isInterrupted());
  verify(parser,template,cache,future,pair);
}
