@Test public void testResponseToHead() throws Exception {
  final State state=new HttpAsyncRequestExecutor.State();
  final HttpRequest request=new BasicHttpRequest("HEAD","/");
  state.setRequest(request);
  this.connContext.setAttribute(HttpAsyncRequestExecutor.HTTP_EXCHANGE_STATE,state);
  this.connContext.setAttribute(HttpAsyncRequestExecutor.HTTP_HANDLER,this.exchangeHandler);
  final BasicHttpResponse response=new BasicHttpResponse(HttpVersion.HTTP_1_1,200,"OK");
  Mockito.when(this.conn.getHttpResponse()).thenReturn(response);
  this.protocolHandler.responseReceived(this.conn);
  Assert.assertEquals(MessageState.READY,state.getResponseState());
  Assert.assertEquals(MessageState.READY,state.getRequestState());
  Assert.assertNull(state.getRequest());
  Assert.assertNull(state.getResponse());
  Mockito.verify(this.exchangeHandler).responseReceived(response);
  Mockito.verify(this.conn).resetInput();
  Mockito.verify(this.conn,Mockito.never()).close();
}
