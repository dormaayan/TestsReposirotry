@Test public void testReadRequestHead() throws Exception {
  final String s="GET / HTTP/1.1\r\nUser-Agent: test\r\n\r\n";
  final ByteArrayInputStream inStream=new ByteArrayInputStream(s.getBytes(Consts.ASCII));
  Mockito.when(socket.getInputStream()).thenReturn(inStream);
  conn.bind(socket);
  Assert.assertEquals(0,conn.getMetrics().getRequestCount());
  final HttpRequest request=conn.receiveRequestHeader();
  Assert.assertNotNull(request);
  Assert.assertEquals(HttpVersion.HTTP_1_1,request.getProtocolVersion());
  Assert.assertEquals("/",request.getRequestLine().getUri());
  Assert.assertEquals("GET",request.getRequestLine().getMethod());
  Assert.assertTrue(request.containsHeader("User-Agent"));
  Assert.assertEquals(1,conn.getMetrics().getRequestCount());
}
