@Test public void testWriteResponse100Head() throws Exception {
  final ByteArrayOutputStream outStream=new ByteArrayOutputStream();
  Mockito.when(socket.getOutputStream()).thenReturn(outStream);
  conn.bind(socket);
  Assert.assertEquals(0,conn.getMetrics().getResponseCount());
  final HttpResponse response=new BasicHttpResponse(HttpVersion.HTTP_1_1,100,"Go on");
  conn.sendResponseHeader(response);
  conn.flush();
  Assert.assertEquals(0,conn.getMetrics().getResponseCount());
  final String s=new String(outStream.toByteArray(),"ASCII");
  Assert.assertEquals("HTTP/1.1 100 Go on\r\n\r\n",s);
}
