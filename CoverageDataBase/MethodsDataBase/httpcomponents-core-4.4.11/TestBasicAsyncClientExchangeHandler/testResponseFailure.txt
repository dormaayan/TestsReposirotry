@Test public void testResponseFailure() throws Exception {
  final Exception ooopsie=new Exception();
  Mockito.when(this.responseConsumer.getException()).thenReturn(ooopsie);
  this.exchangeHandler.responseCompleted();
  Mockito.verify(this.responseConsumer).responseCompleted(this.context);
  Mockito.verify(this.requestProducer).close();
  Mockito.verify(this.responseConsumer).close();
  try {
    this.exchangeHandler.getFuture().get();
  }
 catch (  final ExecutionException exex) {
    Assert.assertSame(ooopsie,exex.getCause());
  }
}
