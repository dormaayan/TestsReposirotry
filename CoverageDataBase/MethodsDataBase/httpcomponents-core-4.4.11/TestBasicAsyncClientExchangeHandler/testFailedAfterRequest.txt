@Test public void testFailedAfterRequest() throws Exception {
  final Exception ooopsie=new Exception();
  this.exchangeHandler.requestCompleted();
  this.exchangeHandler.failed(ooopsie);
  Mockito.verify(this.requestProducer,Mockito.never()).failed(ooopsie);
  Mockito.verify(this.responseConsumer).failed(ooopsie);
  Mockito.verify(this.requestProducer).close();
  Mockito.verify(this.responseConsumer).close();
  try {
    this.exchangeHandler.getFuture().get();
  }
 catch (  final ExecutionException ex) {
    Assert.assertSame(ooopsie,ex.getCause());
  }
}
