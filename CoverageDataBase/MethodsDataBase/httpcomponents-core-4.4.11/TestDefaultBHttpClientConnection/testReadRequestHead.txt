@Test public void testReadRequestHead() throws Exception {
  final String s="HTTP/1.1 200 OK\r\nUser-Agent: test\r\n\r\n";
  final ByteArrayInputStream inStream=new ByteArrayInputStream(s.getBytes(Consts.ASCII));
  Mockito.when(socket.getInputStream()).thenReturn(inStream);
  conn.bind(socket);
  Assert.assertEquals(0,conn.getMetrics().getResponseCount());
  final HttpResponse response=conn.receiveResponseHeader();
  Assert.assertNotNull(response);
  Assert.assertEquals(HttpVersion.HTTP_1_1,response.getProtocolVersion());
  Assert.assertEquals(200,response.getStatusLine().getStatusCode());
  Assert.assertTrue(response.containsHeader("User-Agent"));
  Assert.assertEquals(1,conn.getMetrics().getResponseCount());
}
