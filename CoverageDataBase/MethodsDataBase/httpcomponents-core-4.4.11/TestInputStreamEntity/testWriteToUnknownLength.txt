@Test public void testWriteToUnknownLength() throws Exception {
  final String message="Message content";
  final byte[] bytes=message.getBytes(Consts.ISO_8859_1);
  final InputStream inStream=new ByteArrayInputStream(bytes);
  final InputStreamEntity httpentity=new InputStreamEntity(inStream);
  final ByteArrayOutputStream out=new ByteArrayOutputStream();
  httpentity.writeTo(out);
  final byte[] writtenBytes=out.toByteArray();
  Assert.assertNotNull(writtenBytes);
  Assert.assertEquals(bytes.length,writtenBytes.length);
  final String s=new String(writtenBytes,Consts.ISO_8859_1.name());
  Assert.assertEquals(message,s);
}
