@Test public void testTruncatedContent() throws IOException {
  final String correct="1234567890123456";
  final SessionInputBuffer inBuffer=new SessionInputBufferMock(correct,Consts.ISO_8859_1);
  final InputStream in=new ContentLengthInputStream(inBuffer,32L);
  final byte[] tmp=new byte[32];
  final int byteRead=in.read(tmp);
  Assert.assertEquals(16,byteRead);
  try {
    in.read(tmp);
    Assert.fail("ConnectionClosedException should have been closed");
  }
 catch (  final ConnectionClosedException ex) {
  }
  try {
    in.read();
    Assert.fail("ConnectionClosedException should have been closed");
  }
 catch (  final ConnectionClosedException ex) {
  }
  try {
    in.close();
    Assert.fail("ConnectionClosedException should have been closed");
  }
 catch (  final ConnectionClosedException ex) {
  }
}
