@Test public void testIgnoreTruncatedChunkException() throws Exception {
  this.server.registerHandler("*",new BasicAsyncRequestHandler(new SimpleRequestHandler(true)));
  this.server.start();
  this.client.start();
  final ListenerEndpoint endpoint=this.server.getListenerEndpoint();
  endpoint.waitFor();
  final String pattern=RndTestPatternGenerator.generateText();
  final int count=RndTestPatternGenerator.generateCount(1000);
  final HttpHost target=new HttpHost("localhost",((InetSocketAddress)endpoint.getAddress()).getPort());
  final BasicHttpRequest request=new BasicHttpRequest("GET",pattern + "x" + count);
  final Future<HttpResponse> future=this.client.execute(new BasicAsyncRequestProducer(target,request),new LenientAsyncResponseConsumer(),null,null);
  final HttpResponse response=future.get(RESULT_TIMEOUT_SEC,TimeUnit.SECONDS);
  Assert.assertNotNull(response);
  Assert.assertEquals(HttpStatus.SC_OK,response.getStatusLine().getStatusCode());
  Assert.assertEquals(new String(GARBAGE,Consts.ISO_8859_1.name()),EntityUtils.toString(response.getEntity()));
}
