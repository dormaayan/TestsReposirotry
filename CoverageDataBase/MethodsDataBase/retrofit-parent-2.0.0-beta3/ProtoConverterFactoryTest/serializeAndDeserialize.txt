@Test public void serializeAndDeserialize() throws IOException, InterruptedException {
  ByteString encoded=ByteString.decodeBase64("Cg4oNTE5KSA4NjctNTMwOQ==");
  server.enqueue(new MockResponse().setBody(new Buffer().write(encoded)));
  Call<Phone> call=service.post(Phone.newBuilder().setNumber("(519) 867-5309").build());
  Response<Phone> response=call.execute();
  Phone body=response.body();
  assertThat(body.getNumber()).isEqualTo("(519) 867-5309");
  RecordedRequest request=server.takeRequest();
  assertThat(request.getBody().readByteString()).isEqualTo(encoded);
  assertThat(request.getHeader("Content-Type")).isEqualTo("application/x-protobuf");
}
