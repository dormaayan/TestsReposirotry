@Test public void asyncSuccessCalledAfterDelay() throws InterruptedException, IOException {
  behavior.setDelay(100,MILLISECONDS);
  behavior.setVariancePercent(0);
  behavior.setFailurePercent(0);
  Call<String> call=service.response();
  final long startNanos=System.nanoTime();
  final AtomicLong tookMs=new AtomicLong();
  final AtomicReference<String> actual=new AtomicReference<>();
  final CountDownLatch latch=new CountDownLatch(1);
  call.enqueue(new Callback<String>(){
    @Override public void onResponse(    Response<String> response){
      tookMs.set(TimeUnit.NANOSECONDS.toMillis(System.nanoTime() - startNanos));
      actual.set(response.body());
      latch.countDown();
    }
    @Override public void onFailure(    Throwable t){
      throw new AssertionError();
    }
  }
);
  assertTrue(latch.await(1,SECONDS));
  assertThat(actual.get()).isEqualTo("Response!");
  assertThat(tookMs.get()).isGreaterThanOrEqualTo(100);
}
