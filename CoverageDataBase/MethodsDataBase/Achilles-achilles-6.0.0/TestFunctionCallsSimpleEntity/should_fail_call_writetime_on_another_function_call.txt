@Test public void should_fail_call_writetime_on_another_function_call() throws Exception {
  final long id=RandomUtils.nextLong(0L,Long.MAX_VALUE);
  final Date date=buildDateKey();
  scriptExecutor.executeScriptTemplate("SimpleEntity/insert_single_row.cql",ImmutableMap.of("id",id,"table","simple"));
  exception.expect(AchillesException.class);
  exception.expectMessage("Invalid argument for 'writetime' function, it does not accept function call as argument, only simple column");
  manager.dsl().select().id().function(writetime(max(SimpleEntity_AchillesMeta.COLUMNS.VALUE)),"maxWritetimeOfValue").fromBaseTable().where().id().Eq(id).date().Eq(date).getTypedMap();
}
