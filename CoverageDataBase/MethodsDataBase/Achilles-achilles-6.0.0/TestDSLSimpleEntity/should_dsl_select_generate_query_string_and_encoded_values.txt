@Test public void should_dsl_select_generate_query_string_and_encoded_values() throws Exception {
  final long id1=RandomUtils.nextLong(0L,Long.MAX_VALUE);
  final long id2=RandomUtils.nextLong(0L,Long.MAX_VALUE);
  final Date date1=buildDateKey();
  final Date date2=new Date();
  final SimpleEntity_Select.E dsl=manager.dsl().select().date().value().fromBaseTable().where().id().IN(id1,id2).date().IN(date1,date2);
  final String expectedQuery="SELECT date,value FROM " + DEFAULT_CASSANDRA_EMBEDDED_KEYSPACE_NAME + ".simple "+ "WHERE id IN :id AND date IN :date;";
  assertThat(dsl.getStatementAsString()).isEqualTo(expectedQuery);
  assertThat(dsl.getBoundValues()).containsExactly(asList(id1,id2),asList(date1,date2));
  assertThat(dsl.getEncodedBoundValues()).containsExactly(asList(id1,id2),asList(date1,date2));
  assertThat(dsl.generateAndGetBoundStatement().preparedStatement().getQueryString()).isEqualTo(expectedQuery);
}
