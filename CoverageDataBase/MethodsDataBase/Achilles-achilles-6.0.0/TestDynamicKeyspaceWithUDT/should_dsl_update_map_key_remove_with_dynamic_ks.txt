@Test public void should_dsl_update_map_key_remove_with_dynamic_ks() throws Exception {
  final Long id=RandomUtils.nextLong(0L,Long.MAX_VALUE);
  final UDTWithNoKeyspace udt=new UDTWithNoKeyspace(id,"value");
  final UDTWithNoKeyspace udt1=new UDTWithNoKeyspace(id,"value1");
  scriptExecutor.executeScriptTemplate("EntityWithUDTForDynamicKeyspace/insertMapKey.cql",ImmutableMap.of("id",id));
  manager.dsl().update().from(provider).udtMapKey().RemoveByKey(udt1).where().id().Eq(id).clust().Eq(udt).execute();
  final Row found=session.execute("SELECT udtmapkey FROM dynamic_ks.dynamic_table WHERE id = " + id).one();
  assertThat(found).isNotNull();
  final Map<UDTValue,String> udtMapKey=found.getMap("udtmapkey",UDTValue.class,String.class);
  assertThat(udtMapKey).isNotNull();
  assertThat(udtMapKey).hasSize(1);
  assertThat(udtMapKey.keySet().stream().map(x -> x.getString("\"VALUE\"")).collect(toSet())).contains("value2");
}
