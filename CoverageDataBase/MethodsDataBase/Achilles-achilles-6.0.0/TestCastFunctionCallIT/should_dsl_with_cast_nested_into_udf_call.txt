@Test public void should_dsl_with_cast_nested_into_udf_call() throws Exception {
  final long id=RandomUtils.nextLong(0L,Long.MAX_VALUE);
  Date now=new Date();
  Thread.sleep(2);
  scriptExecutor.executeScriptTemplate("EntityForCastFunctionCall/insertRow.cql",ImmutableMap.of("id",id));
  final TypedMap typedMap=manager.dsl().select().id().function(FunctionsRegistry.convertStringToLong(castAsText(writetime(EntityForCastFunctionCall_AchillesMeta.COLUMNS.VALUE))),"casted").fromBaseTable().where().id().Eq(id).getTypedMap();
  assertThat(typedMap).isNotNull();
  assertThat(typedMap).isNotEmpty();
  assertThat(typedMap.<Long>getTyped("casted")).isGreaterThan(now.getTime());
}
