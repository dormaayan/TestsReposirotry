@Test public void should_parse_function_with_keyspace() throws Exception {
  setExec(aptUtils -> {
    final String className=TestFunctionRegistryWithKeyspaceName.class.getCanonicalName();
    final TypeElement typeElement=aptUtils.elementUtils.getTypeElement(className);
    final List<FunctionSignature> UDFSignatures=FunctionParser.parseFunctionRegistryAndValidateTypes(aptUtils,typeElement,context);
    assertThat(UDFSignatures).hasSize(2);
    final FunctionSignature signature1=UDFSignatures.get(0);
    assertThat(signature1.keyspace.get()).isEqualTo("ks");
    assertThat(signature1.name).isEqualTo("toLong");
    assertThat(signature1.returnTypeSignature.targetCQLTypeName).isEqualTo(OBJECT_LONG);
    assertThat(signature1.sourceParameterTypes).containsExactly(STRING);
    final FunctionSignature signature2=UDFSignatures.get(1);
    assertThat(signature2.keyspace.get()).isEqualTo("ks");
    assertThat(signature2.name).isEqualTo("toInt");
    assertThat(signature2.returnTypeSignature.targetCQLTypeName).isEqualTo(OBJECT_INT);
    assertThat(signature2.sourceParameterTypes).containsExactly(STRING);
  }
);
  launchTest();
}
