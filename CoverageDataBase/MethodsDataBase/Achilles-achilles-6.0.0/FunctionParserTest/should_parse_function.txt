@Test public void should_parse_function() throws Exception {
  setExec(aptUtils -> {
    final String className=TestFunctionRegistry.class.getCanonicalName();
    final TypeElement typeElement=aptUtils.elementUtils.getTypeElement(className);
    final List<FunctionSignature> UDFSignatures=FunctionParser.parseFunctionRegistryAndValidateTypes(aptUtils,typeElement,context);
    assertThat(UDFSignatures).hasSize(3);
    final FunctionSignature signature1=UDFSignatures.get(0);
    assertThat(signature1.keyspace.isPresent()).isFalse();
    assertThat(signature1.name).isEqualTo("toString");
    assertThat(signature1.returnTypeSignature.targetCQLTypeName).isEqualTo(STRING);
    assertThat(signature1.sourceParameterTypes).containsExactly(TypeName.INT);
    final FunctionSignature signature2=UDFSignatures.get(1);
    assertThat(signature2.keyspace.isPresent()).isFalse();
    assertThat(signature2.name).isEqualTo("toString");
    assertThat(signature2.returnTypeSignature.targetCQLTypeName).isEqualTo(STRING);
    assertThat(signature2.sourceParameterTypes).containsExactly(TypeName.LONG);
    final FunctionSignature signature3=UDFSignatures.get(2);
    assertThat(signature3.keyspace.isPresent()).isFalse();
    assertThat(signature3.name).isEqualTo("noArg");
    assertThat(signature3.returnTypeSignature.targetCQLTypeName).isEqualTo(STRING);
    assertThat(signature3.sourceParameterTypes).isNotNull().isEmpty();
  }
);
  launchTest();
}
