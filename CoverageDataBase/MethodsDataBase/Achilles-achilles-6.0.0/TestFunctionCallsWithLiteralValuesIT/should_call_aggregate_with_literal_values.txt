@Test public void should_call_aggregate_with_literal_values() throws Exception {
  Long id=RandomUtils.nextLong(0L,Long.MAX_VALUE);
  scriptExecutor.executeScriptTemplate("EntityForAggregate/insert_rows.cql",ImmutableMap.of("id",id));
  final TypedMap typedMap=manager.dsl().select().function(FunctionsRegistry.findByDoubleValue(COLUMNS.CLUSTERING,COLUMNS.STRING_VAL,COLUMNS.DOUBLE_VAL,Double_Type.wrap(2.0),Double_Type.wrap(4.0)),"map_result").fromBaseTable().without_WHERE_Clause().limit(1).getTypedMap();
  assertThat(typedMap).hasSize(1);
  assertThat(typedMap).containsKey("map_result");
  Map<Integer,String> mapResult=typedMap.getTyped("map_result");
  assertThat(mapResult).hasSize(3);
  assertThat(mapResult).containsEntry(2,"2.0");
  assertThat(mapResult).containsEntry(3,"3.0");
  assertThat(mapResult).containsEntry(4,"4.0");
}
