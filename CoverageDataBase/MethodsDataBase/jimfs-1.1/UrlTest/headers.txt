@Test public void headers() throws IOException {
  byte[] bytes={1,2,3};
  Files.write(path,bytes);
  FileTime lastModified=Files.getLastModifiedTime(path);
  URL url=path.toUri().toURL();
  URLConnection conn=url.openConnection();
  assertThat(conn.getHeaderFields()).containsEntry("content-length",ImmutableList.of("3"));
  assertThat(conn.getHeaderFields()).containsEntry("content-type",ImmutableList.of("application/octet-stream"));
  if (lastModified != null) {
    assertThat(conn.getHeaderFields()).containsKey("last-modified");
    assertThat(conn.getHeaderFields()).hasSize(3);
  }
 else {
    assertThat(conn.getHeaderFields()).hasSize(2);
  }
  assertThat(conn.getContentLengthLong()).isEqualTo(Files.size(path));
  assertThat(conn.getContentType()).isEqualTo("application/octet-stream");
  if (lastModified != null) {
    long difference=lastModified.toMillis() - conn.getLastModified();
    assertThat(difference).isIn(Range.closedOpen(0L,1000L));
  }
 else {
    assertThat(conn.getLastModified()).isEqualTo(0L);
  }
}
